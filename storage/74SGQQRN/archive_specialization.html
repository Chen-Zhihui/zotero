<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">

  

    

    
    
    
    
    


    <meta charset="utf-8">
    <title>cereal Docs - Archive Specialization</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <link href="css.css" rel="stylesheet" type="text/css">
    <link href="pygments.css" rel="stylesheet">
    <link href="bootstrap.css" rel="stylesheet">
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }

      @media (max-width: 980px) {
        /* Enable use of floated navbar text */
        .navbar-text.pull-right {
          float: none;
          padding-left: 5px;
          padding-right: 5px;
        }
      }
    </style>

    <style type="text/css">
      /* set a max-width for horizontal fluid layout and make it centered */
      .container-fluid {
        margin-right: auto;
        margin-left: auto;
        max-width: 1600px; /* or 950px */
      }
    </style>
    
    <link href="bootstrap-responsive.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
    <script src="/cereal/assets/js/html5shiv.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://uscilab.github.io/cereal/assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://uscilab.github.io/cereal/assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://uscilab.github.io/cereal/assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="http://uscilab.github.io/cereal/assets/ico/apple-touch-icon-57-precomposed.png">
    <link rel="shortcut icon" href="http://uscilab.github.io/cereal/assets/ico/favicon.png">

  </head>

  <body>
    <div class="container-fluid">


      <div class="navbar navbar-fixed-top">
        <div class="navbar-inner">

          <div class="container">

            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </a>

            <a class="brand" href="http://uscilab.github.io/cereal/index.html" style="font-family: 'Fredoka One'; font-size: 34px;">cereal</a>

            <div class="nav-collapse collapse" style="height: 0px;">
              <ul class="nav">
                <li><a href="http://uscilab.github.io/cereal/index.html">Documentation</a></li>
                <li><a href="http://uscilab.github.io/cereal/assets/doxygen/index.html">Doxygen Docs</a></li>
                <li><a href="http://uscilab.github.io/cereal/assets/coverage/index.html">Coverage</a></li>
                <li><a href="https://github.com/USCiLab/cereal">Github</a></li>
                <li>
                  <a href="https://travis-ci.org/USCiLab/cereal">
                    <img src="cereal">
                  </a>
                </li>
                <li>
                  <a href="https://ci.appveyor.com/project/AzothAmmo/cereal">
                    <img src="develop.png">
                  </a>
                </li>
              </ul>

              <ul class="nav pull-right">
                <li><a href="http://uscilab.github.io/cereal/about.html">About</a></li>
                <li class="divider-vertical"></li>
                <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown"> Download <b class="caret"></b> </a>
                <ul class="dropdown-menu">
                  <li><a href="https://github.com/USCiLab/cereal/archive/v1.2.2.tar.gz">v1.2.2 (.tar.gz)</a></li>
                  <li><a href="https://github.com/USCiLab/cereal/archive/v1.2.2.zip">v1.2.2 (.zip)</a></li>
                  <li><a href="https://github.com/USCiLab/cereal/releases">All Releases</a></li>
                </ul>
                </li>
                <li class="divider-vertical"></li>
              </ul>

            </div>

          </div>

        </div>
      </div>

      <div class="row-fluid">
        <div class="span3">
          <div class="well sidebar-nav">
            <ul class="nav nav-list">
              <li><a href="http://uscilab.github.io/cereal/index.html">Home</a></li>
              <li class="nav-header">At a Glance</li>
              <li><a href="http://uscilab.github.io/cereal/quickstart.html">Quick Start</a></li>
              <li><a href="http://uscilab.github.io/cereal/stl_support.html">Standard Library Support</a></li>
              <li><a href="http://uscilab.github.io/cereal/transition_from_boost.html">Transitioning From Boost</a></li>
              <li class="nav-header">Basic Documentation</li>
              <li><a href="http://uscilab.github.io/cereal/serialization_archives.html">Serialization Archives</a></li>
              <li><a href="http://uscilab.github.io/cereal/serialization_functions.html">Serialization Functions</a></li>
              <li><a href="http://uscilab.github.io/cereal/pointers.html">Pointers and References</a></li>
              <li><a href="http://uscilab.github.io/cereal/inheritance.html">Inheritance</a></li>
              <li class="nav-header">Advanced Topics</li>
              <li><a href="http://uscilab.github.io/cereal/polymorphism.html">Polymorphism</a></li>
              <li><a href="http://uscilab.github.io/cereal/archive_specialization.html">Archive Specialization</a></li>
              <li><a href="http://uscilab.github.io/cereal/thread_safety.html">Thread Safety</a></li>
              <li><a href="http://uscilab.github.io/cereal/pimpl.html">PIMPL Idiom</a></li>
              <li><a href="http://uscilab.github.io/cereal/contributing.html">Contributing to cereal</a></li>
              <li class="nav-header">Other Stuff</li>
              <li><a href="http://uscilab.github.io/cereal/help.html">Getting Help</a></li>
            </ul>

          </div><!--/.well -->
        </div><!--/span-->
        <div class="span7">
          

<h1 id="archive-specialization">Archive Specialization</h1>

<p><font style="font-family: Fredoka One;">cereal </font>supports having specific serialization behaviors for different archive types.</p>

<hr>

<h3 id="tldr-version">TLDR Version</h3>

<p>You can specialize your own types or types that <font style="font-family: Fredoka One;">cereal </font>comes
 with support for to exhibit specific behaviors with
specific archives.  This is typically done by replacing at least one 
generic templated parameter with the type you wish to specialize for.  
Specializations will be given precedence over any templated 
serialization function.</p>

<p>If you want to specialize for several types of archives, you will need to use templates and type traits to restrict
template instantiation.  <font style="font-family: Fredoka One;">cereal </font>provides several traits to help with this, defined in <code class="highlighter-rouge">&lt;cereal/details/traits.hpp&gt;</code>.</p>

<hr>

<h2 id="specializing-built-in-types">Specializing Built-in Types</h2>

<p>Although <font style="font-family: Fredoka One;">cereal </font>comes with a support for nearly every type in the <a href="http://uscilab.github.io/cereal/stl_support.html">standard library</a>, there can be
times when it is desirable to have custom functionality for a type that <font style="font-family: Fredoka One;">cereal </font>provides the serialization for.  Function
overloading can be used to override the <font style="font-family: Fredoka One;">cereal </font>implementation with a custom one.  This will work even if you include the
<font style="font-family: Fredoka One;">cereal </font>support for a type - assuming that the compiler doesnâ€™t find any ambiguity in your overload (more on that later).</p>

<h3 id="specializing-the-archive">Specializing the archive</h3>

<p>If you want to make an archive behave differently for some type, you can do this by creating overloads where the archive
is explicitly defined (and not a template parameter):</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">namespace</span> <span class="n">cereal</span>
<span class="p">{</span>
  <span class="c1">// Overload the std::complex serialization code for a specific archive
</span>  <span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="o">&gt;</span>
  <span class="kt">void</span> <span class="n">save</span><span class="p">(</span> <span class="n">cereal</span><span class="o">::</span><span class="n">XMLOutputArchive</span> <span class="o">&amp;</span> <span class="n">ar</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="k">const</span> <span class="o">&amp;</span> <span class="n">comp</span> <span class="p">)</span>
  <span class="p">{</span> <span class="cm">/* your code here */</span> <span class="p">}</span>

  <span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">T</span><span class="o">&gt;</span>
  <span class="kt">void</span> <span class="n">load</span><span class="p">(</span> <span class="n">cereal</span><span class="o">::</span><span class="n">XMLInputArchive</span> <span class="o">&amp;</span> <span class="n">ar</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">comp</span> <span class="p">)</span>
  <span class="p">{</span> <span class="cm">/* your code here */</span> <span class="p">}</span>

  <span class="c1">// Note that it doesn't make much sense to overload a plain serialize function
</span>  <span class="c1">// (i.e. void serialize()) because it expects to be called
</span>  <span class="c1">// for loading (an input archive) and saving (an output archive).
</span>  <span class="c1">// We would end up needing to implement two versions of it, so using a load/save
</span>  <span class="c1">// pair makes more sense.
</span><span class="p">}</span>
</code></pre></div></div>

<p><span class="label label-warning">Important!</span>
When overloading a <font style="font-family: Fredoka One;">cereal </font>provided serialization function, you should place it in the <code class="highlighter-rouge">cereal</code> namespace.</p>

<h3 id="specializing-the-type">Specializing the type</h3>

<p>It is also easy to specialize the behavior of a specific type for all archives or a group of archives.  This is done by
restricting the serialized type instead of restricting the archive (though you can definitely specialize on both the
archive and the type).</p>

<p>The following example shows how to specialize serialization for <code class="highlighter-rouge">std::map&lt;std::string, std::string&gt;</code> for text archives such that it
roughly matches the output of an SQL `WHERE` clause in which all the expressions (from a name-value-pair perspective)
are ANDed together (inspired by <a href="http://stackoverflow.com/questions/22569832/is-there-a-way-to-specify-a-simpler-json-de-serialization-for-stdmap-using-c">this</a> stackoverflow post):</p>

<h4 id="the-serialization-code">The serialization code:</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">namespace</span> <span class="n">cereal</span>
<span class="p">{</span>
  <span class="c1">//! Saving for std::map&lt;std::string, std::string&gt; for text based archives
</span>  <span class="c1">// Note that this shows off some internal cereal traits such as EnableIf,
</span>  <span class="c1">// which will only allow this template to be instantiated if its predicates
</span>  <span class="c1">// are true
</span>  <span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">Archive</span><span class="p">,</span> <span class="k">class</span> <span class="nc">C</span><span class="p">,</span> <span class="k">class</span> <span class="nc">A</span><span class="p">,</span>
            <span class="n">traits</span><span class="o">::</span><span class="n">EnableIf</span><span class="o">&lt;</span><span class="n">traits</span><span class="o">::</span><span class="n">is_text_archive</span><span class="o">&lt;</span><span class="n">Archive</span><span class="o">&gt;::</span><span class="n">value</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">traits</span><span class="o">::</span><span class="n">sfinae</span><span class="o">&gt;</span> <span class="kr">inline</span>
  <span class="kt">void</span> <span class="n">save</span><span class="p">(</span> <span class="n">Archive</span> <span class="o">&amp;</span> <span class="n">ar</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">A</span><span class="o">&gt;</span> <span class="k">const</span> <span class="o">&amp;</span> <span class="n">map</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">for</span><span class="p">(</span> <span class="k">const</span> <span class="k">auto</span> <span class="o">&amp;</span> <span class="n">i</span> <span class="o">:</span> <span class="n">map</span> <span class="p">)</span>
      <span class="n">ar</span><span class="p">(</span> <span class="n">cereal</span><span class="o">::</span><span class="n">make_nvp</span><span class="p">(</span> <span class="n">i</span><span class="p">.</span><span class="n">first</span><span class="p">,</span> <span class="n">i</span><span class="p">.</span><span class="n">second</span> <span class="p">)</span> <span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">//! Loading for std::map&lt;std::string, std::string&gt; for text based archives
</span>  <span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">Archive</span><span class="p">,</span> <span class="k">class</span> <span class="nc">C</span><span class="p">,</span> <span class="k">class</span> <span class="nc">A</span><span class="p">,</span>
            <span class="n">traits</span><span class="o">::</span><span class="n">EnableIf</span><span class="o">&lt;</span><span class="n">traits</span><span class="o">::</span><span class="n">is_text_archive</span><span class="o">&lt;</span><span class="n">Archive</span><span class="o">&gt;::</span><span class="n">value</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">traits</span><span class="o">::</span><span class="n">sfinae</span><span class="o">&gt;</span> <span class="kr">inline</span>
  <span class="kt">void</span> <span class="n">load</span><span class="p">(</span> <span class="n">Archive</span> <span class="o">&amp;</span> <span class="n">ar</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">A</span><span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">map</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">map</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>

    <span class="k">auto</span> <span class="n">hint</span> <span class="o">=</span> <span class="n">map</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
    <span class="k">while</span><span class="p">(</span> <span class="nb">true</span> <span class="p">)</span>
    <span class="p">{</span>
      <span class="k">const</span> <span class="k">auto</span> <span class="n">namePtr</span> <span class="o">=</span> <span class="n">ar</span><span class="p">.</span><span class="n">getNodeName</span><span class="p">();</span>

      <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="n">namePtr</span> <span class="p">)</span>
        <span class="k">break</span><span class="p">;</span>

      <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">key</span> <span class="o">=</span> <span class="n">namePtr</span><span class="p">;</span>
      <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">value</span><span class="p">;</span> <span class="n">ar</span><span class="p">(</span> <span class="n">value</span> <span class="p">);</span>
      <span class="n">hint</span> <span class="o">=</span> <span class="n">map</span><span class="p">.</span><span class="n">emplace_hint</span><span class="p">(</span> <span class="n">hint</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span> <span class="n">key</span> <span class="p">),</span> <span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span> <span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span> <span class="c1">// namespace cereal
</span></code></pre></div></div>
<p><span class="label label-warning">Important!</span>
Please note that for all specializations, you must have at least one parameter that has higher precedence than the
default templated version that <font style="font-family: Fredoka One;">cereal </font>provides.  This usually means you need to explicitly specialize at least one
template parameter.  In the above examples we specialized two of the template parameters for <code class="highlighter-rouge">std::map</code>.</p>

<h4 id="using-the-serialization-code">Using the serialization code:</h4>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">std</span><span class="o">::</span><span class="n">stringstream</span> <span class="n">ss</span><span class="p">;</span>
  <span class="p">{</span>
    <span class="n">cereal</span><span class="o">::</span><span class="n">JSONOutputArchive</span> <span class="n">ar</span><span class="p">(</span><span class="n">ss</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">filter</span> <span class="o">=</span> <span class="p">{{</span><span class="s">"type"</span><span class="p">,</span> <span class="s">"sensor"</span><span class="p">},</span> <span class="p">{</span><span class="s">"status"</span><span class="p">,</span> <span class="s">"critical"</span><span class="p">}};</span>

    <span class="n">ar</span><span class="p">(</span> <span class="n">CEREAL_NVP</span><span class="p">(</span><span class="n">filter</span><span class="p">)</span> <span class="p">);</span>
  <span class="p">}</span>

  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

  <span class="p">{</span>
    <span class="n">cereal</span><span class="o">::</span><span class="n">JSONInputArchive</span> <span class="n">ar</span><span class="p">(</span><span class="n">ss</span><span class="p">);</span>
    <span class="n">cereal</span><span class="o">::</span><span class="n">JSONOutputArchive</span> <span class="n">ar2</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="p">);</span>

    <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">filter</span><span class="p">;</span>

    <span class="n">ar</span><span class="p">(</span> <span class="n">CEREAL_NVP</span><span class="p">(</span><span class="n">filter</span><span class="p">)</span> <span class="p">);</span>
    <span class="n">ar2</span><span class="p">(</span> <span class="n">CEREAL_NVP</span><span class="p">(</span><span class="n">filter</span><span class="p">)</span> <span class="p">);</span>
  <span class="p">}</span>

  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="output-using-xcereal-built-in-support">Output using cereal built in support:</h4>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"filter"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"type"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sensor"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"status"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"critical"</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h4 id="output-using-the-above-specialized-serializaton-code">Output using the above specialized serializaton code:</h4>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"filter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"critical"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sensor"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<hr>

<h2 id="specializing-user-defined-types">Specializing User Defined Types</h2>

<p>Specializing a user defined type works in almost exactly the same fashion to types in the standard library that <font style="font-family: Fredoka One;">cereal </font>provides
the implementation for.  The only real difference is that there is no longer a requirement that the serialization code
reside in the <code class="highlighter-rouge">cereal</code> namespace - it now goes wherever you would normally put your serialization code.</p>

<p>Since there is no provided implementation to conflict with, you have more control over the generality of your
implementations.  It is much easier to use templates to restrict how the serialization functions are instantiated, as
shown in the following example, which uses different serialization depending on whether a binary archive is used versus
some other type:</p>

<p><a name="user_defined_types_example"></a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">struct</span> <span class="n">Hello</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
  
  <span class="c1">// Enabled for text archives (e.g. XML, JSON)
</span>  <span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">Archive</span><span class="p">,</span>
            <span class="n">cereal</span><span class="o">::</span><span class="n">traits</span><span class="o">::</span><span class="n">EnableIf</span><span class="o">&lt;</span><span class="n">cereal</span><span class="o">::</span><span class="n">traits</span><span class="o">::</span><span class="n">is_text_archive</span><span class="o">&lt;</span><span class="n">Archive</span><span class="o">&gt;::</span><span class="n">value</span><span class="o">&gt;</span>
            <span class="o">=</span> <span class="n">cereal</span><span class="o">::</span><span class="n">traits</span><span class="o">::</span><span class="n">sfinae</span><span class="o">&gt;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">save_minimal</span><span class="p">(</span> <span class="n">Archive</span> <span class="o">&amp;</span> <span class="p">)</span> <span class="k">const</span>
  <span class="p">{</span> 
    <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span> <span class="n">x</span> <span class="p">)</span> <span class="o">+</span> <span class="s">"hello"</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Enabled for text archives (e.g. XML, JSON)
</span>  <span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">Archive</span><span class="p">,</span>
            <span class="n">cereal</span><span class="o">::</span><span class="n">traits</span><span class="o">::</span><span class="n">EnableIf</span><span class="o">&lt;</span><span class="n">cereal</span><span class="o">::</span><span class="n">traits</span><span class="o">::</span><span class="n">is_text_archive</span><span class="o">&lt;</span><span class="n">Archive</span><span class="o">&gt;::</span><span class="n">value</span><span class="o">&gt;</span>
            <span class="o">=</span> <span class="n">cereal</span><span class="o">::</span><span class="n">traits</span><span class="o">::</span><span class="n">sfinae</span><span class="o">&gt;</span>
  <span class="kt">void</span> <span class="n">load_minimal</span><span class="p">(</span> <span class="n">Archive</span> <span class="k">const</span> <span class="o">&amp;</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="k">const</span> <span class="o">&amp;</span> <span class="n">str</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">stoi</span><span class="p">(</span> <span class="n">str</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// Enabled for binary archives (e.g. binary, portable binary)
</span>  <span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">Archive</span><span class="p">,</span>
            <span class="n">cereal</span><span class="o">::</span><span class="n">traits</span><span class="o">::</span><span class="n">DisableIf</span><span class="o">&lt;</span><span class="n">cereal</span><span class="o">::</span><span class="n">traits</span><span class="o">::</span><span class="n">is_text_archive</span><span class="o">&lt;</span><span class="n">Archive</span><span class="o">&gt;::</span><span class="n">value</span><span class="o">&gt;</span>
            <span class="o">=</span> <span class="n">cereal</span><span class="o">::</span><span class="n">traits</span><span class="o">::</span><span class="n">sfinae</span><span class="o">&gt;</span>
  <span class="kt">int</span> <span class="n">save_minimal</span><span class="p">(</span> <span class="n">Archive</span> <span class="o">&amp;</span> <span class="p">)</span> <span class="k">const</span>
  <span class="p">{</span> 
    <span class="k">return</span> <span class="n">x</span><span class="p">;</span> 
  <span class="p">}</span>

  <span class="c1">// Enabled for binary archives (e.g. binary, portable binary)
</span>  <span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">Archive</span><span class="p">,</span>
            <span class="n">cereal</span><span class="o">::</span><span class="n">traits</span><span class="o">::</span><span class="n">DisableIf</span><span class="o">&lt;</span><span class="n">cereal</span><span class="o">::</span><span class="n">traits</span><span class="o">::</span><span class="n">is_text_archive</span><span class="o">&lt;</span><span class="n">Archive</span><span class="o">&gt;::</span><span class="n">value</span><span class="o">&gt;</span>
            <span class="o">=</span> <span class="n">cereal</span><span class="o">::</span><span class="n">traits</span><span class="o">::</span><span class="n">sfinae</span><span class="o">&gt;</span>
  <span class="kt">void</span> <span class="n">load_minimal</span><span class="p">(</span> <span class="n">Archive</span> <span class="k">const</span> <span class="o">&amp;</span><span class="p">,</span> <span class="kt">int</span> <span class="k">const</span> <span class="o">&amp;</span> <span class="n">xx</span> <span class="p">)</span>
  <span class="p">{</span> 
    <span class="n">x</span> <span class="o">=</span> <span class="n">xx</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="useful-type-traits">Useful Type Traits</h2>

<p>There are several useful type traits defined in <code class="highlighter-rouge">&lt;cereal/details/traits.hpp&gt;</code> which are useful when specializing serialization functions.  The doxygen documentation for this entire file can be found <a href="http://uscilab.github.io/cereal/assets/doxygen/traits_8hpp.html">here</a>.  The following are a few especially helpful traits:</p>

<h3 id="enableif-and-disableif">EnableIf and DisableIf</h3>

<p>If you are used to template metaprogramming in C++, you may already be familiar with techniques such as
<a href="http://en.cppreference.com/w/cpp/types/enable_if"><code class="highlighter-rouge">std::enable_if</code></a>, which can be used to selectively disable function
overloads.</p>

<p><font style="font-family: Fredoka One;">cereal </font>provides some similar functionality in a slightly more aesthetically pleasing manner with <code class="highlighter-rouge">EnableIf</code>
(<a href="http://uscilab.github.io/cereal/assets/doxygen/traits_8hpp.html#a07719740a7cec6692b44244201a92603">documentation</a>) and
<code class="highlighter-rouge">DisableIf</code> (<a href="http://uscilab.github.io/cereal/assets/doxygen/traits_8hpp.html#a42e5f793ba5a1b3d2fd674d7334b12bd">documentation</a>).  These will enable (with <code class="highlighter-rouge">EnableIf</code>) or disable (with <code class="highlighter-rouge">DisableIf</code>)
 a function overload if all of their variadic bool parameters, when 
ANDed together, are true.  Since they perform an AND operation of their 
arguments, OR operations or other more complicated boolean expressions 
should be done manually beforehand.</p>

<p>Instead of using the clumsy syntax of <code class="highlighter-rouge">std::enable_if</code>, which requires replacing the function return type, <code class="highlighter-rouge">EnableIf</code>
and <code class="highlighter-rouge">DisableIf</code> are added as an extra template parameter to the function, with the default value of
<code class="highlighter-rouge">cereal::traits::sfinae</code>.  See any of the above <a href="#user_defined_types_example">examples</a> or the
linked documentation for useage details.</p>

<h3 id="is_same_archive">is_same_archive</h3>

<p><code class="highlighter-rouge">is_same_archive</code> operates in a similar manner to <a href="http://en.cppreference.com/w/cpp/types/is_same"><code class="highlighter-rouge">std::is_same</code></a>
except that it will automatically strip various wrappers and CV (const or volatile) qualifiers that may be applied.  Its
use is recommended over <code class="highlighter-rouge">std::is_same</code> because <font style="font-family: Fredoka One;">cereal </font>will often slightly adjust archive parameters so that they become
const or are wrapped in some internal traits class.  See the <a href="http://uscilab.github.io/cereal/assets/doxygen/structcereal_1_1traits_1_1is__same__archive.html">documentation</a> for more information and an example.</p>

<h3 id="is_text_archive">is_text_archive</h3>

<p><code class="highlighter-rouge">is_text_archive</code> checks to see if an archive has been tagged with the <code class="highlighter-rouge">cereal::traits::TextArchive</code> tag.  JSON and XML
archives that ship with <font style="font-family: Fredoka One;">cereal </font>both have this tag.  See <a href="http://uscilab.github.io/cereal/assets/doxygen/structcereal_1_1traits_1_1is__text__archive.html">here</a> for more information.</p>

<p><a name="strip_minimal"></a></p>

<h3 id="strip_minimal">strip_minimal</h3>

<p><code class="highlighter-rouge">strip_minimal</code> is especially useful when working with custom <code class="highlighter-rouge">save_minimal</code> or <code class="highlighter-rouge">load_minimal</code> functions.  <font style="font-family: Fredoka One;">cereal </font>may
wrap types when performing compile time checks to ensure the validity of such functions, which may cause some custom
metaprogramming to fail unexpectedly.  Using the type provided by <code class="highlighter-rouge">strip_minimal</code>, instead of the raw template
parameter, will help prevent this.  Check out the <a href="http://uscilab.github.io/cereal/assets/doxygen/structcereal_1_1traits_1_1strip__minimal.html">documentation</a> as well as its use for serializing enums in the
<code class="highlighter-rouge">common.hpp</code> type support <a href="http://uscilab.github.io/cereal/assets/doxygen/common_8hpp_source.html">here</a>.</p>




        </div><!--/span-->
      </div><!--/row-->
    </div><!--/.fluid-container-->

    <script async="" src="analytics"></script><script async="" src="analytics"></script><script type="text/javascript" src="jquery-1.js"></script>
    <script type="text/javascript" src="bootstrap.js"></script>

    <script type="text/javascript">
      $(document).ready(function () {
          // Highlight the current page in the side navbar
          $('a[href = "archive_specialization"]').parent().addClass('active');
          });
    </script>
    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
      ga('create', 'UA-42360142-1', 'uscilab.github.io');
      ga('send', 'pageview');
      
    </script>
  

</body></html>