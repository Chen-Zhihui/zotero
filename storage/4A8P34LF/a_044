/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 9 22:41
*/
KISSY.add("io/form-serializer",["dom"],function(d,f){function i(a){return a.replace(h,"\r\n")}var k=f("dom"),g=/^(?:select|textarea)/i,h=/\r?\n/g,a,c=/^(?:color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i;return a={serialize:function(c,e){return d.param(a.getFormData(c),void 0,void 0,e||!1)},getFormData:function(a){var e=[],n={};d.each(k.query(a),function(m){m=m.elements?d.makeArray(m.elements):[m];e.push.apply(e,m)});e=d.filter(e,function(m){return m.name&&
!m.disabled&&(m.checked||g.test(m.nodeName)||c.test(m.type))});d.each(e,function(m){var a=k.val(m),b;null!==a&&(a=d.isArray(a)?d.map(a,i):i(a),(b=n[m.name])?(b&&!d.isArray(b)&&(b=n[m.name]=[b]),b.push.apply(b,d.makeArray(a))):n[m.name]=a)});return n}}});
KISSY.add("io/base",["event/custom","promise"],function(d,f){function i(b){var a=b.context;delete b.context;b=d.mix(d.clone(j),b,{deep:!0});b.context=a||b;var m,l=b.type,h=b.dataType,a=b.uri=n.resolve(b.url);b.uri.setQuery("");"crossDomain"in b||(b.crossDomain=!b.uri.isSameOriginAs(n));l=b.type=l.toUpperCase();b.hasContent=!e.test(l);if(b.processData&&(m=b.data)&&"string"!==typeof m)b.data=d.param(m,void 0,void 0,b.serializeArray);h=b.dataType=d.trim(h||"*").split(c);!("cache"in b)&&d.inArray(h[0],
["script","jsonp"])&&(b.cache=!1);b.hasContent||(b.data&&a.query.add(d.unparam(b.data)),!1===b.cache&&a.query.set("_ksTS",d.now()+"_"+d.guid()));return b}function k(b){var a=this;if(!(a instanceof k))return new k(b);h.call(a);b=i(b);d.mix(a,{responseData:null,config:b||{},timeoutTimer:null,responseText:null,responseXML:null,responseHeadersString:"",responseHeaders:null,requestHeaders:{},readyState:0,state:0,statusText:null,status:0,transport:null});h.Defer(a);var c;k.fire("start",{ajaxConfig:b,io:a});
c=new (m[b.dataType[0]]||m["*"])(a);a.transport=c;b.contentType&&a.setRequestHeader("Content-Type",b.contentType);var j=b.dataType[0],e,l=b.timeout,n=b.context,g=b.headers,f=b.accepts;a.setRequestHeader("Accept",j&&f[j]?f[j]+("*"===j?"":", */*; q=0.01"):f["*"]);for(e in g)a.setRequestHeader(e,g[e]);if(b.beforeSend&&!1===b.beforeSend.call(n,a,b))return a;a.readyState=1;k.fire("send",{ajaxConfig:b,io:a});b.async&&0<l&&(a.timeoutTimer=setTimeout(function(){a.abort("timeout")},1E3*l));try{a.state=1,c.send()}catch(p){2>
a.state?(p.stack||p,"error",setTimeout(function(){throw p;},0),a._ioReady(-1,p.message)):p}return a}var g=f("event/custom"),h=f("promise"),a=/^(?:about|app|app\-storage|.+\-extension|file|widget)$/,c=/\s+/,l=function(b){return b},e=/^(?:GET|HEAD)$/,n=new d.Uri((d.Env.host.location||{}).href),a=n&&a.test(n.getScheme()),m={},j={type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",async:!0,serializeArray:!0,processData:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",
text:"text/plain",json:"application/json, text/javascript","*":"*/*"},converters:{text:{json:d.parseJson,html:l,text:l,xml:d.parseXML}},headers:{"X-Requested-With":"XMLHttpRequest"},contents:{xml:/xml/,html:/html/,json:/json/}};j.converters.html=j.converters.text;d.mix(k,g.Target);d.mix(k,{isLocal:a,setupConfig:function(b){d.mix(j,b,{deep:!0})},setupTransport:function(b,a){m[b]=a},getTransport:function(b){return m[b]},getConfig:function(){return j}});return k});
KISSY.add("io/xhr-transport-base",["./base"],function(d,f){function i(a,j){try{return new (j||h).XMLHttpRequest}catch(b){}}function k(a){var j;a.ifModified&&(j=a.uri,!1===a.cache&&(j=j.clone(),j.query.remove("_ksTS")),j=j.toString());return j}var g=f("./base"),h=d.Env.host,a=7<d.UA.ieMode&&h.XDomainRequest,c={proto:{}},l={},e={};g.__lastModifiedCached=l;g.__eTagCached=e;c.nativeXhr=h.ActiveXObject?function(m,j){var b;if(!n&&m&&a)b=new a;else if(!(b=!g.isLocal&&i(m,j)))a:{try{b=new (j||h).ActiveXObject("Microsoft.XMLHTTP");
break a}catch(c){}b=void 0}return b}:i;c.XDomainRequest_=a;var n=c.supportCORS="withCredentials"in c.nativeXhr();d.mix(c.proto,{sendInternal:function(){var m=this,c=m.io,b=c.config,o=m.nativeXhr,h=b.files,g=h?"post":b.type,f=b.async,i,t=c.mimeType,q=c.requestHeaders||{},c=c._getUrlForSend(),u=k(b),p,v;if(u){if(p=l[u])q["If-Modified-Since"]=p;if(p=e[u])q["If-None-Match"]=p}(i=b.username)?o.open(g,c,f,i,b.password):o.open(g,c,f);g=b.xhrFields||{};"withCredentials"in g&&(n||delete g.withCredentials);
for(v in g)try{o[v]=g[v]}catch(x){x}t&&o.overrideMimeType&&o.overrideMimeType(t);!1===q["X-Requested-With"]&&delete q["X-Requested-With"];if("undefined"!==typeof o.setRequestHeader)for(v in q)o.setRequestHeader(v,q[v]);var w=b.hasContent&&b.data||null;h&&(t=w,q={},t&&(q=d.unparam(t)),q=d.mix(q,h),w=new FormData,d.each(q,function(a,m){d.isArray(a)?d.each(a,function(a){w.append(m+(b.serializeArray?"[]":""),a)}):w.append(m,a)}));o.send(w);!f||4===o.readyState?m._callback():a&&o instanceof a?(o.onload=
function(){o.readyState=4;o.status=200;m._callback()},o.onerror=function(){o.readyState=4;o.status=500;m._callback()}):o.onreadystatechange=function(){m._callback()}},abort:function(){this._callback(0,1)},_callback:function(m,c){var b=this.nativeXhr,o=this.io,h,n,f,i,t,q=o.config;try{if(c||4===b.readyState)if(a&&b instanceof a?(b.onerror=d.noop,b.onload=d.noop):b.onreadystatechange=d.noop,c)4!==b.readyState&&b.abort();else{h=k(q);var u=b.status;a&&b instanceof a||(o.responseHeadersString=b.getAllResponseHeaders());
h&&(n=b.getResponseHeader("Last-Modified"),f=b.getResponseHeader("ETag"),n&&(l[h]=n),f&&(e[f]=f));if((t=b.responseXML)&&t.documentElement)o.responseXML=t;var p=o.responseText=b.responseText;if(q.files&&p){var v,x;if(-1!==(v=p.indexOf("<body>")))x=p.lastIndexOf("</body>"),-1===x&&(x=p.length),p=p.slice(v+6,x);o.responseText=d.unEscapeHtml(p)}try{i=b.statusText}catch(w){"xhr statusText error: ",w,i=""}!u&&g.isLocal&&!q.crossDomain?u=o.responseText?200:404:1223===u&&(u=204);o._ioReady(u,i)}}catch(y){y.stack||
y,"error",setTimeout(function(){throw y;},0),b.onreadystatechange=d.noop,c||o._ioReady(-1,y)}}});return c});
KISSY.add("io/xdr-flash-transport",["./base","dom"],function(d,f){function i(a,d,b){n||(n=!0,a='<object id="'+c+'" type="application/x-shockwave-flash" data="'+a+'" width="0" height="0"><param name="movie" value="'+a+'" /><param name="FlashVars" value="yid='+d+"&uid="+b+'&host=KISSY.IO" /><param name="allowScriptAccess" value="always" /></object>',d=e.createElement("div"),h.prepend(d,e.body||e.documentElement),d.innerHTML=a)}function k(a){"use XdrFlashTransport for: "+a.config.url;this.io=a}var g=
f("./base"),h=f("dom"),a={},c="io_swf",l,e=d.Env.host.document,n=!1;d.augment(k,{send:function(){var c=this,e=c.io,b=e.config;i((b.xdr||{}).src||d.Config.base+"io/assets/io.swf",1,1);l?(c._uid=d.guid(),a[c._uid]=c,l.send(e._getUrlForSend(),{id:c._uid,uid:c._uid,method:b.type,data:b.hasContent&&b.data||{}})):setTimeout(function(){c.send()},200)},abort:function(){l.abort(this._uid)},_xdrResponse:function(c,d){var b,e=d.id,l,h=d.c,g=this.io;if(h&&(l=h.responseText))g.responseText=decodeURI(l);switch(c){case "success":b=
{status:200,statusText:"success"};delete a[e];break;case "abort":delete a[e];break;case "timeout":case "transport error":case "failure":delete a[e],b={status:"status"in h?h.status:500,statusText:h.statusText||c}}b&&g._ioReady(b.status,b.statusText)}});g.applyTo=function(a,c,b){var a=c.split(".").slice(1),e=g;d.each(a,function(a){e=e[a]});e.apply(null,b)};g.xdrReady=function(){l=e.getElementById(c)};g.xdrResponse=function(c,e){var b=a[e.uid];b&&b._xdrResponse(c,e)};return k});
KISSY.add("io/sub-domain-transport",["event/dom","dom","./xhr-transport-base"],function(d,f){function i(a){var c=a.config;this.io=a;c.crossDomain=!1;"use SubDomainTransport for: "+c.url}function k(){var a=this.io.config.uri.getHostname(),a=l[a];a.ready=1;g.detach(a.iframe,"load",k,this);this.send()}var g=f("event/dom"),h=f("dom"),a=f("./xhr-transport-base"),c=d.Env.host.document,l={};d.augment(i,a.proto,{send:function(){var e=this.io.config,n=e.uri,m=n.getHostname(),j;j=l[m];var b="/sub_domain_proxy.html";
e.xdr&&e.xdr.subDomain&&e.xdr.subDomain.proxy&&(b=e.xdr.subDomain.proxy);j&&j.ready?(this.nativeXhr=a.nativeXhr(0,j.iframe.contentWindow))?this.sendInternal():"document.domain not set correctly!":(j?e=j.iframe:(j=l[m]={},e=j.iframe=c.createElement("iframe"),h.css(e,{position:"absolute",left:"-9999px",top:"-9999px"}),h.prepend(e,c.body||c.documentElement),j=new d.Uri,j.setScheme(n.getScheme()),j.setPort(n.getPort()),j.setHostname(m),j.setPath(b),e.src=j.toString()),g.on(e,"load",k,this))}});return i});
KISSY.add("io/xhr-transport",["./base","./xhr-transport-base","./xdr-flash-transport","./sub-domain-transport"],function(d,f){function i(e){var n=e.config,m=n.crossDomain,j=n.xdr||{},b=j.subDomain=j.subDomain||{};this.io=e;if(m&&!g.supportCORS){var o=n.uri.getHostname();if(c.domain&&d.endsWith(o,c.domain)&&!1!==b.proxy)return new a(e);if("flash"===""+j.use||!l)return new h(e)}e=this.nativeXhr=g.nativeXhr(m);"crossDomain: "+m+", use "+(l&&e instanceof l?"XDomainRequest":"XhrTransport")+" for: "+n.url;
return this}var k=f("./base"),g=f("./xhr-transport-base"),h=f("./xdr-flash-transport"),a=f("./sub-domain-transport"),c=d.Env.host.document,l=g.XDomainRequest_;d.augment(i,g.proto,{send:function(){this.sendInternal()}});k.setupTransport("*",i);return k});
KISSY.add("io/script-transport",["./base"],function(d,f){function i(d){var h=d.config;if(!h.crossDomain)return new (k.getTransport("*"))(d);this.io=d;"use ScriptTransport for: "+h.url;return this}var k=f("./base");k.setupConfig({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{text:{script:function(g){d.globalEval(g);return g}}}});d.augment(i,{send:function(){var g=this,h=g.io,a=h.config;
g.script=d.getScript(h._getUrlForSend(),{charset:a.scriptCharset,success:function(){g._callback("success")},error:function(){g._callback("error")}})},_callback:function(d,h){var a=this.io;this.script&&(this.script=void 0,h||("error"!==d?a._ioReady(200,"success"):"error"===d&&a._ioReady(500,"script error")))},abort:function(){this._callback(0,1)}});k.setupTransport("script",i);return k});
KISSY.add("io/jsonp",["./base"],function(d,f){var i=f("./base"),k=d.Env.host;i.setupConfig({jsonp:"callback",jsonpCallback:function(){return d.guid("jsonp")}});i.on("start",function(g){var h=g.io,a=h.config,g=a.dataType;if("jsonp"===g[0]){delete a.contentType;var c,l=a.jsonpCallback,e="function"===typeof l?l():l,n=k[e];a.uri.query.set(a.jsonp,e);k[e]=function(a){1<arguments.length&&(a=d.makeArray(arguments));c=[a]};h.fin(function(){k[e]=n;if(void 0===n)try{delete k[e]}catch(a){}else c&&n(c[0])});
h=a.converters;h.script=h.script||{};h.script.json=function(){c||" not call jsonpCallback: "+e;return c[0]};g.length=2;g[0]="script";g[1]="json"}});return i});
KISSY.add("io/form",["./base","dom","./form-serializer"],function(d,f){var i=f("./base"),k=f("dom"),g=f("./form-serializer"),h=Array.prototype.slice,a=d.Env.host.FormData;i.on("start",function(c){var l,e,c=c.io.config;if(e=c.form){l=k.get(e);e=c.data;for(var n=!1,m={},j=k.query("input",l),b=0,o=j.length;b<o;b++){var f=j[b];if("file"===f.type.toLowerCase()){n=!0;if(!a)break;var i=h.call(f.files,0);m[k.attr(f,"name")]=1<i.length?i:i[0]||null}}n&&a&&(c.files=c.files||{},d.mix(c.files,m),delete c.contentType);
!n||a?(l=g.getFormData(l),c.hasContent?(l=d.param(l,void 0,void 0,c.serializeArray),c.data=e?c.data+("&"+l):l):c.uri.query.add(l)):(e=c.dataType,c=e[0],"*"===c&&(c="text"),e.length=2,e[0]="iframe",e[1]=c)}});return i});
KISSY.add("io/iframe-transport",["dom","./base","event/dom"],function(d,f){function i(a){var c=d.guid("io-iframe"),e=h.getEmptyIframeSrc(),a=a.iframe=h.create("<iframe "+(e?' src="'+e+'" ':"")+' id="'+c+'" name="'+c+'" style="position:absolute;left:-9999px;top:-9999px;"/>');h.prepend(a,l.body||l.documentElement);return a}function k(a,c,e){var b=[],g,f,i,k;d.each(a,function(a,n){g=d.isArray(a);f=d.makeArray(a);for(i=0;i<f.length;i++)k=l.createElement("input"),k.type="hidden",k.name=n+(g&&e?"[]":""),
k.value=f[i],h.append(k,c),b.push(k)});return b}function g(a){this.io=a;"use IframeTransport for: "+a.config.url}var h=f("dom"),a=f("./base"),c=f("event/dom"),l=d.Env.host.document,e=d.clone(a.getConfig().converters.text);e.json=function(a){return d.parseJson(d.unEscapeHtml(a))};a.setupConfig({converters:{iframe:e,text:{iframe:function(a){return a}},xml:{iframe:function(a){return a}}}});d.augment(g,{send:function(){function a(){c.on(f,"load error",e._callback,e);s.submit()}var e=this,l=e.io,b=l.config,
g,f,r,A=b.data,s=h.get(b.form);e.attrs={target:h.attr(s,"target")||"",action:h.attr(s,"action")||"",encoding:h.attr(s,"encoding"),enctype:h.attr(s,"enctype"),method:h.attr(s,"method")};e.form=s;f=i(l);h.attr(s,{target:f.id,action:l._getUrlForSend(),method:"post",enctype:"multipart/form-data",encoding:"multipart/form-data"});A&&(r=d.unparam(A));r&&(g=k(r,s,b.serializeArray));e.fields=g;6===d.UA.ie?setTimeout(a,0):a()},_callback:function(a){var e=this,l=e.form,b=e.io,a=a.type,g,f=b.iframe;if(f)if("abort"===
a&&6===d.UA.ie?setTimeout(function(){h.attr(l,e.attrs)},0):h.attr(l,e.attrs),h.remove(this.fields),c.detach(f),setTimeout(function(){h.remove(f)},30),b.iframe=null,"load"===a)try{if((g=f.contentWindow.document)&&g.body)b.responseText=h.html(g.body),d.startsWith(b.responseText,"<?xml")&&(b.responseText=void 0);b.responseXML=g&&g.XMLDocument?g.XMLDocument:g;g?b._ioReady(200,"success"):b._ioReady(500,"parser error")}catch(i){b._ioReady(500,"parser error")}else"error"===a&&b._ioReady(500,"error")},abort:function(){this._callback({type:"abort"})}});
a.setupTransport("iframe",g);return a});
KISSY.add("io/methods",["promise","./base"],function(d,f){function i(a){var c=a.responseText,g=a.responseXML,e=a.config,h=e.converters,f,j,b=e.contents,i=e.dataType;if(c||g){for(e=a.mimeType||a.getResponseHeader("Content-Type");"*"===i[0];)i.shift();if(!i.length)for(f in b)if(b[f].test(e)){i[0]!==f&&i.unshift(f);break}i[0]=i[0]||"text";for(f=0;f<i.length;f++)if("text"===i[f]&&void 0!==c){j=c;break}else if("xml"===i[f]&&void 0!==g){j=g;break}if(!j){var k={text:c,xml:g};d.each(["text","xml"],function(a){var b=
i[0];if(h[a]&&h[a][b]&&k[a])return i.unshift(a),j="text"===a?c:g,!1})}}b=i[0];for(e=1;e<i.length;e++){f=i[e];var r=h[b]&&h[b][f];if(!r)throw"no covert for "+b+" => "+f;j=r(j);b=f}a.responseData=j}var k=f("promise"),g=f("./base"),h=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg;d.extend(g,k,{setRequestHeader:function(a,c){this.requestHeaders[a]=c;return this},getAllResponseHeaders:function(){return 2===this.state?this.responseHeadersString:null},getResponseHeader:function(a){var c,d,a=a.toLowerCase();if(2===this.state){if(!(d=
this.responseHeaders))for(d=this.responseHeaders={};c=h.exec(this.responseHeadersString);)d[c[1].toLowerCase()]=c[2];c=d[a]}return void 0===c?null:c},overrideMimeType:function(a){this.state||(this.mimeType=a);return this},abort:function(a){a=a||"abort";this.transport&&this.transport.abort(a);this._ioReady(0,a);return this},getNativeXhr:function(){var a=this.transport;return a?a.nativeXhr:null},_ioReady:function(a,c){if(2!==this.state){this.state=2;this.readyState=4;var d;if(200<=a&&300>a||304===a)if(304===
a)c="not modified",d=!0;else try{i(this),c="success",d=!0}catch(e){e.stack||e,"error",setTimeout(function(){throw e;},0),c="parser error"}else 0>a&&(a=0);this.status=a;this.statusText=c;var f=this.defer,h=this.config,j;if(j=this.timeoutTimer)clearTimeout(j),this.timeoutTimer=0;j=d?"success":"error";var b,k=[this.responseData,c,this],z=h.context,r={ajaxConfig:h,io:this};(b=h[j])&&b.apply(z,k);(b=h.complete)&&b.apply(z,k);g.fire(j,r);g.fire("complete",r);f[d?"resolve":"reject"](k)}},_getUrlForSend:function(){var a=
this.config,c=a.uri,h=d.Uri.getComponents(a.url).query||"";return c.toString.call(c,a.serializeArray)+(h?(c.query.has()?"&":"?")+h:h)}})});
KISSY.add("io","io/form-serializer,io/base,io/xhr-transport,io/script-transport,io/jsonp,io/form,io/iframe-transport,io/methods".split(","),function(d,f){function i(d,a,c,f,e){if(typeof a==="function"){f=c;c=a;a=void 0}return g({type:e||"get",url:d,data:a,success:c,dataType:f})}var k=f("io/form-serializer"),g=f("io/base");f("io/xhr-transport");f("io/script-transport");f("io/jsonp");f("io/form");f("io/iframe-transport");f("io/methods");d.mix(g,{serialize:k.serialize,get:i,post:function(d,a,c,f){if(typeof a===
"function"){f=c;c=a;a=void 0}return i(d,a,c,f,"post")},jsonp:function(d,a,c){if(typeof a==="function"){c=a;a=void 0}return i(d,a,c,"jsonp")},getScript:d.getScript,getJSON:function(d,a,c){if(typeof a==="function"){c=a;a=void 0}return i(d,a,c,"json")},upload:function(d,a,c,f,e){if(typeof c==="function"){e=f;f=c;c=void 0}return g({url:d,type:"post",dataType:e,form:a,data:c,success:f})}});d.mix(d,{Ajax:g,IO:g,ajax:g,io:g,jsonp:g.jsonp});return g});
/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 4 22:17
*/
KISSY.add("promise",[],function(k){function t(a){"undefined"!==typeof console&&console.error&&console.error(a)}function o(a,b,d){if(a instanceof g)p(function(){d.call(a,a[e])});else{var l=a[e],c=a[i];c?c.push([b,d]):m(l)?o(l,b,d):b&&p(function(){b.call(a,l)})}}function f(a){if(!(this instanceof f))return new f(a);this.promise=a||new c;this.promise.defer=this}function m(a){return a&&a instanceof c}function c(a){this[e]=a;void 0===a&&(this[i]=[],this[n]=[])}function g(a){if(a instanceof g)return a;
c.apply(this,arguments);this[e]instanceof c&&"assert.not(this.__promise_value instanceof promise) in Reject constructor";return this}function j(a,b,d){function l(a){try{return b?b.call(this,a):a}catch(d){return t(d.stack||d),new g(d)}}function e(a){try{return d?d.call(this,a):new g(a)}catch(b){return t(b.stack||b),new g(b)}}function u(a){h?"already done at fulfilled":a instanceof c?"assert.not(value instanceof Promise) in when":(h=1,q.resolve(l.call(this,a)))}var q=new f,h=0;a instanceof c?o(a,u,
function(a){h?"already done at rejected":(h=1,q.resolve(e.call(this,a)))}):u(a);return q.promise}function r(a){return!s(a)&&m(a)&&void 0===a[i]&&(!m(a[e])||r(a[e]))}function s(a){return m(a)&&void 0===a[i]&&a[e]instanceof g}var e="__promise_value",p=k.setImmediate,n="__promise_progress_listeners",i="__promise_pendings";f.prototype={constructor:f,resolve:function(a){var b=this.promise,d;if(!(d=b[i]))return null;b[e]=a;d=[].concat(d);b[i]=void 0;b[n]=void 0;k.each(d,function(a){o(b,a[0],a[1])});return a},
reject:function(a){return this.resolve(new g(a))},notify:function(a){k.each(this.promise[n],function(b){p(function(){b(a)})})}};c.prototype={constructor:c,then:function(a,b,d){d&&this.progress(d);return j(this,a,b)},progress:function(a){this[n]&&this[n].push(a);return this},fail:function(a){return j(this,0,a)},fin:function(a){return j(this,function(b){return a(b,!0)},function(b){return a(b,!1)})},done:function(a,b){(a||b?this.then(a,b):this).fail(function(a){a.stack||a;"error";setTimeout(function(){throw a;
},0)})},isResolved:function(){return r(this)},isRejected:function(){return s(this)}};k.extend(g,c);KISSY.Defer=f;KISSY.Promise=c;c.Defer=f;k.mix(c,{when:j,isPromise:m,isResolved:r,isRejected:s,all:function(a){var b=a.length;if(!b)return null;for(var d=new f,c=0;c<a.length;c++)(function(c,e){j(c,function(c){a[e]=c;0===--b&&d.resolve(a)},function(a){d.reject(a)})})(a[c],c);return d.promise},async:function(a){return function(){function b(a,b){var h;try{h=f[a](b)}catch(i){return new g(i)}return h.done?
h.value:j(h.value,c,e)}function c(a){return b("next",a)}function e(a){return b("throw",a)}var f=a.apply(this,arguments);return c()}}});return c});
/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 6 15:30
*/
KISSY.add("base",["attribute"],function(e,q){function h(b,a){return function(d){return function(){a?d.apply(this,arguments):this.callSuper.apply(this,arguments);var c=arguments.callee.__owner__.__extensions__||[];a&&c.reverse();var f=arguments,e;if(e=c&&c.length)for(var g=0;g<e;g++){var m=c[g]&&(!b?c[g]:c[g].prototype[b]);m&&m.apply(this,f||[])}a?this.callSuper.apply(this,arguments):d.apply(this,arguments)}}}function n(b){var a=this.__hooks__,d=this.prototype;if(this.__extensions__.length&&a)for(var c in a)if(!d.hasOwnProperty(c)||
b.hasOwnProperty(c))b[c]=b[c]||o;return r.call(this,b)}function s(b){var a;b.target===this&&(a=this[i+b.type.slice(5).slice(0,-6)],a.call(this,b.newVal,b))}function t(b){var a=b.get("plugins"),d;e.each(a,function(b,f){"function"===typeof b&&(d=b,a[f]=new d)})}function j(b){var a,d=this.get("plugins");if(a=d.length)for(var c=0;c<a;c++)if(d[c][b])d[c][b](this)}var p=q("attribute"),k=e.ucfirst,i="_onSet",o=e.noop,l=p.extend({constructor:function(){this.callSuper.apply(this,arguments);var b=this.get("listeners"),
a;for(a in b)this.on(a,b[a]);this.initializer();t(this);j.call(this,"pluginInitializer");this.bindInternal();this.syncInternal()},initializer:o,__getHook:h,__callPluginsMethod:j,bindInternal:function(){var b=this.getAttrs(),a,d;for(a in b)if(d=i+k(a),this[d])this.on("after"+k(a)+"Change",s)},syncInternal:function(){var b=[],a;a=this.constructor;for(var d=this.getAttrs();a;)b.push(a),a=a.superclass&&a.superclass.constructor;b.reverse();for(a=0;a<b.length;a++){var c=b[a].ATTRS||{},f;for(f in c)if(f in
d){var e,g;(g=this[i+k(f)])&&0!==d[f].sync&&void 0!==(e=this.get(f))&&g.call(this,e)}}},plug:function(b){"function"===typeof b&&(b=new b);b.pluginInitializer&&b.pluginInitializer(this);this.get("plugins").push(b);return this},unplug:function(b){var a=[],d=this,c="string"===typeof b;e.each(d.get("plugins"),function(f){var e=0,g;b&&(c?(g=f.get&&f.get("pluginId")||f.pluginId,g!==b&&(a.push(f),e=1)):f!==b&&(a.push(f),e=1));e||f.pluginDestructor(d)});d.setInternal("plugins",a);return d},getPlugin:function(b){var a=
null;e.each(this.get("plugins"),function(d){if((d.get&&d.get("pluginId")||d.pluginId)===b)return a=d,!1});return a},destructor:e.noop,destroy:function(){this.get("destroyed")||(j.call(this,"pluginDestructor"),this.destructor(),this.set("destroyed",!0),this.fire("destroy"),this.detach())}});e.mix(l,{__hooks__:{initializer:h(),destructor:h("__destructor",!0)},ATTRS:{plugins:{value:[]},destroyed:{value:!1},listeners:{value:[]}},extend:function a(d,c,f){e.isArray(d)||(f=c,c=d,d=[]);f=f||{};c=c||{};c=
p.extend.call(this,c,f);c.__extensions__=d;n.call(c,{});if(d.length){var h={},g={};e.each(d.concat(c),function(a){if(a){e.each(a.ATTRS,function(a,c){var d=h[c]=h[c]||{};e.mix(d,a)});var a=a.prototype,c;for(c in a)a.hasOwnProperty(c)&&(g[c]=a[c])}});c.ATTRS=h;g.constructor=c;e.augment(c,g)}c.extend=f.extend||a;c.addMembers=n;return c}});var r=l.addMembers;return e.Base=l});
/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 4 22:04
*/
KISSY.add("attribute",["event/custom"],function(g,p,F,C){function n(d,a){return"string"===typeof a?d[a]:a}function o(d){return d.__attrVals||(d.__attrVals={})}function q(d,a,c,b,e,f,h,i){h=h||c;return d.fire(a+g.ucfirst(c)+"Change",g.mix({attrName:h,subAttrName:f,prevVal:b,newVal:e},i))}function k(d,a,c){var b=d[a];!c&&!b&&(d[a]=b={});return b||{}}function t(d,a){for(var c=0,b=a.length;void 0!==d&&c<b;c++)d=d[a[c]];return d}function u(d){var a;-1!==d.indexOf(".")&&(a=d.split("."),d=a.shift());return{path:a,
name:d}}function v(d,a,c){var b=c;if(a){var d=b=void 0===d?{}:g.clone(d),e=a.length-1;if(0<=e){for(var f=0;f<e;f++)d=d[a[f]];void 0!==d&&(d[a[f]]=c)}}return b}function w(d,a,c,b,e){var f,h,i;f=u(a);var D=a,a=f.name;f=f.path;i=d.get(a);var l=a,m=k(d,"__defaultBeforeFns");m[l]||(m[l]=1,l="before"+g.ucfirst(l)+"Change",d.publish(l,{defaultFn:x}));f&&(h=t(i,f));if(b.force||!(!f&&i===c||f&&h===c)){c=v(i,f,c);c=g.mix({attrName:a,subAttrName:D,prevVal:i,newVal:c,_opts:b,_attrs:e,target:d},b.data);if(b.silent){if(j===
x.call(d,c))return j}else if(j===d.fire("before"+g.ucfirst(a)+"Change",c))return j;return d}}function x(d){if(d.target===this){var a=d.newVal,c=d.prevVal,b=d.attrName,e=d.subAttrName,f=d._attrs,d=d._opts,a=this.setInternal(b,a);if(a===j)return a;d.silent||(a=o(this)[b],q(this,"after",b,c,a,e,null,d.data),f?f.push({prevVal:c,newVal:a,attrName:b,subAttrName:e}):q(this,"","*",[c],[a],[e],[b],d.data))}}function r(d){var a=this.constructor;for(this.userConfig=d;a;){var c=a.ATTRS;if(c){var b=void 0;for(b in c)this.addAttr(b,
c[b],!1)}a=a.superclass?a.superclass.constructor:null}if(d)for(var e in d)this.setInternal(e,d[e])}function y(d,a){var c=a.__hooks__||{},b;for(b in c)b in d&&(d[b]=c[b](d[b]));g.each(d,function(b,c){if("function"===typeof b){var g=0;if(b.__owner__){var i=b.__owner__;delete b.__owner__;delete b.__name__;var g=b.__wrapped__=1,j=z(b);j.__owner__=i;j.__name__=c;i.prototype[c]=j}else b.__wrapped__&&(g=1);g&&(d[c]=b=z(b));b.__owner__=a;b.__name__=c}})}function E(d){y(d,this);g.mix(this.prototype,d)}function s(d,
a){var c=d.getAttrs(),b=k(c,a,1),e=b.valueFn;if(e&&(e=n(d,e)))e=e.call(d),void 0!==e&&(b.value=e),delete b.valueFn,c[a]=b;return b.value}function A(d,a,c,b){var e,f;e=u(a);a=e.name;if(e=e.path)f=d.get(a),c=v(f,e,c);if((e=k(d.getAttrs(),a).validator)&&(e=n(d,e)))if(d=e.call(d,c,a,b),void 0!==d&&!0!==d)return d}p=p("event/custom");C.exports=r;var z=g.bind,B={},j=!1;r.extend=function a(c,b){var e,b=b||{},c=c||{},f=b.__hooks__;if(e=this.__hooks__)f=b.__hooks__=b.__hooks__||{},g.mix(f,e,!1);e=c.hasOwnProperty("constructor")?
c.constructor:function(){this.callSuper.apply(this,arguments)};c.constructor=e;e.__hooks__=f;y(c,e);var h=b.inheritedStatics;if(f=this.inheritedStatics)h=b.inheritedStatics=b.inheritedStatics||{},g.mix(h,f,!1);g.extend(e,this,c,b);h&&g.mix(e,h);e.extend=b.extend||a;e.addMembers=E;return e};g.augment(r,p.Target,{INVALID:B,callSuper:function(){var a,c,b=arguments;"function"===typeof this&&this.__name__?(a=this,c=b[0],b=Array.prototype.slice.call(b,1)):(a=arguments.callee.caller,a.__wrapped__&&(a=a.caller),
c=this);var e=a.__name__;if(e)return a=a.__owner__.superclass[e],!a?void 0:a.apply(c,b||[])},getAttrs:function(){return this.__attrs||(this.__attrs={})},getAttrVals:function(){var a={},c,b=this.getAttrs();for(c in b)a[c]=this.get(c);return a},addAttr:function(a,c,b){var e=this.getAttrs(),f,c=g.clone(c);(f=e[a])?g.mix(f,c,b):e[a]=c;return this},addAttrs:function(a,c){var b=this;g.each(a,function(a,c){b.addAttr(c,a)});c&&b.set(c);return b},hasAttr:function(a){return this.getAttrs().hasOwnProperty(a)},
removeAttr:function(a){var c=o(this),b=this.getAttrs();this.hasAttr(a)&&(delete b[a],delete c[a]);return this},set:function(a,c,b){var e;if(g.isPlainObject(a)){var b=c||{},c=Object(a),f=[],h=[];for(a in c)void 0!==(e=A(this,a,c[a],c))&&h.push(e);if(h.length)return b.error&&b.error(h),j;for(a in c)w(this,a,c[a],b,f);var i=[],k=[],l=[],m=[];g.each(f,function(a){k.push(a.prevVal);l.push(a.newVal);i.push(a.attrName);m.push(a.subAttrName)});i.length&&q(this,"","*",k,l,m,i,b.data);return this}b=b||{};e=
A(this,a,c);return void 0!==e?(b.error&&b.error(e),j):w(this,a,c,b)},setInternal:function(a,c){var b,e=k(this.getAttrs(),a).setter;if(e&&(e=n(this,e)))b=e.call(this,c,a);if(b===B)return j;void 0!==b&&(c=b);o(this)[a]=c},get:function(a){var c,b=o(this),e,f;-1!==a.indexOf(".")&&(c=a.split("."),a=c.shift());e=k(this.getAttrs(),a,1).getter;f=a in b?b[a]:s(this,a);if(e&&(e=n(this,e)))f=e.call(this,f,a);!(a in b)&&void 0!==f&&(b[a]=f);c&&(f=t(f,c));return f},reset:function(a,c){if("string"===typeof a)return this.hasAttr(a)?
this.set(a,s(this,a),c):this;var c=a,b=this.getAttrs(),e={};for(a in b)e[a]=s(this,a);this.set(e,c);return this}})});
KISSY.add("mui/datalazyload/webp",function(t){function e(e){var i=window.localStorage&&window.localStorage.getItem("webpsupport");if(i!==null){e(i==="true");return}n(function(n){try{window.localStorage&&window.localStorage.setItem("webpsupport",n)}catch(i){t.log(i)}e(n)})}function n(t){var e=new Image,n;e.onload=e.onerror=function(){if(!n){n=true;t(e.width===2&&e.height===2)}};setTimeout(function(){if(!n){n=true;t(false)}},16);e.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}var i=window.WebP={};i.isSupport=function(t){if(!t)return;if(i._isSupport===undefined){e(function(e){t(i._isSupport=e)});return}t(i._isSupport)};return i},{attach:false});KISSY.add("mui/datalazyload/index",function(t,e,n,i,o){var a=t.Env.host,r=a.document,f="data-ks-lazyload",l="ks-datalazyload",c="-custom",s="default",u="none",d="scroll",g="touchmove",m="resize",h=100,v=0,_;function y(t){var n=e.scrollLeft(),i=e.scrollTop();if(t.getBoundingClientRect){var o=t.getBoundingClientRect(),a=document,r=a.body,f=a&&a.documentElement,l=window.getComputedStyle&&window.getComputedStyle(t).zoom||1;n+=o.left*l-(f.clientLeft||r.clientLeft||0);i+=o.top*l-(f.clientTop||r.clientTop||0)}return{left:n,top:i}}function p(t){var e,n,i=[],o;return function(a,r){if(r!==0&&!r){r=1}if(r&1&&!n){n=true;t(function(t){e=t;while(o=i.shift()){try{o&&o.apply(null,[e])}catch(n){setTimeout(function(){throw n},0)}}})}if(e){a&&a.apply(null,[e]);return e}if(!(r&2)){a&&i.push(a)}return e}}function b(e,n,i){var o,a=0,r=0,n=n||150;function f(){if(o){o.cancel();o=0}a=t.now();e.apply(i||this,arguments);r=t.now()}return t.mix(function(){if(!a||r>=a&&t.now()-r>n||r<a&&t.now()-a>n*8){f()}else{if(o){o.cancel()}o=t.later(f,n,0,null,arguments)}},{stop:function(){if(o){o.cancel();o=0}}})}function w(t,e,n){var i=t.length;function o(){i?t[--i].call(null,e,o):n(e)}o()}function A(t,n,i){if(!t.offsetWidth){return false}var o=y(t),a=window.getComputedStyle&&window.getComputedStyle(t).zoom||1,r=true,f,l=o.left,c=o.top,s={left:l,top:c,right:l+(t._ks_lazy_width||(t._ks_lazy_width=e.outerWidth(t)*a)),bottom:c+(t._ks_lazy_height||(t._ks_lazy_height=e.outerHeight(t)*a))};f=R(n,s);if(f&&i){r=R(i,s)}return r&&f}function k(t){if(/^(loaded|complete)$/.test(document.readyState)){return t()}if(window.addEventListener){return window.addEventListener("load",t,false)}if(window.attachEvent){return window.attachEvent("onload",t)}}function S(t){var e=["webkit",""],n=r.createElement("div"),i=e.length;for(var i=0,a=e.length;i<a;i++){if(!e[i]){t=t.toLowerCase()}if(n.style[e[i]+t]!==o){return true}}return false}function I(e,n){var i=this;if(!(i instanceof I)){return new I(e,n)}var o=e;if(!t.isPlainObject(o)){o=n||{};if(e){o.container=e}}I.superclass.constructor.call(i,o);i._diffRatio=0;i._callbacks={};i._startLis=[];i._containerIsNotDocument=i.get("container").nodeType!=9;i._fade=S("Animation")&&!(/Android (\d+\.\d+)/i.test(a.navigator.userAgent)&&parseFloat(RegExp["$1"])<4.3);if(t.isArray(o.container)){i._backCompact=1}i["_initLoadEvent"]();o.container&&i.addElements(o.container);i._loadFn();t.ready(function(){i._loadFn()});k(function(){i._diffRatio=Math.max(t.UA.ios?2:1,i._diffRatio);i._loadFn()});i.resume();i.on("afterDiffChange",function(t){if(t.newVal===t.prevVal)return;i._windowRegion=i["_getBoundingRect"]();if(!i._backCompact&&i._containerIsNotDocument){i._containerRegion=i["_getBoundingRect"](i.get("container"))}})}I.ATTRS={diff:{value:s},placeholder:{value:window.ActiveXObject&&!document.documentMode?"//g.alicdn.com/s.gif":"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="},execScript:{value:true},fade:{value:true},container:{setter:function(n){n=n||r;if(t.isWindow(n)){n=n.document}else{n=e.get(n);if(e.nodeName(n)=="body"){n=n.ownerDocument}}return n},valueFn:function(){return r}},autoDestroy:{value:true},onStart:{value:null}};function R(t,e){var n={};n.top=Math.max(t.top,e.top);n.bottom=Math.min(t.bottom,e.bottom);n.left=Math.max(t.left,e.left);n.right=Math.min(t.right,e.right);return n.bottom>=n.top&&n.right>=n.left}t.extend(I,i,{addStartListener:function(e){var n=this._startLis;if(!e||t.indexOf(e,n)>=0){return}n.push(e)},_initLoadEvent:function(){var i=this,o=i.get("autoDestroy");i.addStartListener(function(t,e){var n=i.get("onStart");if(n){var o=n.apply(this,arguments);if(o===true||o===false){t.returnValue=o}}e()});i.addStartListener(function(e,n){if(e.type!="img"){n();return}var o=i.get("webpReplacer");if(t.isFunction(o)){t.use("mui/datalazyload/webp",function(t,i){i.isSupport(function(t){if(t){e.src=o(e.src)}n()})})}else{n()}});i.imgHandle=function(){var t=this,o=i.get("imgFlag")||f,a=t.getAttribute(o);w(i._startLis,{type:"img",elem:t,src:a},function(a){if(a.returnValue===false){return}if(a.src&&t.src!=a.src){if(i.isFade){var r="img-ks-lazyload",f="img-ks-beforeload";e.addClass(t,f);n.on(t,"load",function(){n.detach(t,"load",arguments.callee);e.removeClass(t,f);e.addClass(t,r);i.refresh()})}t.src=a.src}t.removeAttribute(o)})};i.bgimgHandle=function(){var t=this,e=(i.get("imgFlag")||f)+"-bg",n=t.getAttribute(e);w(i._startLis,{type:"bgimg",elem:t,bgimgSrc:n},function(n){if(n.returnValue===false){return}if(n.bgimgSrc){var i=t&&t.filters,o,a;try{o=i&&i.item("DXImageTransform.Microsoft.AlphaImageLoader");a=i&&i.item("DXImageTransform.Microsoft.Matrix")}catch(r){}if(o){o.src=n.bgimgSrc;o.enabled=true;function f(t,e){var n=new Image;n.style.position="absolute";n.style.visibility="visible";n.onload=n.onerror=function(){e(n);document.body.removeChild(n);n=null};document.body.appendChild(n);n.src=t}if(!a||!t.offsetWidth||!t.offsetHeight){return}f(n.bgimgSrc,function(e){if(!e.offsetWidth||!e.offsetHeight){return}var n=t.currentStyle["background-size"]=="cover"?"cover":"contain";if(e.offsetHeight/e.offsetWidth>t.offsetHeight/t.offsetWidth===(n=="contain")){a.M11=t.offsetHeight*e.offsetWidth/(t.offsetWidth*e.offsetHeight);a.M22=1;a.Dx=t.offsetWidth*(1-a.M11)/2;a.Dy=0}else{a.M11=1;a.M22=t.offsetWidth*e.offsetHeight/(t.offsetHeight*e.offsetWidth);a.Dx=0;a.Dy=t.offsetHeight*(1-a.M22)/2}a.enabled=true})}else{t.style.backgroundImage="url("+n.bgimgSrc+")"}}t.removeAttribute(e)})};i.textareaHandle=function(){var t=this;t.style.display=u;t.className="";var n=e.create("<div>");t.parentNode.insertBefore(n,t);w(i._startLis,{type:"textarea",elem:t,value:t.value},function(t){if(t.returnValue===false){return}e.html(n,t.value,i.get("execScript"));i.addElements(n);i.refresh()})};i._loadFn=b(function(){if(o&&t.isEmptyObject(i._callbacks)){i.destroy()}i["_loadItems"]()},h,i);i._onScroll=function(e){i._onScroll=i._loadFn;i._diffRatio=Math.max(t.UA.ios?4:2,i._diffRatio);i._loadFn()}},refresh:function(){this._loadFn()},_loadItems:function(){var e=this,n=e.get("container");if(e._containerIsNotDocument&&!n.offsetWidth){return}e._windowRegion=e["_getBoundingRect"]();if(!e._backCompact&&e._containerIsNotDocument){e._containerRegion=e["_getBoundingRect"](e.get("container"))}t.each(e._callbacks,function(t,n){t&&e._loadItem(n,t)})},_loadItem:function(t,e){var n=this,e=e||n._callbacks[t];if(!e){return true}var i=e.el,o=false,a=e.fn;if(n.get("force")||A(i,n._windowRegion,n._containerRegion)){try{o=a.call(i)}catch(r){setTimeout(function(){throw r},0)}}if(o!==false){delete n._callbacks[t]}return o},addCallback:function(n,i){n=e.get(n);var o=this,a=o._callbacks,r={el:n||document,fn:i||t.noop},f=++v;a[f]=r;if(o._windowRegion){o._loadItem(f,r)}else{o.refresh()}return f},removeCallback:function(n,i){n=e.get(n);var o=this._callbacks;t.each(o,function(t,e){if(t.el==n&&(i?t.fn==i:1)){delete o[e]}})},getElements:function(){var e=this,n=[],i=[],o=e._callbacks;t.each(o,function(t){if(t.fn==e.imgHandle){n.push(t.el)}if(t.fn==e.textareaHandle){i.push(t.el)}});return{images:this._images,textareas:this._textareas}},addElements:function(n,i){if(typeof n=="string"){n=e.query(n)}else if(!t.isArray(n)){n=[n]}var o=this;o._addStyle();t.each(n,function(n){if(!n){return}if(!i||i==="img"){t.each(t.filter([n].concat(e.query("img",n)),function(t){return t.getAttribute&&t.getAttribute(o.get("imgFlag")||f)},o),function(t){var e=o.addCallback(t,o.imgHandle);if(!t.offsetWidth){t.onload=t.onerror=function(){setTimeout(function(){o._loadItem(e)},0)};if(!t.src){o.onPlaceHolder=o.onPlaceHolder||p(function(t){var e=o._phImg=new Image,n=o.get("placeholder");e.onload=e.onerror=function(){t(n)};e.src=n});o.onPlaceHolder(function(e){if(!t.src){t.src=e}})}}})}if(!i||i==="bgimg"){var a=(o.get("imgFlag")||f)+"-bg";t.each(t.filter([n].concat(e.query("["+a+" ]",n)),function(t){return t.getAttribute&&t.getAttribute(a)},o),function(t){o.addCallback(t,o.bgimgHandle)})}if(!i||i==="textarea"){t.each(e.query("textarea."+(o.get("areaFlag")||l),n),function(t){o.addCallback(t,o.textareaHandle)})}})},removeElements:function(n){if(typeof n=="string"){n=e.query(n)}else if(!t.isArray(n)){n=[n]}var i=this,o=i._callbacks;t.each(o,function(e,i){if(t.inArray(e.el,n)){delete o[i]}})},_getBoundingRect:function(n){var i,a,r,f;if(n!==o){i=e.outerHeight(n);a=e.outerWidth(n);var l=y(n);r=l.left;f=l.top}else{i=e.viewportHeight();a=e.viewportWidth();r=e.scrollLeft();f=e.scrollTop()}var c=this.get("diff"),u=this._diffRatio;if(c===s){c={left:0,top:0,right:a*u,bottom:i*u}}else if(!t.isObject(c)){c={left:c,top:c,right:c,bottom:c}}return{left:r-(c.left||0),top:f-(c.top||0),right:r+a+(c.right||0),bottom:f+i+(c.bottom||0)}},pause:function(){var t=this,e=t._onScroll,i=t._loadFn;if(t._destroyed){return}n.remove(a,d,e);n.remove(a,g,e);n.remove(a,m,i);i.stop();if(t._containerIsNotDocument){var o=t.get("container");n.remove(o,d,e);n.remove(o,g,e)}},resume:function(){var t=this,e=t._onScroll,i=t._loadFn;if(t._destroyed){return}n.on(a,d,e);n.on(a,g,e);n.on(a,m,i);if(t._containerIsNotDocument){var o=t.get("container");n.on(o,d,e);n.on(o,g,e)}},destroy:function(){var e=this;e.pause();e._callbacks={};t.log("datalazyload is destroyed!");e.fire("destroy");e._destroyed=1},_addStyle:function(){var t=this;if(t._fade){t.isFade=t.get("fade");if(t.isFade&&!_){_=true;e.addStyleSheet("@-webkit-keyframes ks-fadeIn{0%{opacity:0}100%{opacity:1}}"+"@keyframes ks-fadeIn{0%{opacity:0}100%{opacity:1}}"+".img-ks-lazyload{-webkit-animation:ks-fadeIn 350ms linear 0ms 1 normal both;animation:ks-fadeIn 350ms linear 0ms 1 normal both;opacity:1}"+".img-ks-beforeload{opacity:0}")}}}});function C(n,i,o,a){if(i==="img-src"){i="img"}if(!t.isArray(n)){n=[e.get(n)]}var s=new I(r,{});s.set("imgFlag",o||f+c);s.set("areaFlag",o||l+c);s.set("onStart",a);s.set("force",true);s.addElements(n,i)}I.loadCustomLazyData=C;var H;I.instance=function(){return H||(H=new I(null,{autoDestroy:false}))};t.DataLazyload=I;return I},{requires:["dom","event","base"]});!function(){function e(e,t,n){if("string"==typeof e){"object"==typeof t&&(n=t,t="bat"),t="bat"===e?"":t||"bat",n=n||{},n.module=n.module||"",n.type=n.type||"normal",n.msg=n.msg||"",n.version=n.version||"",E||(E=e);var o=+new Date;A[e]=o;var i=e===E?0:o-(A[t||E]||A[E]);"error"===n.type?this.pushFull([e+"_"+n.module,e,t,n.module,n.version,n.msg,Math.max(i,0),1]):this.push([e+"_"+n.module,e,t,n.module,n.version,n.msg,Math.max(i,0),0])}}function t(e,n){return n=n?n:"",e?t(--e,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".charAt(Math.floor(60*Math.random()))+n):n}function n(e,t,n){return e.split(t).join(n)}function o(e,t){for(var n in e)e.hasOwnProperty(n)&&t.call(e,e[n],n)}function i(){if(q)return q;var e="",t="";if(window.goldlog&&window.goldlog.spm_ab)return e=window.goldlog.spm_ab.join(".").split("/")[0],e=e.split("-")[0];e=document.getElementsByTagName("meta");for(var n=e.length;n--&&("spm-id"!==e[n].name&&"data-spm"!==e[n].name););return(e=e[n])?(e=e.content.split("/")[0],(e=e.split("-")[0])?(t=document.body&&document.body.getAttribute("data-spm"),t?e+"."+t:""):""):void 0}function r(e){var t,o,i,r=[];for(t=0,o=e.length;t<o;t++)i=e[t],"object"==typeof i?r.push(JSON.stringify(i)):null===i||void 0===i?r.push(""):r.push(i+"");for(t=r.length;t--;)r[t]=n(n(r[t],"|","\u4e28"),";","\uff1b");return r}function a(){for(var e=0,t=new Array(256),n=0;256!==n;++n){e=n;for(var o=8;o--;)e=1&e?-306674912^e>>>1:e>>>1;t[n]=e}return"undefined"!=typeof Int32Array?new Int32Array(t):t}function u(e){for(var t,n,o=-1,i=0,r=e.length;i<r;)t=e.charCodeAt(i++),t<128?o=o>>>8^P[255&(o^t)]:t<2048?(o=o>>>8^P[255&(o^(192|t>>6&31))],o=o>>>8^P[255&(o^(128|63&t))]):t>=55296&&t<57344?(t=(1023&t)+64,n=1023&e.charCodeAt(i++),o=o>>>8^P[255&(o^(240|t>>8&7))],o=o>>>8^P[255&(o^(128|t>>2&63))],o=o>>>8^P[255&(o^(128|n>>6&15|(3&t)<<4))],o=o>>>8^P[255&(o^(128|63&n))]):(o=o>>>8^P[255&(o^(224|t>>12&15))],o=o>>>8^P[255&(o^(128|t>>6&63))],o=o>>>8^P[255&(o^(128|63&t))]);return o^-1}function s(){try{if(!b)return[];var e=window.localStorage.getItem("bat");e=e?JSON.parse(e):{};var t=[];o(e,function(e,n){j-e.time>I&&t.push(n)});for(var n=t.length;n--;)delete e[t[n]];window.localStorage.setItem("bat",JSON.stringify(e))}catch(i){}}function l(e){try{if(!b)return[];var t=window.localStorage.getItem("bat");t=t?JSON.parse(t):{};var n=t[S]||{};return n[e]||[]}catch(o){return[]}}function c(e,t){try{if(!b)return[];var n=window.localStorage.getItem("bat");n=n?JSON.parse(n):{};var o=n[S]=n[S]||{};o[e]=t,o.time=+new Date,window.localStorage.setItem("bat",JSON.stringify(n))}catch(i){}}function d(e){var t=document.createElement("script");t.src=e,t.onload=function(){this.remove()};var n=document.getElementsByTagName("head")[0];n.appendChild(t)}function h(e){var t=this;this.api=e.api||"",this.chksum=e.chksum||"",this.name=e.name||"none",this.sender=e.sender||function(){},this.windowOnLoaded=!1,this.queueName=e.name+"_queue",this.fullQueueName=e.name+"_full_queue",this.sendingTask=null,this.bindEvent(),this.setQueue(window[this.queueName]||[]);try{this.setFullQueue([].concat(l(this.fullQueueName)).concat(window[this.fullQueueName]||[]))}catch(n){this.setFullQueue([].concat(window[this.fullQueueName]||[]))}(this.queue.length>0||this.fullQueue.length>0)&&this.waitSendStart(),window[e.name+"Track"]=function(){t.sender.apply(t,Array.prototype.slice.call(arguments)),t.waitSendStart()},window[e.name+"TrackIme"]=function(){t.sender.apply(t,Array.prototype.slice.call(arguments)),t.sendingTask&&clearTimeout(t.sendingTask),t.sendQueue(),t.waitSendStart()}}function w(e){return e.replace(/^\s+|\s+$/g,"")}function p(e){e=e||"",e=e.split("\n").slice(1,3);for(var t=e.length;t--;)e[t]=w(e[t]).replace(/\((.*)\)/,function(e,t){return t=t.split(":"),"("+[Number(t[2])||0,Number(t[3])||0].join(":")+")"});return e.join("^")}function f(e){e=e||"";var t=e.split(",");return t.length<=2?e:[t[0],"...",t[t.length-1]].join(",")}function m(e,t,n,o,i){try{"string"==typeof e?window.batTrack("jserror","bat",{"type":"error","msg":[e,f(t),n,o,p(i&&i.stack)].join("^")}):window.batTrack("jserror","bat",{"type":"error","msg":[e.message,f(e&&e.filename),e&&e.lineno,e&&e.colno,p(e&&e.error&&e.error.stack)].join("^")})}catch(e){}}var g=window.batSamplingFile||"",v=window.batIntervalBeforeOnload||3e3,y=window.batIntervalAfterOnload||1500,k=window.batProxy||"",b=!!(window.localStorage&&window.localStorage.setItem&&window.localStorage.getItem),Q=1700,S=window.location.host+window.location.pathname,T="//gm.mmstat.com",N=encodeURIComponent,j=+new Date,E="",A={},I=864e5,O=0,_=/(iPhone|iPad|iPod|iOS|Android)/i.test(window.navigator.userAgent),F=t(20),q="",x=[],L=null;if(s(),g){var M=g.split("/");window[M[M.length-1]]=function(e){L=e||null;for(var t=0;t<x.length;t++)x[t]();delete window[M[M.length-1]]},d(g+"?wh_callback=true")}window.setCtkSpm=window.setBatSpm=function(e){q=e};var P=a();h.prototype.push=function(e){this.queue.push(e)},h.prototype.pushFull=function(e){this.fullQueue.push(e)},h.prototype.setQueue=function(e){window[this.queueName]=this.queue=e},h.prototype.setFullQueue=function(e){window[this.fullQueueName]=this.fullQueue=e,c(this.fullQueueName,e)},h.prototype.bindEvent=function(){function e(){t.windowOnLoaded=!0,window.detachEvent?window.detachEvent("onload",e):window.removeEventListener("load",e,!1)}var t=this;window.Ali&&window.Ali.regProxy&&window.Ali.pushWindow&&window.Ali.regProxy("pushWindow",function(e){return t.sendQueue(),e}),window.attachEvent?(window.attachEvent("onload",e),window.attachEvent("onbeforeunload",function(){t.sendQueue()})):(window.addEventListener("load",e,!1),window.addEventListener("beforeunload",function(){t.sendQueue()},!1))},h.prototype.sendStart=function(){var e=this;e.sendingTask||(e.sendingTask=setTimeout(function(){e.sendQueue(),e.sendingTask=null,(e.queue.length>0||e.fullQueue.length>0)&&e.waitSendStart()},e.windowOnLoaded?y:v))},h.prototype.waitSendStart=function(){var e=this;g&&!L?x.push(function(){e.sendStart()}):e.sendStart()},h.prototype.sendQueue=function(){this.setQueue(this.formatQueue(this.queue)),this.setFullQueue(this.formatQueue(this.fullQueue)),this.sendNormalQueue(),this.sendFullQueue()},h.prototype.formatQueue=function(e){for(var t=[],n=0,o=e.length;n<o;n++){var i=e[n];"[object array]"===Object.prototype.toString.call(i).toLowerCase()?t.push({"length":1,"point":i}):t.push(i)}return t},h.prototype.mergeQueue=function(e){var t,n,i,r,a=[],u={};for(t=0,n=e.length;t<n;t++){r=e[t];try{i=r.point[0],u[i]=u[i]||{"point":null,"length":0},u[i].length+=r.length,Math.random()*u[i].length<=r.length&&(u[i].point=r.point)}catch(s){continue}}return o(u,function(e){a.push(e)}),a},h.prototype.sendNormalQueue=function(){var e,t=[],n=[],o=0;for(t=this.mergeQueue(this.queue),t.sort(function(){return Math.random()-.5}),e=t.length;e--;)try{var i=N(r([].concat(t[e].point.slice(1)).concat([1e3])).join("|")).length;if(o+i>Q)break;if(g){var a=L&&L.normal&&L.normal[t[e].point[0]]||1;Math.random()<1/a&&(t[e].length=t[e].length*a,n.push(t[e]),o+=i)}else n.push(t[e]),o+=i}catch(u){continue}for(e=n.length;e--;)n[e]=r([].concat(n[e].point.slice(1)).concat([n[e].length*Math.round(t.length/n.length)])).join("|");this.send(n.join(";")),this.setQueue([])},h.prototype.sendFullQueue=function(){var e,t=[],n=[],o=0;for(t=this.mergeQueue(this.fullQueue),this.setFullQueue(t);t.length;)try{var i=t[0],a=N(r([].concat(i.point.slice(1)).concat([i.length])).join("|")).length;if(a>Q&&t.shift(),o+a>Q)break;if(g){var u=L&&L.full&&L.full[t[0].point[0]]||1;Math.random()<1/u?(t[0].length=t[0].length*u,n.push(t.shift()),o+=a):t.shift()}else n.push(t.shift()),o+=a}catch(s){t.shift();continue}for(e=n.length;e--;)n[e]=r([].concat(n[e].point.slice(1)).concat([n[e].length])).join("|");this.send(n.join(";"))},h.prototype.send=function(e){if(e){var t=i();if(t){var n=["msg="+N(e),"hash="+u(e),"spm="+t,"client="+(_?"h5":"pc"),"token="+F,"proxy="+k].join("&");if(window.goldlog&&window.goldlog.record&&"function"==typeof window.goldlog.record)window.goldlog.record(this.api,"EXP",n,this.chksum);else{var o="__CT_image_"+O++,r=window[o]=new Image;r.onload=r.onerror=function(){window[o]=null},r.src=T+this.api+"?"+n}}}},new h({"name":"ctk","sender":e,"api":"/codetrack.1.1","chksum":"H46836965"}),new h({"name":"bat","sender":e,"api":"/codetrack.1.1","chksum":"H46836965"}),new h({"name":"spy","sender":function(e,t,n){t=t||"",n=n||!1,e&&(n?this.pushFull([e,t,+new Date-j]):this.push([e,t,+new Date-j]))},"api":"/codetrack.1.2","chksum":"H46836987"}),new h({"name":"tes","sender":function(e,t,n){t=t||[],n=n||!1,e&&(n?this.pushFull([].concat([e]).concat(t)):this.push([].concat([e]).concat(t)))},"api":"/codetrack.1.3","chksum":"H46836988"}),new h({"name":"dom","sender":function(e,t,n,o,i){t=t||"",n=n||"",o=o||"",i=i||!1;var r=[e+"_"+t+"_"+n+"_"+o,e,t,n,o];i?this.pushFull(r):this.push(r)},"api":"/codetrack.1.4","chksum":"H46836989"}),window.addEventListener?window.addEventListener("error",m,!1):window.attachEvent("error",m),window.batTrack("bat","")}(),function(e,t){"function"==typeof define&&define.amd?define("mui/bat/index",[],function(){return e.bat=t()}):"object"==typeof module&&module.exports?module.exports=t():e.bat=t()}(window,function(){return{"domTrack":window.domTrack,"ctkTrack":window.ctkTrack,"batTrack":window.batTrack,"tesTrack":window.tesTrack,"spyTrack":window.spyTrack}});/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 4 22:17
*/
KISSY.add("node/base",["dom","event/dom"],function(b,e){function c(f,m,g){if(!(this instanceof c))return new c(f,m,g);if(f)if("string"===typeof f){if(f=h.create(f,m,g),f.nodeType===k.DOCUMENT_FRAGMENT_NODE)return d.apply(this,a(f.childNodes)),this}else{if(b.isArray(f)||j(f))return d.apply(this,a(f)),this}else return this;this[0]=f;this.length=1;return this}var h=e("dom"),i=e("event/dom"),g=Array.prototype,l=g.slice,k=h.NodeType,d=g.push,a=b.makeArray,j=h.isDomNodeList;c.prototype={constructor:c,isNodeList:!0,
length:0,item:function(f){return"number"===typeof f?f>=this.length?null:new c(this[f]):new c(f)},add:function(f,a,b){"number"===typeof a&&(b=a,a=void 0);f=c.all(f,a).getDOMNodes();a=new c(this);void 0===b?d.apply(a,f):(b=[b,0],b.push.apply(b,f),g.splice.apply(a,b));return a},slice:function(){return new c(l.apply(this,arguments))},getDOMNodes:function(){return l.call(this)},each:function(a,d){var k=this;b.each(k,function(b,j){b=new c(b);return a.call(d||b,b,j,k)});return k},getDOMNode:function(){return this[0]},
end:function(){return this.__parent||this},filter:function(a){return new c(h.filter(this,a))},all:function(a){a=0<this.length?c.all(a,this):new c;a.__parent=this;return a},one:function(a){a=this.all(a);if(a=a.length?a.slice(0,1):null)a.__parent=this;return a}};b.mix(c,{all:function(a,d){return"string"===typeof a&&(a=b.trim(a))&&3<=a.length&&b.startsWith(a,"<")&&b.endsWith(a,">")?(d&&(d.getDOMNode&&(d=d[0]),d=d.ownerDocument||d),new c(a,void 0,d)):new c(h.query(a,d))},one:function(a,d){var b=c.all(a,
d);return b.length?b.slice(0,1):null}});c.NodeType=k;c.KeyCode=i.KeyCode;c.Gesture=i.Gesture;c.REPLACE_HISTORY=i.REPLACE_HISTORY;return c});
KISSY.add("node/attach",["dom","event/dom","./base"],function(b,e){function c(d,a,b){b.unshift(a);d=h[d].apply(h,b);return void 0===d?a:d}var h=e("dom"),i=e("event/dom"),g=e("./base"),l=g.prototype,k=b.makeArray;g.KeyCode=i.KeyCode;b.each("nodeName,isCustomDomain,getEmptyIframeSrc,equals,contains,index,scrollTop,scrollLeft,height,width,innerHeight,innerWidth,outerHeight,outerWidth,addStyleSheet,appendTo,prependTo,insertBefore,before,after,insertAfter,test,hasClass,addClass,removeClass,replaceClass,toggleClass,removeAttr,hasAttr,hasProp,scrollIntoView,remove,empty,removeData,hasData,unselectable,wrap,wrapAll,replaceWith,wrapInner,unwrap".split(","),function(d){l[d]=
function(){var a=k(arguments);return c(d,this,a)}});b.each("getWindow,getDocument,filter,first,last,parent,closest,next,prev,clone,siblings,contents,children".split(","),function(d){l[d]=function(){var a=k(arguments);a.unshift(this);a=h[d].apply(h,a);return a===void 0?this:a===null?null:new g(a)}});b.each({attr:1,text:0,css:1,style:1,val:0,prop:1,offset:0,html:0,outerHTML:0,outerHtml:0,data:1},function(d,a){l[a]=function(){var j;j=k(arguments);void 0===j[d]&&!b.isObject(j[0])?(j.unshift(this),j=h[a].apply(h,
j)):j=c(a,this,j);return j}});b.each(["on","detach","delegate","undelegate"],function(d){l[d]=function(){var a=k(arguments);a.unshift(this);i[d].apply(i,a);return this}});b.each(["fire","fireHandler"],function(d){l[d]=function(){var a=k(arguments);a.unshift(this);return i[d].apply(i,a)}})});
KISSY.add("node/override",["dom","./base","./attach"],function(b,e){var c=e("dom"),h=e("./base");e("./attach");var i=h.prototype;b.each(["append","prepend","before","after"],function(b){i[b]=function(e){"string"===typeof e&&(e=c.create(e));if(e)c[b](e,this);return this}});b.each(["wrap","wrapAll","replaceWith","wrapInner"],function(b){var c=i[b];i[b]=function(b){"string"===typeof b&&(b=h.all(b,this[0].ownerDocument));return c.call(this,b)}})});
KISSY.add("node/anim",["./base","dom","anim"],function(b,e){function c(b,d,a){for(var c=[],f={},a=a||0;a<d;a++)c.push.apply(c,l[a]);for(a=0;a<c.length;a++)f[c[a]]=b;return f}var h=e("./base"),i=e("dom"),g=e("anim"),l=[["height","margin-top","margin-bottom","padding-top","padding-bottom"],["width","margin-left","margin-right","padding-left","padding-right"],["opacity"]];b.augment(h,{animate:function(){var c=b.makeArray(arguments);b.each(this,function(d){var a=b.clone(c),e=a[0];e.to?(e.node=d,(new g(e)).run()):
g.apply(void 0,[d].concat(a)).run()});return this},stop:function(c,d,a){b.each(this,function(b){g.stop(b,c,d,a)});return this},pause:function(c,d){b.each(this,function(a){g.pause(a,d)});return this},resume:function(c,d){b.each(this,function(a){g.resume(a,d)});return this},isRunning:function(){for(var b=0;b<this.length;b++)if(g.isRunning(this[b]))return!0;return!1},isPaused:function(){for(var b=0;b<this.length;b++)if(g.isPaused(this[b]))return!0;return!1}});b.each({show:c("show",3),hide:c("hide",3),
toggle:c("toggle",3),fadeIn:c("show",3,2),fadeOut:c("hide",3,2),fadeToggle:c("toggle",3,2),slideDown:c("show",1),slideUp:c("hide",1),slideToggle:c("toggle",1)},function(c,d){h.prototype[d]=function(a,e,f){if(i[d]&&!a)i[d](this);else b.each(this,function(b){(new g(b,c,a,f,e)).run()});return this}})});
KISSY.add("node",["node/base","node/attach","node/override","node/anim"],function(b,e){var c=e("node/base");e("node/attach");e("node/override");e("node/anim");b.mix(b,{Node:c,NodeList:c,one:c.one,all:c.all});return c});
/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 4 22:04
*/
KISSY.add("anim",["anim/base","anim/timer","anim/transition?"],function(b,g){function a(a,e,d,f,c){if(a.node)c=a;else{"string"===typeof e?(e=b.unparam(""+e,";",":"),b.each(e,function(c,a){var d=b.trim(a);d&&(e[d]=b.trim(c));(!d||d!==a)&&delete e[a]})):e=b.clone(e);if(b.isPlainObject(d))c=b.clone(d);else if(c={complete:c},d&&(c.duration=d),f)c.easing=f;c.node=a;c.to=e}c=b.merge(k,c,{useTransition:b.config("anim/useTransition")});if(c.useTransition&&h)return"use transition anim",new h(c);"use js timer anim";
return new i(c)}var j=g("anim/base"),i=g("anim/timer"),h=g("anim/transition?"),f=j.Utils,k={duration:1,easing:"linear"};b.each(["pause","resume"],function(b){a[b]=function(a,d){return null===d||"string"===typeof d||!1===d?f.pauseOrResumeQueue(a,d,b):f.pauseOrResumeQueue(a,void 0,b)}});a.isRunning=f.isElRunning;a.isPaused=f.isElPaused;a.stop=f.stopEl;a.Easing=i.Easing;b.Anim=a;a.Q=j.Q;return a});
/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 23 18:52
*/
KISSY.add("anim/base/queue",["dom"],function(c,i){function h(a,b,c){var b=b||f,j,m=d.data(a,g);!m&&!c&&d.data(a,g,m={});m&&(j=m[b],!j&&!c&&(j=m[b]=[]));return j}var d=i("dom"),g=c.guid("ks-queue-"+c.now()+"-"),f=c.guid("ks-queue-"+c.now()+"-"),a;return a={queueCollectionKey:g,queue:function(a,c,d){a=h(a,c);a.push(d);return a},remove:function(e,b,d){var j=h(e,b,1);j&&(d=c.indexOf(d,j),-1<d&&j.splice(d,1));j&&!j.length&&a.clearQueue(e,b);return j},clearQueues:function(a){d.removeData(a,g)},clearQueue:function(a,
b){var b=b||f,l=d.data(a,g);l&&delete l[b];c.isEmptyObject(l)&&d.removeData(a,g)},dequeue:function(c,b){var d=h(c,b,1);d&&(d.shift(),d.length||a.clearQueue(c,b));return d}}});
KISSY.add("anim/base/utils",["./queue","dom"],function(c,i){var h=i("./queue"),d=i("dom"),g=c.guid("ks-anim-unqueued-"+c.now()+"-"),f=c.guid("ks-anim-paused-"+c.now()+"-");return{saveRunningAnim:function(a){var e=a.node,b=d.data(e,g);b||d.data(e,g,b={});b[c.stamp(a)]=a},removeRunningAnim:function(a){var e=a.node,b=d.data(e,g);b&&(delete b[c.stamp(a)],c.isEmptyObject(b)&&d.removeData(e,g))},isAnimPaused:function(a){var e=d.data(a.node,f);return e?!!e[c.stamp(a)]:0},removePausedAnim:function(a){var e=
a.node,b=d.data(e,f);b&&(delete b[c.stamp(a)],c.isEmptyObject(b)&&d.removeData(e,f))},savePausedAnim:function(a){var e=a.node,b=d.data(e,f);b||d.data(e,f,b={});b[c.stamp(a)]=a},isAnimRunning:function(a){var e=d.data(a.node,g);return e?!!e[c.stamp(a)]:0},isElPaused:function(a){return(a=d.data(a,f))&&!c.isEmptyObject(a)},isElRunning:function(a){return(a=d.data(a,g))&&!c.isEmptyObject(a)},pauseOrResumeQueue:function(a,e,b){a=d.data(a,"resume"===b?f:g);a=c.merge(a);c.each(a,function(a){if(void 0===e||
a.config.queue===e)a[b]()})},stopEl:function(a,e,b,f){b&&(void 0===f?h.clearQueues(a):!1!==f&&h.clearQueue(a,f));a=d.data(a,g);a=c.merge(a);c.each(a,function(a){(void 0===f||a.config.queue===f)&&a.stop(e)})}}});
KISSY.add("anim/base",["dom","./base/utils","./base/queue","promise"],function(c,i){function h(j){h.superclass.constructor.call(this);a.Defer(this);this.config=j;var b=j.node;c.isPlainObject(b)||(b=d.get(j.node));this.node=this.el=b;this._backupProps={};this._propsData={}}var d=i("dom"),g=i("./base/utils"),f=i("./base/queue"),a=i("promise"),e=d.NodeType,b=c.noop,l={toggle:1,hide:1,show:1};c.extend(h,a,{on:function(a,c){"please use promise api of anim instead";"complete"===a?this.then(c):"end"===a?
this.fin(c):"step"===a?this.progress(c):"not supported event for anim: "+a;return this},prepareFx:b,runInternal:function(){var a=this,b=a.config,f=a.node,h,i=a._backupProps,o=a._propsData,k=b.to,r=b.delay||0,p=b.duration;g.saveRunningAnim(a);c.each(k,function(a,d){c.isPlainObject(a)||(a={value:a});o[d]=c.mix({delay:r,easing:b.easing,frame:b.frame,duration:p},a)});if(f.nodeType===e.ELEMENT_NODE){if(k.width||k.height)k=f.style,c.mix(i,{overflow:k.overflow,"overflow-x":k.overflowX,"overflow-y":k.overflowY}),
k.overflow="hidden","inline"===d.css(f,"display")&&"none"===d.css(f,"float")&&(10>c.UA.ieMode?k.zoom=1:k.display="inline-block");var q,n;n="none"===d.css(f,"display");c.each(o,function(c,b){h=c.value;if(l[h]){if("hide"===h&&n||"show"===h&&!n)return a.stop(!0),q=!1;i[b]=d.style(f,b);"toggle"===h&&(h=n?"show":"hide");"hide"===h?(c.value=0,i.display="none"):(c.value=d.css(f,b),d.css(f,b,0),d.show(f))}});if(!1===q)return}a.startTime=c.now();c.isEmptyObject(o)?(a.__totalTime=1E3*p,a.__waitTimeout=setTimeout(function(){a.stop(!0)},
a.__totalTime)):(a.prepareFx(),a.doStart())},isRunning:function(){return g.isAnimRunning(this)},isPaused:function(){return g.isAnimPaused(this)},pause:function(){this.isRunning()&&(this._runTime=c.now()-this.startTime,this.__totalTime-=this._runTime,g.removeRunningAnim(this),g.savePausedAnim(this),this.__waitTimeout?clearTimeout(this.__waitTimeout):this.doStop());return this},doStop:b,doStart:b,resume:function(){var a=this;a.isPaused()&&(a.startTime=c.now()-a._runTime,g.removePausedAnim(a),g.saveRunningAnim(a),
a.__waitTimeout?a.__waitTimeout=setTimeout(function(){a.stop(!0)},a.__totalTime):(a.beforeResume(),a.doStart()));return a},beforeResume:b,run:function(){var a;a=this.config.queue;!1===a?this.runInternal():(a=f.queue(this.node,a,this),1===a.length&&this.runInternal());return this},stop:function(a){var b=this.node,e=this.config.queue;if(this.isResolved()||this.isRejected())return this;this.__waitTimeout&&(clearTimeout(this.__waitTimeout),this.__waitTimeout=0);if(!this.isRunning()&&!this.isPaused())return!1!==
e&&f.remove(b,e,this),this;this.doStop(a);g.removeRunningAnim(this);g.removePausedAnim(this);var h=this.defer;if(a){var i,a=this.config.complete;c.isEmptyObject(i=this._backupProps)||d.css(this.node,i);a&&a.call(this);h.resolve([this])}else h.reject([this]);!1!==e&&(b=f.dequeue(b,e))&&b[0]&&b[0].runInternal();return this}});h.Utils=g;h.Q=f;return h});
/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 4 22:04
*/
KISSY.add("anim/timer/easing",[],function(){function j(a){return a}function g(a,b,n,e){var d=3*a-3*n+1,c=3*n-6*a,i=3*a,l=3*b-3*e+1,f=3*e-6*b,j=3*b;return function(a){a:{for(var b=a,n,e,k=0;8>k;k++){e=((d*b+c)*b+i)*b-a;if(m(e)<o){a=b;break a}n=(3*d*b+2*c)*b+i;if(m(n)<o)break;b-=e/n}n=1;k=0;for(b=a;n>k;){e=((d*b+c)*b+i)*b-a;if(m(e)<o)break;0<e?n=b:k=b;b=(n+k)/2}a=b}return((l*a+f)*a+j)*a}}var h=Math.PI,i=Math.pow,b=Math.sin,c=parseFloat,l=/^cubic-bezier\(([^,]+),([^,]+),([^,]+),([^,]+)\)$/i,f={swing:function(a){return-Math.cos(a*
h)/2+0.5},easeNone:j,linear:j,easeIn:function(a){return a*a},ease:g(0.25,0.1,0.25,1),"ease-in":g(0.42,0,1,1),"ease-out":g(0,0,0.58,1),"ease-in-out":g(0.42,0,0.58,1),"ease-out-in":g(0,0.42,1,0.58),toFn:function(a){var b;return(b=a.match(l))?g(c(b[1]),c(b[2]),c(b[3]),c(b[4])):f[a]||j},easeOut:function(a){return(2-a)*a},easeBoth:function(a){return 1>(a*=2)?0.5*a*a:0.5*(1- --a*(a-2))},easeInStrong:function(a){return a*a*a*a},easeOutStrong:function(a){return 1- --a*a*a*a},easeBothStrong:function(a){return 1>
(a*=2)?0.5*a*a*a*a:0.5*(2-(a-=2)*a*a*a)},elasticIn:function(a){return 0===a||1===a?a:-(i(2,10*(a-=1))*b(2*(a-0.075)*h/0.3))},elasticOut:function(a){return 0===a||1===a?a:i(2,-10*a)*b(2*(a-0.075)*h/0.3)+1},elasticBoth:function(a){return 0===a||2===(a*=2)?a:1>a?-0.5*i(2,10*(a-=1))*b(2*(a-0.1125)*h/0.45):0.5*i(2,-10*(a-=1))*b(2*(a-0.1125)*h/0.45)+1},backIn:function(a){1===a&&(a-=0.001);return a*a*(2.70158*a-1.70158)},backOut:function(a){return(a-=1)*a*(2.70158*a+1.70158)+1},backBoth:function(a){var b,
n=(b=2.5949095)+1;return 1>(a*=2)?0.5*a*a*(n*a-b):0.5*((a-=2)*a*(n*a+b)+2)},bounceIn:function(a){return 1-f.bounceOut(1-a)},bounceOut:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},bounceBoth:function(a){return 0.5>a?0.5*f.bounceIn(2*a):0.5*f.bounceOut(2*a-1)+0.5}},o=1.0E-6,m=Math.abs;return f});
KISSY.add("anim/timer/manager",[],function(j){var g=j.stamp,h,i;h=function(b){return setTimeout(b,15)};i=function(b){clearTimeout(b)};return{runnings:{},timer:null,start:function(b){var c=g(b);this.runnings[c]||(this.runnings[c]=b,this.startTimer())},stop:function(b){this.notRun(b)},notRun:function(b){delete this.runnings[g(b)];j.isEmptyObject(this.runnings)&&this.stopTimer()},pause:function(b){this.notRun(b)},resume:function(b){this.start(b)},startTimer:function(){var b=this;b.timer||(b.timer=h(function l(){b.runFrames()?
b.stopTimer():b.timer=h(l)}))},stopTimer:function(){var b=this.timer;b&&(i(b),this.timer=0)},runFrames:function(){var b,c,i=this.runnings;for(b in i)i[b].frame();for(b in i){c=0;break}return void 0===c}}});
KISSY.add("anim/timer/fx",["dom"],function(j,g){function h(b){j.mix(this,b);this.pos=0;this.unit=this.unit||""}var i=g("dom");h.prototype={isCustomFx:0,constructor:h,load:function(b){j.mix(this,b);this.pos=0;this.unit=this.unit||""},frame:function(b){if(1!==this.pos){var c=this.anim,h=this.prop,f=c.node,g=this.from,m=this.propData,a=this.to;if(void 0===b)var k=j.now(),b=m.duration,k=k-c.startTime-m.delay,b=0>=k?0:k>=b?1:m.easing(k/b);this.pos=b;g===a||0===b||(this.val=b=this.interpolate(g,a,this.pos),
m.frame?m.frame.call(this,c,this):this.isCustomFx||(void 0===b?(this.pos=1,b=a,h+" update directly ! : "+b+" : "+g+" : "+a):b+=this.unit,this.val=b,"attr"===this.type?i.attr(f,h,b,1):i.css(f,h,b)))}},interpolate:function(b,c,i){if("number"===typeof b&&"number"===typeof c)return Math.round(1E5*(b+(c-b)*i))/1E5},cur:function(){var b=this.prop,c,h,f=this.anim.node;if(this.isCustomFx)return f[b]||0;if(!(c=this.type))c=this.type=(!f.style||null==f.style[b])&&null!=i.attr(f,b,void 0,1)?"attr":"css";b="attr"===
c?i.attr(f,b,void 0,1):i.css(f,b);return isNaN(h=parseFloat(b))?!b||"auto"===b?0:b:h}};h.Factories={};h.FxTypes={};h.getFx=function(b){var c=h,i,f;if(i=b.fxType)c=h.FxTypes[i];else if(!b.isCustomFx&&(f=h.Factories[b.prop]))c=f;return new c(b)};return h});
KISSY.add("anim/timer/short-hand",[],function(){return{background:[],border:["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth"],borderBottom:["borderBottomWidth"],borderLeft:["borderLeftWidth"],borderTop:["borderTopWidth"],borderRight:["borderRightWidth"],font:["fontSize","fontWeight"],margin:["marginBottom","marginLeft","marginRight","marginTop"],padding:["paddingBottom","paddingLeft","paddingRight","paddingTop"]}});
KISSY.add("anim/timer/color",["./fx","./short-hand"],function(j,g){function h(b){var b=b+"",e;if(e=b.match(m))return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])];if(e=b.match(a))return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3]),parseInt(e[4])];if(e=b.match(k)){for(b=1;b<e.length;b++)2>e[b].length&&(e[b]+=e[b]);return[parseInt(e[1],l),parseInt(e[2],l),parseInt(e[3],l)]}if(o[b=b.toLowerCase()])return o[b];"only allow rgb or hex color string : "+b;return[255,255,255]}function i(){i.superclass.constructor.apply(this,
arguments)}var b=g("./fx"),c=g("./short-hand"),l=16,f=Math.floor,o={black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255]},m=/^rgb\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)$/i,a=/^rgba\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+),\s*([0-9]+)\)$/i,k=/^#?([0-9A-F]{1,2})([0-9A-F]{1,2})([0-9A-F]{1,2})$/i;
c.background.push("backgroundColor");c.borderColor=["borderBottomColor","borderLeftColor","borderRightColor","borderTopColor"];c.border.push("borderBottomColor","borderLeftColor","borderRightColor","borderTopColor");c.borderBottom.push("borderBottomColor");c.borderLeft.push("borderLeftColor");c.borderRight.push("borderRightColor");c.borderTop.push("borderTopColor");j.extend(i,b,{load:function(){i.superclass.load.apply(this,arguments);this.from&&(this.from=h(this.from));this.to&&(this.to=h(this.to))},
interpolate:function(a,b,d){var k=i.superclass.interpolate;if(3===a.length&&3===b.length)return"rgb("+[f(k(a[0],b[0],d)),f(k(a[1],b[1],d)),f(k(a[2],b[2],d))].join(", ")+")";if(4===a.length||4===b.length)return"rgba("+[f(k(a[0],b[0],d)),f(k(a[1],b[1],d)),f(k(a[2],b[2],d)),f(k(a[3]||1,b[3]||1,d))].join(", ")+")";"unknown value : "+a}});j.each("backgroundColor,borderBottomColor,borderLeftColor,borderRightColor,borderTopColor,color,outlineColor".split(","),function(a){b.Factories[a]=i});return b.FxTypes.color=
i});
KISSY.add("anim/timer/transform",["dom","./fx"],function(j,g){function h(a){a=a.split(/,/);return a=j.map(a,function(a){return b(a)})}function i(){return{translateX:0,translateY:0,rotate:0,skewX:0,skewY:0,scaleX:1,scaleY:1}}function b(a){return Math.round(1E5*parseFloat(a))/1E5}function c(a){for(var a=a.split(")"),k=j.trim,n=-1,e=a.length-1,d,c,f=i();++n<e;)switch(d=a[n].split("("),c=k(d[0]),d=d[1],c){case "translateX":case "translateY":case "scaleX":case "scaleY":f[c]=b(d);break;case "rotate":case "skewX":case "skewY":var g=b(d);
j.endsWith(d,"deg")||(g=180*g/Math.PI);f[c]=g;break;case "translate":case "translate3d":d=d.split(",");f.translateX=b(d[0]);f.translateY=b(d[1]||0);break;case "scale":d=d.split(",");f.scaleX=b(d[0]);f.scaleY=b(d[1]||d[0]);break;case "matrix":return a=d,a=h(a),e=n=k=void 0,c=a[0],f=a[1],d=a[2],g=a[3],c*g-f*d?(k=Math.sqrt(c*c+f*f),e=(c*d+f*g)/(c*g-d*f),n=(c*g-f*d)/k,c*g<f*d&&(e=-e,k=-k)):k=n=e=0,{translateX:b(a[4]),translateY:b(a[5]),rotate:b(180*Math.atan2(f,c)/Math.PI),skewX:b(180*Math.atan(e)/Math.PI),
skewY:0,scaleX:b(k),scaleY:b(n)}}return f}function l(){l.superclass.constructor.apply(this,arguments)}var f=g("dom"),o=g("./fx"),m=j.Features.isTransform3dSupported()?"translate3d({translateX}px,{translateY}px,0)":"translate({translateX}px,{translateY}px)";j.extend(l,o,{load:function(){l.superclass.load.apply(this,arguments);this.from=(this.from=f.style(this.anim.node,"transform")||this.from)&&"none"!==this.from?c(this.from):i();this.to=this.to?c(this.to):i()},interpolate:function(a,b,c){var e=l.superclass.interpolate,
d={};d.translateX=e(a.translateX,b.translateX,c);d.translateY=e(a.translateY,b.translateY,c);d.rotate=e(a.rotate,b.rotate,c);d.skewX=e(a.skewX,b.skewX,c);d.skewY=e(a.skewY,b.skewY,c);d.scaleX=e(a.scaleX,b.scaleX,c);d.scaleY=e(a.scaleY,b.scaleY,c);return j.substitute(m+" rotate({rotate}deg) skewX({skewX}deg) skewY({skewY}deg) scale({scaleX},{scaleY})",d)}});return o.Factories.transform=l});
KISSY.add("anim/timer","dom,./base,./timer/easing,./timer/manager,./timer/fx,./timer/short-hand,./timer/color,./timer/transform".split(","),function(j,g){function h(){var a;h.superclass.constructor.apply(this,arguments);j.each(a=this.to,function(b,c){var d=m(c);if(c!==d){a[d]=a[c];delete a[c]}})}var i=g("dom"),b=g("./base"),c=g("./timer/easing"),l=g("./timer/manager"),f=g("./timer/fx"),o=g("./timer/short-hand");g("./timer/color");g("./timer/transform");var m=i._camelCase,a=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i;
j.extend(h,b,{prepareFx:function(){var b=this.node,g=this._propsData;j.each(g,function(a){a.duration=a.duration*1E3;a.delay=a.delay*1E3;if(typeof a.easing==="string")a.easing=c.toFn(a.easing)});j.each(o,function(a,c){var d,e=g[c],f;if(e){f=e.value;d={};j.each(a,function(a){d[a]=i.css(b,a)});i.css(b,c,f);j.each(d,function(a,c){c in g||(g[c]=j.merge(e,{value:i.css(b,c)}));i.css(b,c,a)});delete g[c]}});var e,d,h,l,m,p,r,u=0,q;j.isPlainObject(b)&&(u=1);for(e in g){d=g[e];h=d.value;p={isCustomFx:u,prop:e,
anim:this,fxType:d.fxType,type:d.type,propData:d};r=f.getFx(p);l=h;m=r.cur();h=h+"";q="";if(h=h.match(a)){l=parseFloat(h[2]);if((q=h[3])&&q!=="px"&&m){var s=0,t=l;do{++t;i.css(b,e,t+q);s=r.cur()}while(s===0);m=t/s*m;i.css(b,e,m+q)}h[1]&&(l=(h[1]==="-="?-1:1)*l+m)}p.from=m;p.to=l;p.unit=q;r.load(p);d.fx=r}},frame:function(){var a,b=1,c,d=this._propsData;for(a in d){c=d[a];c=c.fx;c.frame();if(this.isRejected()||this.isResolved())return;b=b&c.pos===1}d=j.now();a=this.config.duration*1E3;d=Math.max(0,
this.startTime+a-d);this.defer.notify([this,1-(d/a||0),d]);b&&this.stop(b)},doStop:function(a){var b,c=this._propsData;l.stop(this);if(a)for(b in c){a=c[b];(a=a.fx)&&a.frame(1)}},doStart:function(){l.start(this)}});h.Easing=c;h.Fx=f;return h});
/*
Copyright 2014, KISSY v1.42
MIT Licensed
build time: Feb 25 18:29
*/
KISSY.add("anim/transition",["dom","event/dom","./base"],function(g,h){function p(c){var b="";g.each(c,function(c,a){b&&(b+=",");b+=a+" "+c.duration+"s "+c.easing+" "+c.delay+"s"});return b}function k(){k.superclass.constructor.apply(this,arguments)}var i=h("dom"),m=h("event/dom"),q=h("./base"),l=g.Features,n=l.getVendorCssPropPrefix("transition"),r=/([A-Z]|^ms)/g,o=n?n.toLowerCase()+"TransitionEnd":"transitionend webkitTransitionEnd",j=l.getVendorCssPropName("transition");g.extend(k,q,{doStart:function(){var c=
this,b=c.node,d=b.style,a=c._propsData,f=d[j],e,h={};if(e=a.transform)delete a.transform,a[l.getVendorCssPropName("transform").replace(r,"-$1").toLowerCase()]=e;g.each(a,function(a,d){var e=a.value,f=i.css(b,d);"number"===typeof e&&(f=parseFloat(f));f===e&&setTimeout(function(){c._onTransitionEnd({originalEvent:{propertyName:d}})},0);h[d]=e});-1!==f.indexOf("none")?f="":f&&(f+=",");d[j]=f+p(a);m.on(b,o,c._onTransitionEnd,c);i.css(b,h)},beforeResume:function(){var c=this._propsData,b=g.merge(c),d=
this._runTime/1E3;g.each(b,function(a,b){var e=d;a.delay>=e?a.delay-=e:(e-=a.delay,a.delay=0,a.duration>=e?a.duration-=e:delete c[b])})},_onTransitionEnd:function(c){var c=c.originalEvent,b=1,d=this._propsData;d[c.propertyName]&&1!==d[c.propertyName].pos&&(d[c.propertyName].pos=1,g.each(d,function(a){if(1!==a.pos)return b=0,!1}),b&&this.stop(!0))},doStop:function(c){var b=this.node,d=b.style,a=this._propsData,f=[],e={};m.detach(b,o,this._onTransitionEnd,this);g.each(a,function(a,d){c||(e[d]=i.css(b,
d));f.push(d)});a=g.trim(d[j].replace(RegExp("(^|,)\\s*(?:"+f.join("|")+")\\s+[^,]+","gi"),"$1")).replace(/^,|,,|,$/g,"")||"none";d[j]=a;i.css(b,e)}});return k});
KISSY.add("kg/xtemplate/3.3.3/runtime",[],function(n,t,r,e){var i,a,o,s,f;i=function(n){function t(){var n="";for(var t in e)n+=t+"|";return n=n.slice(0,-1),a=new RegExp(n,"g")}var r,e={"&":"&amp;",">":"&gt;","<":"&lt;","`":"&#x60;","/":"&#x2F;",'"':"&quot;","'":"&#x27;"},i=/[&<>"'`]/,a=t(),o=/\\?\{([^{}]+)\}/g,s="undefined"!=typeof global?global:window,f=Object.prototype.toString;return n=r={isArray:Array.isArray||function(n){return"[object Array]"===f.call(n)},keys:Object.keys||function(n){var t,r=[];for(t in n)n.hasOwnProperty(t)&&r.push(t);return r},each:function(n,t,e){if(n){var i,a,o,s=0,f=n&&n.length,u=void 0===f||"[object Function]"===Object.prototype.toString.call(n);if(e=e||null,u)for(o=r.keys(n);s<o.length&&(i=o[s],t.call(e,n[i],i,n)!==!1);s++);else for(a=n[0];f>s&&t.call(e,a,s,n)!==!1;a=n[++s]);}return n},mix:function(n,t){for(var r in t)n[r]=t[r];return n},globalEval:function(n){s.execScript?s.execScript(n):!function(n){s.eval.call(s,n)}(n)},substitute:function(n,t,r){return"string"==typeof n&&t?n.replace(r||o,function(n,r){return"\\"===n.charAt(0)?n.slice(1):void 0===t[r]?"":t[r]}):n},escapeHtml:function(n){return n=""+n,i.test(n)?(n+"").replace(a,function(n){return e[n]}):n},merge:function(){for(var n=0,t=arguments.length,e={};t>n;n++){var i=arguments[n];i&&r.mix(e,i)}return e}}}(),a=function(n){function t(n,t,r){this.data=void 0!==n?n:{},r?(this.parent=r,this.root=r.root):(this.parent=void 0,this.root=this),this.affix=t||{},this.ready=!1}return t.prototype={isScope:1,constructor:t,setParent:function(n){this.parent=n,this.root=n.root},set:function(n,t){this.affix[n]=t},setData:function(n){this.data=n},getData:function(){return this.data},mix:function(n){var t=this.affix;for(var r in n)t[r]=n[r]},get:function(n){var t,r=this.data,e=this.affix;return null!=r&&(t=r[n]),void 0!==t?t:e[n]},resolveInternalOuter:function(n){var t,r=n[0],e=this,i=e;if("this"===r)t=e.data;else if("root"===r)i=i.root,t=i.data;else{if(!r)return[i.data];do t=i.get(r);while(void 0===t&&(i=i.parent))}return[void 0,t]},resolveInternal:function(n){var t=this.resolveInternalOuter(n);if(1===t.length)return t[0];var r,e=n.length,i=t[1];for(r=1;e>r;r++)i=i[n[r]];return i},resolveLooseInternal:function(n){var t=this.resolveInternalOuter(n);if(1===t.length)return t[0];var r,e=n.length,i=t[1];for(r=1;null!=i&&e>r;r++)i=i[n[r]];return i},resolveUp:function(n){return this.parent&&this.parent.resolveInternal(n)},resolveLooseUp:function(n){return this.parent&&this.parent.resolveLooseInternal(n)},resolveOuter:function(n,t){var r,e=this,i=e;if(!t&&1===n.length){if(r=e.get(n[0]),void 0!==r)return[r];t=1}if(t)for(;i&&t--;)i=i.parent;return i?[void 0,i]:[void 0]},resolveLoose:function(n,t){var r=this.resolveOuter(n,t);return 1===r.length?r[0]:r[1].resolveLooseInternal(n)},resolve:function(n,t){var r=this.resolveOuter(n,t);return 1===r.length?r[0]:r[1].resolveInternal(n)}},n=t}(),o=function(n){function t(n,t,r){this.list=n,this.init(),this.next=t,this.ready=!1,this.tpl=r}function r(n,r){var e=this;e.config=r,e.head=new t(e,void 0),e.callback=n,this.init()}var e=i;return t.prototype={constructor:t,isBuffer:1,init:function(){this.data=""},append:function(n){return this.data+=n,this},write:function(n){if(null!=n){if(n.isBuffer)return n;this.data+=n}return this},writeEscaped:function(n){if(null!=n){if(n.isBuffer)return n;this.data+=e.escapeHtml(n)}return this},insert:function(){var n=this,r=n.list,e=n.tpl,i=new t(r,n.next,e),a=new t(r,i,e);return n.next=a,n.ready=!0,a},async:function(n){var t=this.insert(),r=t.next;return n(t),r},error:function(n){var t=this.list.callback;if(t){var r=this.tpl;if(r){n instanceof Error||(n=new Error(n));var e=r.name,i=r.pos.line,a="At "+e+":"+i+": ";n.stack=a+n.stack,n.message=a+n.message,n.xtpl={pos:{line:i},name:e}}this.list.callback=null,t(n,void 0)}},end:function(){var n=this;return n.list.callback&&(n.ready=!0,n.list.flush()),n}},r.prototype={constructor:r,init:function(){this.data=""},append:function(n){this.data+=n},end:function(){this.callback(null,this.data),this.callback=null},flush:function(){for(var n=this,t=n.head;t;){if(!t.ready)return n.head=t,void 0;this.data+=t.data,t=t.next}n.end()}},r.Buffer=t,n=r}(),s=function(n){var t=a,r=i,e={range:function(n,t){var r=t.params,e=r[0],i=r[1],a=r[2];a?(e>i&&a>0||i>e&&0>a)&&(a=-a):a=e>i?-1:1;for(var o=[],s=e;i>e?i>s:s>i;s+=a)o.push(s);return o},foreach:function(n,r,e){var i,a,o,s,f=r.params,u=f[0],c=f[2]||"xindex",l=f[1];if(u)for(i=u.length,s=0;i>s;s++)a=new t(u[s],{xcount:i,xindex:s},n),o=a.affix,"xindex"!==c&&(o[c]=s,o.xindex=void 0),l&&(o[l]=u[s]),e=r.fn(a,e);return e},forin:function(n,r,e){var i,a,o,s=r.params,f=s[0],u=s[2]||"xindex",c=s[1];if(f)for(o in f)i=new t(f[o],{xindex:o},n),a=i.affix,"xindex"!==u&&(a[u]=o,a.xindex=void 0),c&&(a[c]=f[o]),e=r.fn(i,e);return e},each:function(n,t,i){var a=t.params,o=a[0];return o?r.isArray(o)?e.foreach(n,t,i):e.forin(n,t,i):i},"with":function(n,r,e){var i=r.params,a=i[0];if(a){var o=new t(a,void 0,n);e=r.fn(o,e)}return e},"if":function(n,t,r){var e=t.params,i=e[0];if(i){var a=t.fn;a&&(r=a(n,r))}else{var o=!1,s=t.elseIfs,f=t.inverse;if(s)for(var u=0,c=s.length;c>u;u++){var l=s[u];if(o=l.test(n)){r=l.fn(n,r);break}}!o&&f&&(r=f(n,r))}return r},set:function(n,t,r){return n.mix(t.hash),r},include:1,parse:1,extend:1,block:function(n,t,r){var e,i=this,a=i.runtime,o=t.params,s=o[0];2===o.length&&(e=o[0],s=o[1]);var f,u=a.blocks=a.blocks||{},c=u[s],l={fn:t.fn,type:e};if(c){if(c.type)if("append"===c.type)l.next=c,u[s]=l;else if("prepend"===c.type){var h;for(f=c;f&&"prepend"===f.type;)h=f,f=f.next;l.next=f,h.next=l}}else u[s]=l;if(!a.extendTplName)for(f=u[s];f;)f.fn&&(r=f.fn.call(i,n,r)),f=f.next;return r},macro:function(n,r,e){var i=r.hash,a=r.params,o=a[0],s=a.slice(1),f=this,u=f.runtime,c=u.macros=u.macros||{};if(r.fn)c[o]={paramNames:s,hash:i,fn:r.fn};else{var l,h=c[o],v=h.hash||{};if(h&&(l=h.paramNames)){for(var d=0,p=l.length;p>d;d++){var m=l[d];v[m]=s[d]}if(i)for(var g in i)v[g]=i[g];var x=new t(v);e=h.fn.call(f,x,e)}else{var y="can not find macro: "+name;e.error(y)}}return e}};return e["debugger"]=function(){},n=e}(),f=function(n){function t(n,t,r,e,i,a,o){this.name=n,this.originalName=a||n,this.runtime=t,this.root=r,this.pos={line:1},this.scope=e,this.buffer=i,this.fn=o}function r(n,t,r){var e=r[0],i=n&&n[e]||t&&t[e]||g[e];if(1===r.length)return i;if(i)for(var a=r.length,o=1;a>o;o++)if(i=i[r[o]],!i)return!1;return i}function e(n,t){var r=n.split("/"),e=t.split("/");r.pop();for(var i=0,a=e.length;a>i;i++){var o=e[i];"."===o||(".."===o?r.pop():r.push(o))}return r.join("/")}function f(n,t,e,i,a,o){var s,f,u;return o||(u=r(n.runtime.commands,n.root.config.commands,a)),u?u.call(n,t,e,i):u!==!1&&(s=t.resolve(a.slice(0,-1),o),f=s[a[a.length-1]])?f.apply(s,e.params):(i.error("Command Not Found: "+a.join(".")),i)}function u(n,t){var r=this;r.fn=n,r.config=p.merge(u.globalConfig,t),this.subNameResolveCache={}}function c(n,t,r){if("."!==t.charAt(0))return t;var i=r+"_ks_"+t,a=n.subNameResolveCache,o=a[i];return o?o:t=a[i]=e(r,t)}function l(n,t,r,e,i,a){var o=c(n,a,i.name),s=e.insert(),f=s.next;return v(n,o,i.runtime,t,s,a,r),f}function h(n,r,e,i,a){var o=e.insert(),s=o.next,f=new t(a.TPL_NAME,i.runtime,n,r,o,void 0,a);return o.tpl=f,d(f),s}function v(n,r,e,i,a,o,s){var f=new t(r,e,n,i,a,o);a.tpl=f,n.config.loader.load(f,function(n,t){"function"==typeof t?(f.fn=t,d(f)):n?a.error(n):t&&(s?a.writeEscaped(t):a.data+=t,a.end())})}function d(n){var t=n.fn();if(t){var r=n.runtime,e=r.extendTplName,i=r.extendTplFn;return i?(r.extendTplName=null,r.extendTplFn=null,t=h(n.root,n.scope,t,n,i)):e&&(r.extendTplName=null,t=l(n.root,n.scope,0,t,n,e)),t.end()}}var p=i,m=s,g={},x=a,y=o,b={callFn:f,callCommand:function(n,t,r,e,i){return f(n,t,r,e,i)}};return p.mix(u,{config:function(n,t){var r=this.globalConfig=this.globalConfig||{};return arguments.length?(void 0!==t?r[n]=t:p.mix(r,n),void 0):r},version:"3.3.3",nativeCommands:m,utils:b,util:p,addCommand:function(n,t){g[n]=t},removeCommand:function(n){delete g[n]}}),u.prototype={constructor:u,Scope:x,nativeCommands:m,utils:b,removeCommand:function(n){var t=this.config;t.commands&&delete t.commands[n]},addCommand:function(n,t){var r=this.config;r.commands=r.commands||{},r.commands[n]=t},include:function(n,t,r,e){var i,a=t.params;i=n;var o=t.hash,s=t&&t.escape;return o&&(i=new x(o,void 0,n)),r=l(this,i,s,r,e,a[0])},includeModule:function(n,t,r,e){var i,a=t.params;i=n;var o=t.hash;return o&&(i=new x(o,void 0,n)),r=h(this,i,r,e,a[0])},render:function(n,r,e){var i="",a=this,o=a.fn,s=a.config;"function"==typeof r&&(e=r,r=null),r=r||{},e=e||function(n,t){if(n)throw n instanceof Error||(n=new Error(n)),n;i=t};var f=a.config.name;!f&&o&&o.TPL_NAME&&(f=o.TPL_NAME);var c=new x(n),l=new u.LinkedBuffer(e,s).head,h=new t(f,{commands:r.commands},a,c,l,f,o);return l.tpl=h,o?(d(h),i):(s.loader.load(h,function(n,t){t?(h.fn=a.fn=t,d(h)):n&&l.error(n)}),i)}},u.Scope=x,u.LinkedBuffer=y,n=u}(),e.exports=f});KISSY.add("detail-model/product",function(e,t,n){function o(e,t){var n=e.promText?2:e.limitTime&&!1===e.start?1:0,o=t.promText?2:t.limitTime&&!1===t.start?1:0;return n!=o?n-o:e.price-t.price}function i(e){var t,n,o,i=[];return function(a,r){return 0===r||r||(r=1),1&r&&!n&&(n=!0,e(function(e){for(t=e;o=i.shift();)o&&o.apply(null,[t])})),t!==undefined?(a&&a.apply(null,[t]),t):(2&r||a&&i.push(a),t)}}function a(){function t(t){var n=t.FEstepCur,o=t.wrtLevelFinalPrices.length,i=o-n-1,a=0;o>3&&(2==t.status?i>0?(a=0===n?0:n-1,t.FEstepCur=n-a):(a=o-3,t.FEstepCur=2):a=0,t.wrtLevelFinalPrices=t.wrtLevelFinalPrices.slice(a,a+3),t.wrtLevelNeedCounts=t.wrtLevelNeedCounts.slice(a,a+3));var r=t.wrtLevelNeedCounts;t.FEstepCur=0;for(var u=o-1;u>=0;u--)if(r[u]<=t.groupUC){t.FEstepCur=u;break}2!=t.status&&(t.FEstepCur=-1);var c=[],d=0,l=parseInt(t.groupUC||0),s=t.wrtLevelFinalPrices,m=t.wrtLevelNeedCounts;e.each(s,function(e,t){var n=m[t];c[t]=[(e/100).toFixed(2),n],l>=n&&t<=s.length-1&&(d=t)});var f=t.giftsList,p=[];f&&f.length&&f.forEach(function(e){var t=e.split(",");p.push({"from":t[0],"to":t[1],"contents":t[2]})}),t.level=d,t.priceCountArr=c,t.giftList=p;var v=t.price,g=t.wrtLevelFinalPrices.length?t.wrtLevelFinalPrices[t.level]-v:t.finalPayment,y=0;return y=2===t.type?t.finalPayment:g+v,t.prePayFee=(v/100).toFixed(2),t.preSellPrice=(y/100).toFixed(2),t}a.superclass.constructor.apply(this,arguments);var i=this;codeTrack("model.product.init","app.init"),i.addAttr("deviceType",{"value":"pc"}),i.addAttr("noSkipMode",{"value":!1}),i.addAttr("3rdExtraInfo",{"value":null}),i.addAttr("thirdPartyInventory",{"value":null}),i.addAttr("etParams",{"value":null}),i.addAttr("fasePushConfig",{"load":function(e){try{e(_DATA_FAST_PUSH_ESI)}catch(t){e(null)}}}),i.addAttr("token",{"load":function(e){i.onLoad("config",function(t){if(t&&t.token)return void e(t.token);i.onToken(e)})}}),i.addAttr("bucketId",{"load":function(e){var t=i.getState("bucket_id");if(t)return void e(parseInt(t,10));i.onLoad("config",function(t){e(parseInt(t.bucketId||0,10))})}}),i.addAttr("qrcodeUrl",{"load":function(e){i.onLoad(["itemDO"],function(t){if(!t)return void e(null);e("//"+(l?"10.125.199.21":"gqrcode.alicdn.com")+"/img?v=1&type=bi&item_id="+t.itemId)})}}),i.addAttr("amount",{"validator":function(e){return!isNaN(e=parseInt(e,10))&&e>0},"setter":function(e){return parseInt(e,10)},"load":function(e){e(1),i.onLoad("config",function(t){e(t&&t.detail&&t.detail.quantityList&&t.detail.quantityList[0])})}}),i.addAttr("amountMultiple",{"load":function(e){e(1),i.onLoad(["config","itemDO"],function(t,n){t&&t.timesBuy>1?e(t.timesBuy):n&&n.timesBuy>1&&e(n.timesBuy)})}}),i.addAttr("originalPrice",{"load":function(e){i.onChange(["currentPriceInfoList","selectedSkuList","config"],function(t,n,o){var i,a={},r=!0;if(t)for(var u in t)(i=t[u]&&t[u].price)!==undefined&&(a.min=Number(i)>Number(a.min)?a.min:i,a.max=Number(i)<Number(a.max)?a.max:i,r=!1);if(r&&n)for(var u in n)(i=n[u]&&n[u].price)!==undefined&&(a.min=Number(i)>Number(a.min)?a.min:i,a.max=Number(i)<Number(a.max)?a.max:i,r=!1);r&&o&&(i=o.itemDO.reservePrice||o.detail.defaultItemPrice)!==undefined&&(a.min=a.max=i,r=!1),r?a=null:(a.str=a.min,a.min!=a.max&&(a.str+="-"+a.max)),e(a)})}}),i.addAttr("buyPrice",{"load":function(e){i.onChange(["currentPriceInfoList","originalPrice","currentCycle","3rdExtraInfo","currentWrtInfo","model","deviceType","carSoldFenqi","config"],function(t,n,o,a,r,u,c,d,l){var s=a&&a.price;if(s)return e({"max":s,"min":s,"str":s});var m,f=0,p=!1,v={},g=!0;if(o){var m=(o.bPrice/100).toFixed(2);return void e({"max":m,"min":m,"str":m})}if(l&&l.detail&&l.detail.isZhengChe&&d&&d.msrpLong){var m=(d.msrpLong/100).toFixed(2);return void e({"max":m,"min":m,"str":m})}if(r){var y=r.priceRange;if(y){var h=(y.minTotal/100).toFixed(2),k=(y.maxTotal/100).toFixed(2);e({"min":h,"max":k,"str":h+"-"+k})}else e({"min":r.preSellPrice,"max":r.preSellPrice,"str":r.preSellPrice})}else{var b=u?u.jhsDO:{},I=u&&u.newJhsDO||{},S=i.get("selectedSku");if("phone"==c&&I&&I.rangePriceView&&I.activityPriceMap)if(S&&S.skuId&&I.activityPriceMap[S.skuId])e({"min":I.activityPriceMap[S.skuId],"max":I.activityPriceMap[S.skuId],"str":I.activityPriceMap[S.skuId]+""});else{var h=I.activityPriceMap[0],k=I.activityPriceMap[0];for(var P in I.activityPriceMap)h=h>I.activityPriceMap[P]?I.activityPriceMap[P]:h,k=k<I.activityPriceMap[P]?I.activityPriceMap[P]:k;e({"min":h,"max":k,"str":I.activityPrice})}else{if("phone"==c&&b&&b.activityPrice){var x=b.activityPrice;return void e({"min":x,"max":x,"str":x})}var C=function(){f>0||!p||(g?v=n:(v.str=v.min,v.min!=v.max&&(v.str+="-"+v.max)),e(v))};for(var P in t)f++,i.onPriceInfo(t[P],function(e){i.onPromotionList(e,function(t){var n=t&&t[0];!n||n.promText||n.limitTime&&!1===n.start||(m=n.price)===undefined?(m=e.price)!==undefined&&(v.min=Number(m)>Number(v.min)?v.min:m,v.max=Number(m)<Number(v.max)?v.max:m):(v.min=Number(m)>Number(v.min)?v.min:m,v.max=Number(m)<Number(v.max)?v.max:m,g=!1),f--,C()})});p=!0,C()}}})}}),i.addAttr("promoPrice",{"load":function(e){i.onChange(["currentPriceInfoList","originalPrice"],function(t,n){var o,a=0,r=!1,u={},c=!0,d=function(){a>0||!r||(c?u=n:(u.str=u.min,u.min!=u.max&&(u.str+="-"+u.max)),e(u))};for(var l in t)a++,i.onPriceInfo(t[l],function(e){i.onPromotionList(e,function(t){var n=t&&t[0];n&&!n.promText&&(o=n.price)!==undefined?(u.min=Number(o)>Number(u.min)?u.min:o,u.max=Number(o)<Number(u.max)?u.max:o,c=!1):(o=e.price)!==undefined&&(u.min=Number(o)>Number(u.min)?u.min:o,u.max=Number(o)<Number(u.max)?u.max:o),a--,d()})});r=!0,d()})}}),i.addAttr("tagPrice",{"load":function(e){i.onChange(["currentPriceInfoList","selectedSkuList"],function(t,n){var o,i={},a=!0;if(t)for(var r in t)(o=t[r]&&t[r].tagPrice)!==undefined&&null!==o&&(i.min=Number(o)>Number(i.min)?i.min:o,i.max=Number(o)<Number(i.max)?i.max:o,a=!1);if(a&&n)for(var r=0,u=n.length;r<u;r++)(o=n[r]&&n[r].tagPrice)!==undefined&&null!==o&&(i.min=Number(o)>Number(i.min)?i.min:o,i.max=Number(o)<Number(i.max)?i.max:o,a=!1);a?i=null:(i.str=i.min,i.min!=i.max&&(i.str+="-"+i.max)),e(i)})}}),i.addAttr("interTagPrice",{"load":function(e){i.onChange(["currentPriceInfoList"],function(t){var n,o={},i=!0;if(t)for(var a in t)(n=t[a]&&t[a].interTagPrice)!==undefined&&null!==n&&(o.min=Number(n)>Number(o.min)?o.min:n,o.max=Number(n)<Number(o.max)?o.max:n,i=!1);i?o=null:(o.str=o.min,o.min!=o.max&&(o.str+="-"+o.max)),e(o)})}}),i.addAttr("interOrignPrice",{"load":function(e){i.onChange(["currentPriceInfoList"],function(t){var n,o={},i=!0;if(t)for(var a in t)(n=t[a]&&t[a].interOrignPrice&&t[a].interOrignPrice.value)!==undefined&&null!==n&&(o.min=Number(n)>Number(o.min)?o.min:n,o.max=Number(n)<Number(o.max)?o.max:n,i=!1);i?o=null:(o.str=o.min,o.min!=o.max&&(o.str+="-"+o.max)),e(o)})}}),i.addAttr("interPrice",{"load":function(e){i.onLoad("priceInfo",function(t){var n={"min":0,"max":0,"str":"0"},o={"min":0,"max":0,"str":"0"},i={"min":0,"max":0,"str":"0"},a=0;for(prop in t)if(t.hasOwnProperty(prop)){var r=t[prop];if(r){a||(n=r.interOrignPrice,o={"min":r.interTagPrice,"max":r.interTagPrice},i={"min":r.price,"max":r.price});var u=parseFloat(t[prop].interTagPrice);o.min>u&&(o.min=t[prop].interTagPrice),o.max<u&&(o.max=t[prop].interTagPrice);var c=parseFloat(t[prop].price);i.min>c&&(i.min=t[prop].price),i.max<c&&(i.max=t[prop].price),a++}}o.str=o.min==o.max?o.min:o.min+"-"+o.max,i.str=i.min==i.max?i.min:i.min+"-"+i.max,e({"interOrignPrice":n,"interTagPrice":o,"interPrice":i})})}}),i.addAttr("servicePrice",{"load":function(t){i.onChange(["selectedService","currentService","service","3rdExtraInfo"],function(n,o,i,a){var r=a&&a.servicePrice;if(r)return t({"max":r,"min":r,"str":r});i=o||i;var u=0;n&&i&&e.each(i.list,function(t){var o=n[t.id];o&&(t.uniqueServices&&t.uniqueServices.length?e.each(t.uniqueServices,function(e){e.uniqueId==o&&(u+=1*e.price)}):o===t.uniqueId&&(u+=parseFloat(t.price)))}),t({"min":u.toFixed(2),"max":u.toFixed(2)})})}}),i.addAttr("totalPrice",{"load":function(e){i.onChange(["buyPrice","servicePrice","amount"],function(t,n,o){e({"min":(1*t.min+1*n.min)*o,"max":(1*t.max+1*n.max)*o})})}}),i.addAttr("progressiveInfo",{"load":function(t){codeTrack("mod.progressive.load","model.product.init"),i.onLoad(["model","userInfo"],function(n,o){var i=n.progressiveInfoDO;if(!i)return codeTrack("mod.progressive.null","mod.progressive.load"),void t(null);var a={"extInfos":{"bizType":o&&o.userId?i.tipType:0,"installFee":{}},"show":i.showProgressivePlan,"enable":i.progressiveEnable,"tryBeforeBuy":i.tryBeforeBuy,"double11Privilege":i.double11Privilege,"newPCInstallment":i.newPCInstallment,"text":i.text};a.tryBeforeBuy||(e.each(i.rateMap,function(e,t){a.extInfos.installFee[t+"p"]={"rate":e}}),e.each(i.period,function(e,t){"object"==typeof e&&(a.extInfos.installFee[e.count+"p"]={"rate":e.ratio,"count":e.count,"coupon":e.coupon,"couponPrice":e.couponPrice})})),codeTrack("mod.progressive.success","mod.progressive.load"),t(a)})}}),i.addAttr("currentWrtInfo",{"load":function(n){i.onChange(["selectedSku","currentPriceInfo","priceInfo","itemPrice"],function(o,i,a,r){if(!i)return n(null);if(i=e.clone(i),o){if(i&&i.wrtInfo){i.wrtInfo.priceRange=null;var u=i.wrtInfo,c=u.FEstepCur<0?0:u.FEstepCur;return u.FEstepCur=c,u=t(u),n(u)}return n(null)}var u=i.wrtInfo;if(!u){if(!r)return n(null);u=r.wanrentuanInfo}if(u){var c=u.FEstepCur<0?0:u.FEstepCur;u.FEstepCur=c,u=t(u),u.depositExpandTextBySku=null;var d={"minPre":null,"maxPre":null,"minTotal":null,"maxTotal":null,"minTail":null,"maxTail":null,"minBigMarkdownPrice":null,"maxBigMarkdownPrice":null};for(var l in a){var s=a[l],m=s.wrtInfo;if(m){m=t(m);var c=m.FEstepCur<0?0:m.FEstepCur;s.FEstepCur=c;var f,p=m.bigMarkdownPrice,v=m.price,g=m.wrtLevelFinalPrices.length?m.wrtLevelFinalPrices[c]-v:m.finalPayment;f=2===m.type?m.finalPayment:g+v,(!d.minTotal||f<d.minTotal)&&(d.minTotal=f),(!d.minPre||v<d.minPre)&&(d.minPre=v),(!d.minTail||g<d.minTail)&&(d.minTail=g),(!d.minBigMarkdownPrice||p<d.minBigMarkdownPrice)&&(d.minBigMarkdownPrice=p),(!d.maxTotal||f>d.maxTotal)&&(d.maxTotal=f),(!d.maxPre||v>d.maxPre)&&(d.maxPre=v),(!d.maxTail||g>d.maxTail)&&(d.maxTail=g),(!d.maxBigMarkdownPrice||p>d.maxBigMarkdownPrice)&&(d.maxBigMarkdownPrice=p)}}d.minTotal!=d.maxTotal||d.minPre!=d.maxPre?u.priceRange=d:u.priceRange=null,u.priceRange&&(d.minTotal!=d.maxTotal&&(u.preSellPrice=(d.minTotal/100).toFixed(2)+"-"+(d.maxTotal/100).toFixed(2)),d.minPre!=d.maxPre&&(u.prePayFee=(d.minPre/100).toFixed(2)+"-"+(d.maxPre/100).toFixed(2))),n(u)}else n(null)})}}),i.addAttr("progressiveType",{"load":function(e){e(1==i.getState("fenqi")?"3p":"")}}),i.addAttr("currentProgressive",{"load":function(e){i.onChange(["progressiveInfo","itemDO","totalPrice","progressiveType"],function(t,n,o,a){i.onProgressive(a,function(t){e(t&&t.enabled?t:null)})})}}),i.addAttr("xshmPay",{"load":function(e){e(0)}}),i.addAttr("isOfflineShop",{"load":function(e){e(window.g_config&&1==window.g_config.offlineShop)}}),i.addAttr("tradeResult",{"load":function(e){e(null)}}),i.addAttr("config",{}),i.addAttr("mdskip",{}),i.addAttr("model",{"load":function(t){var n;i.onLoad(["config","deviceType"],function(o,a){i.onChange("mdskip",function(r){r=r||{};var u;if(r.isSuccess)u=r.defaultModel,u.tradeResult&&(e.isUndefined(u.tradeResult.tradeType)||null==u.tradeResult.tradeType)&&(u.tradeResult.tradeType=o.tradeType),e.log("TMLOG::detailMode:"+(n="skipError"==n?"skipOkAfterError":"skipOk"),"info");else{if(u={"itemPriceResultDO":{"priceInfo":{},"areaId":330100,"promType":i.getState("key")?1:0},"userInfoDO":{},"miscDO":{"city":"\u676d\u5dde","cityId":"330100","region":"\u4e0a\u57ce\u533a","regionId":"330102"},"gatewayDO":{},"deliveryDO":{"deliverySkuMap":{}}},"phone"===a)e.mix(u,r.defaultModel,!0);else{var c=o.renderTime||+new Date,d=o&&o.detail&&o.detail.double11StartTime||14787936e5;!c||c<d?e.mix(u,{"tradeResult":o.noSkipMode.tradeResult},!0):e.mix(u,o.noSkipMode,!0)}i.set("noSkipMode",!0),e.log("TMLOG::detailMode:"+(n="skipError"),"info")}var l=u.tradeResult;l&&(o.tradeType=l.tradeType),t(u)})})}}),i.addAttr("tmallCarFinantialEnable",{"load":function(e){i.onChange(["mdskip"],function(t){var n=t.defaultModel;n?(n.tradeResult=n.tradeResult||{},e&&e(n.tradeResult.tmallCarFinantialEnable)):e(null)})}}),i.addAttr("priceInfo",{"load":function(e){i.onChange(["itemPrice"],function(t){e&&e(t?t.priceInfo||null:null)})}}),i.addAttr("buyerLoc",{"load":function(e){i.onLoad(["model","config"],function(t,n){e(n&&n.detail&&n.detail.isMenDianInventroy&&t&&t.deliveryDO?t&&(t.deliveryDO.areaId||t.serviceInfoDO&&t.serviceInfoDO.divisionId||t.itemPriceResultDO&&t.itemPriceResultDO.areaId||t.miscDO&&t.miscDO.cityId)||"330100":t&&(t.serviceInfoDO&&t.serviceInfoDO.divisionId||t.itemPriceResultDO&&t.itemPriceResultDO.areaId||t.miscDO&&t.miscDO.cityId)||"330100")})}}),i.addAttr("locModel",{"load":function(t){i.onChange(["buyerLoc","deviceType"],function(n,o){i.onLoad(["config","gateway","model"],function(o,a,r){return o&&o.detail&&o.detail.isMenDianInventroy&&r&&r.deliveryDO&&r.deliveryDO.areaId==n?void t({}):r.serviceInfoDO&&r.serviceInfoDO.divisionId==n||r.itemPriceResultDO&&r.itemPriceResultDO.areaId==n||r.miscDO&&r.miscDO.cityId==n?void t({}):void i.canSoldArea(n,function(r){function u(n){e.use("ajax",function(e,o){codeTrack("data.locationUrl.start","model.product.init"),o.jsonp(n,c,function(e){_sufei&&_sufei.check?_sufei.check(e,function(e,o){e?(console.log("\u6b63\u5e38\u8bf7\u6c42"),o&&o.isSuccess?(codeTrack("data.locationUrl.success","data.locationUrl.start"),t&&t(o&&o.defaultModel)):codeTrack("data.locationUrl.error","data.locationUrl.start")):(console.log("\u975e\u6b63\u5e38\u8bf7\u6c42"),o._sufeiToken&&u(n))}):e&&e.isSuccess?(codeTrack("data.locationUrl.success","data.locationUrl.start"),t&&t(e&&e.defaultModel)):codeTrack("data.locationUrl.error","data.locationUrl.start")})})}if(r){var c=i.getState(["campaignId","abt","key"]);e.mix(c,a&&a.changeLocationGateway),-1==o.changeLocationApi.indexOf("tmallBuySupport")&&(c.tmallBuySupport=2==o.tradeType||7==o.tradeType?"true":"false"),c.ref=encodeURIComponent(document.referrer),c.areaId=n,window._sufei||(window._sufei=window.sufei),u(o.changeLocationApi)}})})})}}),i.addAttr("soldArea",{"load":function(e){i.onChange("model",function(t){var n=t?t.soldAreaDataDO:null;e(n&&!1!==n.success?n:null)})}}),i.addAttr("amountRestrict",{"load":function(e){i.onChange(["model","config"],function(t,n){e(t&&t.buyerRestrictInfoDO&&t.buyerRestrictInfoDO.amountRestrictInfoMap||null)})}}),i.addAttr("sellCount",{"load":function(t){e.use("dom",function(e,n){var o,a=n.get(".tm-count",".tm-ind-sellCount"),r=!0;a&&(o=a.innerHTML)&&!/^[0\s]*$/.test(o)&&(t({"sellCount":parseInt(o,10)}),r=!1),i.onChange("model",function(e){var n=e&&e.sellCountDO;((n=n&&!1!==n.success?n:null)||r)&&(t(n),r=!1)})})}}),i.addAttr("trade",{"load":function(e){i.onChange(["model","config","cycle","misc","locModel"],function(t,n,o,i,a){var r=a&&a.tradeResult!==undefined&&a.tradeResult||t&&t.tradeResult||n&&n.noSkipMode&&n.noSkipMode.tradeResult;r&&t&&t.miscDO&&t.miscDO.sellCountDown&&(r.sellCountDown||(r.sellCountDown=t.miscDO.sellCountDown),delete t.miscDO.sellCountDown),o&&r&&!r.sellCountDown&&parseInt(o.startTime,10)>parseInt(i.systemTime,10)&&(r.sellCountDown=Math.floor((o.startTime-i.systemTime)/1e3)),e(r&&!1!==r.success?r:null)})}}),i.addAttr("userInfo",{"load":function(e){i.onChange("model",function(t){var n=t&&t.userInfoDO;e(n&&!1!==n.success?n:null)})}}),i.addAttr("isLogin",{"load":function(e){i.onChange("userInfo",function(t){e(t&&t.userId!==undefined?t.userId>0?!0:!1:null)})}}),i.addAttr("campaignInfo",{"load":function(e){i.onChange("model",function(t){var n=t&&t.campaignInfo;e(n&&!1!==n.success?n:null)})}}),i.addAttr("jz",{"load":function(e){i.onChange("model",function(t){var n=t&&t.jzDO;n&&(n.style=t.style),e(n&&!1!==n.success?n:null)})}}),i.addAttr("firstSell",{"load":function(e){i.onChange("model",function(t){e(t.vmarket&&t.vmarket.firstSellDO?t.vmarket&&t.vmarket.firstSellDO:null)})}}),i.addAttr("secKill",{"load":function(e){i.onChange("model",function(t){var n=t&&t.secKillDO;e(n&&!1!==n.success?n:null)})}}),i.addAttr("misc",{"load":function(e){i.onLoad("cycle",function(t){i.onChange(["model"],function(t){var n=t&&t.miscDO;e(n&&!1!==n.success?n:null)})})}}),i.addAttr("relatedAuctions",{"load":function(e){i.onChange("model",function(t){var n=t&&t.relatedAuctionsDO;e(n&&!1!==n.success?n:null)})}}),i.addAttr("detailPageTips",{"load":function(e){i.onChange(["model","config"],function(t,n){var o=t&&t.detailPageTipsDO||n&&n.detailPageTipsDO;e(o&&!1!==o.success?o:null)})}}),i.addAttr("gateway",{"load":function(e){i.onChange(["model","deviceType"],function(t,n){if("phone"===n)return e({"trade":{"addToBuyNow":{},"addToCart":{}},"changeLocationGateway":t&&t.gatewayDO&&t.gatewayDO.changeLocationGateway});var o=t&&t.gatewayDO;e(o&&!1!==o.success?o:null)})}}),i.addAttr("buyState",{"load":function(e){i.onLoad(["deviceType"],function(t){e("phone"==t?null:null)})}}),i.addAttr("itemPrice",{"load":function(e){i.onChange(["locModel","model","config"],function(t,n,o){var i=t&&t.itemPriceResultDO!==undefined&&t.itemPriceResultDO||n&&n.itemPriceResultDO||o&&o.itemPriceResultDO;e(i&&!1!==i.success?i:null)})}}),i.addAttr("delivery",{"load":function(e){i.onChange(["locModel","model","deviceType"],function(t,n,o){var i=t&&t.deliveryDO!==undefined&&t.deliveryDO||n&&(n.deliverDO||n.deliveryDO);e(i&&!1!==i.success?i:null)})}}),i.addAttr("inventory",{"load":function(e){i.onChange(["locModel","model"],function(t,n){var o=t&&t.inventoryDO!==undefined&&t.inventoryDO||n&&n.inventoryDO;e(o&&!1!==o.success?o:null)})}}),i.addAttr("servicePromise",{"load":function(e){i.onChange(["locModel","model"],function(t,n){var o=t&&t.servicePromise!==undefined&&t.servicePromise||n&&n.servicePromise;e(o&&!1!==o.success?o:null)})}}),i.addAttr("globalSellInfo",{"load":function(e){i.onChange(["locModel","model"],function(t,n){var o=t&&t.globalSellInfo!==undefined&&t.globalSellInfo||n&&n.globalSellInfo;e(o&&!1!==o.success?o:null)})}}),i.addAttr("serviceInfo",{"load":function(t){i.onChange(["locModel","model"],function(n,o){if(!n&&!o)return t(null);n&&!e.isEmptyObject(n)||(n=o);var a=n.serviceInfoDO;if(a){var r=a.servicePriceMap,u=a.serviceItemMap;r&&e.each(r,function(t,n){e.each(t,function(n,o){var i=String(n.id),a=u[i];if(a){var r=[];a.uniqueServices&&a.uniqueServices.length&&e.each(a.uniqueServices,function(t){n.uniqueServices&&n.uniqueServices.length&&e.each(n.uniqueServices,function(n,o){n.uniqueId===t.uniqueId&&r.push(e.merge(n,t))})}),n=e.merge(n,a),n.uniqueServices=r}t[o]=n}),r.skuId=t})}a&&a.success?(i.set("cacheSelectedService",null),t(a)):t(null)})}}),i.addAttr("skuServiceMap",{"load":function(e){i.onChange(["serviceInfo"],function(t){var n=t?t.servicePriceMap||t.skuServiceMap||null:null;e(n)})}}),i.addAttr("boundsSKU",{"load":function(e){var t={"minPrice":null,"minSkuId":null,"max":null,"maxSkuId":null};i.onChange(["priceInfo"],function(n){for(var i in n){var a,r=n[i],u=r.promotionList;u&&(u=u.sort(o),a=u[0]);var c=100*(a?a.price:r.price);(!t.minPrice||c<t.minPrice)&&(t.minPrice=c,t.minSkuId=i),(!t.maxPrice||c>t.maxPrice)&&(t.maxPrice=c,t.maxSkuId=i)}e(t)})}}),i.addAttr("currentService",{"load":function(t){i.onChange(["serviceInfo","skuServiceMap","selectedSku","boundsSKU"],function(n,o,i,a){if(n){var r=e.clone(n);if(!o)return t(null);if(i)var u=i.skuId;else var u=a.minSkuId;var c=o[u];c&&c.length?(e.each(c,function(e){e.uniqueServices&&e.uniqueServices.length||(e.uniqueId="0")}),r.stype=r.serviceType,r.list=c,t(r)):t(null)}else t(null)})}}),i.addAttr("couponData",{"load":function(e){i.onChange(["mdskip"],function(t){e(t&&t.defaultModel?t.defaultModel.couponDataDo?t.defaultModel.couponDataDo:null:null)})}}),i.addAttr("service",{"load":function(t){i.onChange(["locModel","model","selectedSku"],function(n,o,i){var a,r=n&&n.serviceDO!==undefined?n.serviceDO:o&&o.serviceDO,u={"stype":null,"list":[]},c=i&&i.skuId||0;if(r&&r.success&&(u.stype=r.serviceType,a=r.servicePriceMap[c]))for(var d=0,l=a.length;d<l;d++){var s=e.mix({},a[d],undefined,undefined,!0),m=e.mix({},r.serviceItemMap[s.id],undefined,undefined,!0);if(m){if(m.uniqueServices&&m.uniqueServices.length){for(var f=0;f<m.uniqueServices.length;f++)m.uniqueServices[f].uniqueId in s.uniqueServices?e.mix(m.uniqueServices[f],s.uniqueServices[m.uniqueServices[f].uniqueId],!0):(m.uniqueServices.splice(f,1),f--);m.uniqueServices.length||(m.uniqueServices=null)}else s.uniqueId="0";s.uniqueServices&&delete s.uniqueServices,e.mix(s,m,undefined,undefined,!0),("3c"==u.stype&&s.free||"house"==u.stype&&s.autoSelect)&&(s.selected=!0),u.list.push(s)}}"house"==u.stype&&u.list&&1==u.list.length&&(u.list[0].selected=u.list[0].autoSelect=!0),t(u)})}}),i.addAttr("memberRight",{"load":function(e){i.onChange(["locModel","model"],function(t,n){var o=t&&t.memberRightDO!==undefined&&t.memberRightDO||n&&n.memberRightDO;e(o&&!1!==o.isSuccess?o:null)})}}),i.addAttr("memberMultiPoint",{"load":function(e){i.onChange(["memberRight","boundsSKU"],function(t,n){var o=t&&t.pricePointExt,i=n.minPrice;if(o)return e(Math.floor(i*o.pointRate/100/10));e(null)})}}),i.addAttr("breadCrumb",{"load":function(e){i.onChange("Extension",function(t){var n=t&&t.breadCrumbDO;e(n&&!1!==n.success?n:null)})}}),i.addAttr("spuMaintainer",{"load":function(e){i.onChange("Extension",function(t){var n=t&&t.spuMaintainerDO;e(n&&!1!==n.success?n:null)})}}),i.addAttr("tmallShopProm",{"load":function(t){i.onChange("itemPrice",function(n){var o=n&&n.tmallShopProm?n.tmallShopProm:null,i=function(e){if(e&&e.promPlan&&e.promPlan.length){for(var t=0;t<e.promPlan.length;t++)if(e.promPlan[t].msg&&(e.msg=e.promPlan[t].msg),e.promPlan[t].detailMsg){e.promPlan=e.promPlan[t];break}return e}if(e&&"noExpend"==e.showType)return e.msg=e.content,e.actTitle=e.bizTitle,e.isFree=!0,e.promPlan={"detailMsg":[]},e.campaignName=e.content,e.bizType=e.bizType,e.title=e.title,e},a=function(e){return!!(e&&e.promPlan&&e.promPlan.detailMsg)};if(e.isArray(o)){for(var r=new Array(0),u=0;u<o.length;u++){var c=i(o[u]);c&&r.push(c)}t(r)}else{if(!e.isPlainObject(o))return void t(null);var d=i(o);t(a(d)?[d]:null)}})}}),i.addAttr("hasGift",{"load":function(t){i.onLoad("tmallShopProm",function(n){if(!n)return void t(!1);var o=[];if(e.isArray(n))for(var i=0;i<n.length;i++)o.push(n[i].promPlan&&n[i].promPlan.detailMsg||{});else o=n.promPlan&&n.promPlan.detailMsg||[];for(var a,r=o.length;r--;)if(a=o[r],a.method&&a.method.giftPool&&a.method.giftPool.giftList&&a.method.giftPool.giftList.length>0)return void t(!0);t(!1)})}}),i.addAttr("meal",{"load":function(e){i.onChange("Extension",function(t){var n=t&&t.mealResult;e(n&&!1!==n.success?n:null)})}}),i.addAttr("dsr",{"load":function(e){i.onLoad(["shopDynamicRating","itemDO"],function(t,n){if(!t)return e(null);var o="SM_368_dsr-"+n.userId,i=t[o];if(i){var a=[{"rate":(Math.floor(10*i.m)/10).toFixed(1),"rate_title":i.m,"rate_UFB":i.m_UFB,"rate_g":i.m_g},{"rate":(Math.floor(10*i.s)/10).toFixed(1),"rate_title":i.s,"rate_UFB":i.s_UFB,"rate_g":i.s_g},{"rate":(Math.floor(10*i.c)/10).toFixed(1),"rate_title":i.c,"rate_UFB":i.c_UFB,"rate_g":i.c_g}];e(a)}else e(null)})}}),i.addAttr("isDownShelf",{"load":function(e){function t(){var t=o||a;t!==undefined&&e(t)}var o,a;i.onChange(["config"],function(e){o=e.detail.isDownShelf||!!n.get("#J_Sold-out-recommend")||n.get("#s-actionbar .buy")&&"\u5df2\u4e0b\u67b6"==n.text("#s-actionbar .buy"),t()}),i.onChange(["model"],function(e){a=!(!e.inventoryDO||0!==e.inventoryDO.totalQuantity),t()})}}),i.addAttr("Extension",{"load":function(t){i.onLoad("config",function(n){var o=n&&n.initExtensionApi;if(!o)return void t({});e.use("ajax",function(e,n){codeTrack("data.extension.start","model.product.init"),n({"url":o,"data":i.getState(["q","cat_id"]),"dataType":"jsonp","jsonpCallback":"jsonpInitExtension","cache":!0,"success":function(e){e&&e.success?(codeTrack("data.extension.success","data.extension.start"),t(e)):(codeTrack("data.extension.error","data.extension.start"),t({}))},"error":function(){codeTrack("data.extension.error","data.extension.start")}})})})}}),i.addAttr("reviewCount",{"load":function(t){i.onLoad(["config","itemDO"],function(n,o){function i(t,n){e.use("ajax",function(e,i){i({"url":t,"data":{"itemId":o.itemId,"spuId":o.spuId,"sellerId":o.userId},"dataType":"jsonp","success":function(e){var t=e&&e.dsr;t&&0===t.rateTotal&&5==t.gradeAvg&&(t=null),n(t)},"error":function(){n(null)}})})}function a(e){e?codeTrack("data.reviewCount.success","data.reviewCount.start"):codeTrack("data.reviewCount.error","data.reviewCount.start"),t(e?{"grade":e.gradeAvg,"gradeAvg":(e.gradeAvg+"").length>2?(e.gradeAvg+"").substr(0,3):e.gradeAvg+"","rateTotal":e.rateTotal}:{"grade":null,"gradeAvg":null,"rateTotal":null})}if(n&&n.detail&&!1===n.detail.allowRate)return void t({"grade":null,"rateTotal":null,"gradeAvg":null});codeTrack("data.reviewCount.start","model.product.init"),!0!==n.rateConfig.rateScoreCacheDisable&&i("//dsr-rate."+(l?"daily.tmall.net":"tmall.com")+"/list_dsr_info.htm",function(e){if(e||!1===n.rateConfig.rateScoreDisable)return void a(e);codeTrack("data.reviewCount.again","data.reviewCount.start"),i("//rate."+(l?"daily.tmall.net":"tmall.com")+"/list_dsr_info.htm",function(e){a(e)})})})}}),i.addAttr("dealChartData",{"load":function(t){i.onLoad("config",function(n){n&&n.api.recordExtUrl&&(codeTrack("mod.dealRecord.chart.start","model.product.init"),e.IO({"url":n.api.recordExtUrl,"dataType":"jsonp","jsonpCallback":"jsonpCallback","success":function(e){codeTrack("mod.dealRecord.chart.success","mod.dealRecord.chart.success"),t(e)},"error":function(){codeTrack("mod.dealRecord.chart.failure","mod.dealRecord.chart.start"),e.log("DealRecord Load Error!")}}))})}}),i.addAttr("customResource",{"load":function(e){i.onLoad("model",function(t){var n=t.customResourceDO;if(n&&n.customResources)return e(n.customResources);e(null)})}}),i.addAttr("activityDO",{"load":function(e){i.onLoad("mdskip",function(t){e(t&&t.defaultModel&&t.defaultModel.activityDO?t.defaultModel.activityDO:null)})}}),i.addAttr("cycle",{"load":function(e){i.onChange("config",function(t){if(!t)return void e(null);var n=t.cyclePurchaseDO,o=t.itemDO.reservePrice;if(o=o.replace(/\./,""),n&&n.purchaseSelected.length){n.selectedIndex=0;for(var i=0,a=n.purchaseSelected.length;i<a;i++){var r=n.purchaseSelected[i];r.totalPrice=r.deliveryTimes*parseInt(r.price,10),r.oTotalPrice=o*r.deliveryTimes,r.offPrice=r.oTotalPrice-r.totalPrice,r.bPrice=1==n.payType?r.cyclePriceStep[0]:r.totalPrice}}else n=null;e(n)})}}),i.addAttr("currentCycle",{"load":function(e){i.onChange(["amount","cycle"],function(t,n){if(n){var o=n.selectedIndex,i=n.purchaseSelected[o];e({"payType":n.payType,"selectedIndex":o,"amount":t,"price":i.totalPrice*t,"bPrice":i.bPrice*t,"itemAmount":i.deliveryTimes*t,"buy_cycle":i.cycleId,"deliveryUnit":i.deliveryUnit,"priceStep":i.cyclePriceStep,"delivery_amount":i.deliveryId})}else e(null)})}}),i.addAttr("skuMap",{"load":function(t){i.onChange(["config","inventory","thirdPartyInventory"],function(n,o,a){var r,u=n&&n.valItemInfo&&n.valItemInfo.skuMap||null;if(!u||0===(r=e.keys(u).length))return void t(u);i.onSkuFeatures(u,function(n){if(!o)return void t(n);var a={},u=0;e.each(n,function(e,n){i.onInventory(e.skuId,function(o){o&&!o.quantity&&0===o.totalQuantity||(a[n]=e,u++),0==--r&&t(a)})})})})}}),i.addAttr("skuNames",{"load":function(e){i.onLoad("config",function(t){return e(t&&t.valItemInfo&&t.valItemInfo.skuName||null)})}}),i.addAttr("propertyPics",{"load":function(e){i.onLoad("config",function(t){return e(t&&t.propertyPics||null)})}}),i.addAttr("selectedSku",{"load":function(t){i.onChange(["selectedSkuProp","selectedSkuList"],function(n,o){if(!o)return void t(null);var i=e.keys(o);if(1!=i.length)return void t(null);var a=i[0].split(";"),r=!0;e.each(a,function(e){if(e){var t=e.split(":");n[t[0]]!=t[1]&&(r=!1)}}),t(r?o[i[0]]:null)})}}),i.addAttr("selectedCspu",{"load":function(t){i.onChange(["selectedSkuList"],function(n){var o;n&&e.each(n,function(e){if(o=o||e.cspuId,e.cspuId&&o&&o!=e.cspuId)return o=null,!1}),t(o?{"cspuId":o}:null)})}}),i.addAttr("selectedSkuList",{"load":function(e){i.onChange("selectedSkuProp",function(t){i.onSkuList(t,e)})}}),i.addAttr("currentAmountRestrict",{"load":function(t){i.onLoad(["amountRestrict","config"],function(n,o){if(!o)return void t(null);var a;o.cyclePurchaseDO&&(o.cyclePurchaseDO.amountLimitUp||o.cyclePurchaseDO.amountLimitDown)&&(a={"amountLimitUp":o.cyclePurchaseDO.amountLimitUp,"amountLimitDown":o.cyclePurchaseDO.amountLimitDown}),i.onChange("selectedSku",function(o){var i=o&&o.skuId||"def",r=n&&n[i]||null;a&&(r=r&&e.mix(r,a)||a),t(r)})})}}),i.addAttr("currentPriceInfoList",{"load":function(t){i.onChange(["priceInfo","selectedSkuList","selectedSku"],function(n,i,a){var r=[];a&&n&&n[a.skuId]?r.push(n[a.skuId]):i&&n?e.each(i,function(e){n[e.skuId]&&r.push(n[e.skuId])}):e.each(n,function(e){e&&r.push(e)}),r=r.sort(function(e,t){var n=e.promotionList&&e.promotionList.length?0:1,i=t.promotionList&&t.promotionList.length?0:1;if(n!=i)return n-i;if(!n){var a=e.promotionList.sort(o),r=t.promotionList.sort(o),u=o(a[0],r[0]);return 0!==u?u:r.length-a.length}return 0}),t(r)})}}),i.addAttr("currentPriceInfo",{"load":function(e){i.onChange("currentPriceInfoList",function(t){e(t&&t[0]||null)})}}),i.addAttr("currentInventory",{"load":function(e){i.onLoad("config",function(t){t.detail.isCarService?i.onChange(["3rdExtraInfo","selectedSku","inventory"],function(n,o,a){var r=n&&n.amount;r?e({"type":a&&a.type||t&&t.valItemInfo&&t.valItemInfo.type||0,"quantity":parseInt(r,10),"totalQuantity":parseInt(r,10)}):i.onInventory(o&&o.skuId,e)}):i.onChange(["selectedSku","inventory"],function(t){i.onInventory(t&&t.skuId,e)})})}}),i.addAttr("currentPromotion",{"load":function(e){i.onChange("currentPromotionList",function(t){e(t&&t[0]||null)})}}),i.addAttr("currentPromotionList",{"load":function(e){i.onChange("currentPriceInfo",function(t){i.onPromotionList(t,e)})}}),i.addAttr("allSuggestivePromotionList",{"load":function(t){i.onChange(["priceInfo"],function(n){var i=[];e.each(n,function(e,t){e&&e.suggestivePromotionList&&(i=i.concat(e.suggestivePromotionList))}),t(i.sort(o))})}}),i.addAttr("currentSuggestivePromotionList",{"load":function(e){i.onChange(["currentPriceInfo"],function(t){if(!t)return void e(null);var n=t.suggestivePromotionList;e(n?n.sort(o):null)})}}),i.addAttr("suggestivePromotionPrice",{"load":function(e){i.onChange(["currentPriceInfoList","detailPageTips"],function(t,n){var o,i,a={},r=!0,u={};if(n&&n.showMaskedDou11SugPrice){if(t)for(var c in t)i=t[c]&&t[c].suggestivePromotionList&&t[c].suggestivePromotionList[0].price,(o=t[c]&&t[c].sortOrder)!==undefined&&null!==o&&0!==o&&i!==undefined&&null!==i&&(Number(o)>Number(u.min)?(u.min=u.min,a.min=a.min):(u.min=o,a.min=i),Number(o)<Number(u.max)?(u.max=u.max,a.max=a.max):(u.max=o,a.max=i),r=!1)}else if(t)for(var c in t)(o=t[c]&&t[c].suggestivePromotionList&&t[c].suggestivePromotionList[0].price)!==undefined&&null!==o&&(a.min=Number(o)>Number(a.min)?a.min:o,a.max=Number(o)<Number(a.max)?a.max:o,r=!1);r?a=null:n&&n.showMaskedDou11SugPrice?(a.str=a.min,u.min!=u.max&&(a.str+="-"+a.max)):(a.str=a.min,a.min!=a.max&&(a.str+="-"+a.max)),e(a)})}}),i.addAttr("currentSuggestivePromotion",{"load":function(e){i.onChange("currentSuggestivePromotionList",function(t){e(t&&t[0]||null)})}}),i.addAttr("currentDelivery",{"load":function(t){i.onChange(["delivery","service","isAreaRestricted","selectedSku"],function(n,o,i,a){var r=n&&n.deliverySkuMap,a=a||{},u=a.skuId?a.skuId:"default",c={"feeUnit":null,"money":null,"name":null,"postage":"","serviceLinkText":null,"serviceLinkUrl":null,"signText":null,"tagImage":null,"type":0},d=r&&r[u]||r&&r["default"]||[c];i?d=[e.mix({"postage":"\u6240\u9009\u533a\u57df\u6682\u4e0d\u9500\u552e\uff0c\u8bf7\u67e5\u770b\u5176\u4ed6\u533a\u57df","warning":!0},c,!1)]:o&&o.list.length&&"house"==o.stype&&(d=[e.mix({"postage":""},c,!1)]),t(d)})}}),i.addAttr("skuProp",{"load":function(t){i.onChange(["config","skuMap"],function(o,i){var a={};if(!i)return void t(a);for(var r in i)if(i.hasOwnProperty(r))for(var u=r.split(";"),c=0;c<u.length;c++)if(u[c]){var d=u[c].split(":");d[0]&&d[1]&&(a[d[0]]||(a[d[0]]={}),a[d[0]][d[1]]={"label":"","text":"","info":""})}var l=o.valItemInfo&&o.valItemInfo.salesProp||null,s=n.query(".J_TSaleProp","#detail");e.each(s,function(t){var o=n.children(t),i=n.attr(t,"data-property");e.each(o,function(e){var t=e.getAttribute("data-value");if(t){var o=t.split(":"),r=a[o[0]]&&a[o[0]][o[1]];r&&(r.label=i,r.text=n.text(n.get("span",e)),r.info=r.label+":"+r.text,l&&l[o[0]]&&l[o[0]][o[1]]&&(r.tip=l[o[0]][o[1]]))}})}),t&&t(a)})}}),i.addAttr("selectedSkuProp",{"load":function(t){function n(e){i.onLoad(["skuProp","isBundleItem"],function(n,o){if(o)t({});else{for(var i in e)e.hasOwnProperty(i)&&(n[i]&&n[i][e[i]]||delete e[i]);t(e)}})}function o(t){if(!t)return null;var n,o={},i=!1;return e.each(t.split?t.split(";"):t,function(e){e&&(n=e.split(":"))&&2==n.length&&n[0]&&n[1]&&(o[n[0]]=n[1],i=!0)}),i?o:null}function a(){var a=o(u.sku);if((r=u.sku_properties)&&(r=o(r)))return void n(a?e.mix(a,r):r);i.onLoad("config",function(i){if((r=i&&i.valItemInfo&&i.valItemInfo.defSelected)&&(r=o(r)))return void n(a?e.mix(a,r):r);a?n(a):t({})})}var r,u=e.unparam(location.href.split("?")[1]);i.onChange("isDownShelf",function(e){e&&t({})}),(r=u.skuId)?i.onLoad("skuMap",function(e){if(e)for(var t in e)if(e[t].skuId==r)return void n(o(t));a()}):a()}}),i.addAttr("internationalComponent",{"load":function(e){i.onLoad("model",function(t){e(t.internationalComponent?t.internationalComponent:null)})}}),i.addAttr("selectedCarProp",{"load":function(e){i.onLoad("config",function(t){if(t){if(!t.carCascade||!t.detail.isCarCascade)return e(null);e(i.get("selectedCarProp")||null)}else e(null)})}}),i.addAttr("skuPropSelectivity",{"load":function(t){i.onChange(["locModel"],function(n){t(e.now())})}}),i.addAttr("selectedSkuInfo",{"load":function(t){i.onChange(["skuProp","selectedSku","selectedSkuProp"],function(n,o,a){function r(o){var i={};e.each(o,function(e,t){var o=n[t]&&n[t][e]&&n[t][e].info;o&&(i[t+":"+e]=o)}),t(i)}if(o){var u=o.skuId;i.onLoad("skuMap",function(t){var n=!1;for(var o in t)if(t[o]&&t[o].skuId==u){var i={};e.each(o.split(";"),function(e){if(e&&e.indexOf(":")>=0){var t=e.split(":");i[t[0]]=t[1],r(i)}}),n=!0;break}n||r(a)})}else r(a)})}}),i.addAttr("cacheSelectedService"),i.set("cacheSelectedService",null),i.addAttr("selectedService",{"load":function(e){i.onChange(["service","currentService","cacheSelectedService"],function(t,n,o){if(!(t=n||t)||!t.list||!t.list.length)return void e(null);for(var i={},a=t.list,r=0;r<a.length;r++){var u=a[r];if(u.id=u.id||u.serviceId,u.uniqueServices&&1==u.uniqueServices.length){var c=u.uniqueServices[0];if(c.autoSelect||c.free||c.isFree)if(o){var d=o[u.id];d&&!1!==d.checked&&d.value==c.uniqueId&&(i[u.id]=c.uniqueId)}else i[u.id]=c.uniqueId;else if(o){var d=o[u.id];d&&!0===d.checked&&d.value==c.uniqueId&&(i[u.id]=c.uniqueId)}}else if(u.uniqueServices&&u.uniqueServices.length>1)for(var l=0,s=u.uniqueServices.length;l<s;l++){var c=u.uniqueServices[l];if(c.autoSelect||c.free||c.isFree)if(o){var d=o[u.id];d&&!1!==d.checked&&d.value==c.uniqueId&&(i[u.id]=c.uniqueId)}else i[u.id]=c.uniqueId;else if(o){var d=o[u.id];d&&!0===d.checked&&d.value==c.uniqueId&&(i[u.id]=c.uniqueId)}}else if(u.autoSelect||u.isFree||u.free||0===r&&"house"==t.stype)if(o){var d=o[u.id];d&&!1!==d.checked&&d.value==u.uniqueId&&(i[u.id]=u.uniqueId||"0"),d||(i[u.id]=u.uniqueId||"0")}else i[u.id]=u.uniqueId||"0";else if(o){var d=o[u.id];d&&!0===d.checked&&d.value==u.uniqueId&&(i[u.id]=u.uniqueId||"0")}}e(i)})}}),i.addAttr("desc",{"load":function(t){i.onLoad("config",function(n){if(!0!==n.tag.isAsynDesc||!n.api||!n.api.descUrl)return void t("");var o=TShop.isHttps()?n.api.httpsDescUrl:n.api.descUrl;(n.isTwView||n.isWorldView)&&(o+="&_thwlang=zh_CN:TB-GBK"),e.getScript(o,{"success":function(){t(window.desc||"")}})})}}),i.addAttr("shopDynamicRating",{"load":function(t){i.onLoad("config",function(n){if(!n||!n.apiBeans)return void t(null);e.use("ajax",function(e,o){codeTrack("data.apiBeans.start","model.product.init"),o({"url":n.apiBeans,"dataType":"jsonp","success":function(e){codeTrack("data.apiBeans.success","data.apiBeans.start"),t&&t(e)},"error":function(){codeTrack("data.apiBeans.error","data.apiBeans.start")}})})})}}),i.addAttr("skuExtra",{"load":function(e){i.onLoad("config",function(t){e(t.valItemInfo.skuExtra)})}}),i.addAttr("pickupPoints",{"load":function(e){i.onLoad(["config","deviceType"],function(t,n){"phone"===n?i.onLoad("skuExtra",function(t){var n=t.pickupPoints;e(n&&n.values&&n.values.length?n.values:null)}):e(t&&t.elecVoucherPickupPoint||null)})}}),i.addAttr("pickupStore",{"value":null}),i.addAttr("isPickupStore",{"load":function(e){i.onLoad(["config"],function(t){var n=!!(t&&t.detail&&t.detail.isDianZiMendian);e(n)})}}),i.addAttr("etm",{"value":null}),i.addAttr("pickupPoint",{"value":""}),i.addAttr("mianliaoParams",{"value":null}),i.addAttr("isAreaRestricted",{"load":function(e){i.onChange(["currentPriceInfoList","buyerLoc","deviceType"],function(t,n,o){function a(){i.canSoldArea(n,function(t){i.onLoad("buyerLoc",function(o){n==o&&e(!t)})})}if(!t||!t[0])return void a();for(var r=t.length-1;r>=0;r--)if(!1!==t[r].areaSold)return void a();e(!0)})}}),i.addAttr("itemDO",{"load":function(e){i.onLoad("config",function(t){e(t&&t.itemDO||null)})}}),i.addAttr("wtBuyParam",{"value":""}),i.addAttr("canBuyStatus",{"load":function(e){i.onChange(["trade","selectedSku","misc","currentInventory","itemPrice","isAreaRestricted","amount","amountMultiple","selectedCarProp","selectedService","pickupPoint","pickupStore","etm"],function(){var e=i.get("canBuyStatus");e?i.set("canBuyStatus",++e):i.set("canBuyStatus",1)})}}),i.addAttr("canAddToCartStatus",{"load":function(e){i.onChange(["trade","misc","currentInventory","itemPrice","isAreaRestricted","amount","pickupPoint"],function(){var e=i.get("canAddToCartStatus");e?i.set("canAddToCartStatus",++e):i.set("canAddToCartStatus",1)})}}),i.addAttr("timeminus",{"load":function(){}}),i.addAttr("mainImg",{"load":function(e){e(n.get("#J_ImgBooth").src||null)}}),i.addAttr("itemtitle",{"load":function(e){e(document.getElementsByTagName("title")[0].innerHTML.split("-tmall.")[0])}}),i.addAttr("buyFlowFrom",{"load":function(e){function t(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(t);return null!=n?unescape(n[2]):""}function n(){var e=encodeURIComponent(document.referrer);return e||""}e({"root_refer":t("root_refer"),"item_url_refer":n(),"u_channel":t("u_channel")})}}),i.addAttr("hotItemPhaseStep",{"value":""}),i.addAttr("hotItemStatus",{"load":function(e){i.onChange(["itemDO","serverStartTime","hotItemPhaseStep"],function(t,n,o){function i(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(t);return null!=n?unescape(n[2]):""}if(!t.isHotItem)return e(null);var a=2147483647,r=i("hotItemStatus");if(r)e(r-0);else{var u=t.preHotBeginDate,c=t.freshBaoBeginDate,d=t.questionBeginDate,l=t.questionEndDate;if(u<=n&&n<c){e(0);var s=Math.abs(c-n);s<a&&setTimeout(function(){e(1)},s)}else if(c<=n&&n<d){e(1);Math.abs(d-n)}else if(d<=n&&n<l){e(2);var m=Math.abs(l-n);m<a&&setTimeout(function(){e(3)},m)}else e(3)}})}}),i.addAttr("colorSp",{"load":function(t){e.ready(function(){var o=e.filter(n.query(".J_TSaleProp"),function(e){return n.hasClass(e,".tb-img")});o=o[0];var i=n.query("li",o);if(i&&i.length){var a={};i.each(function(e){a[n.attr(e,"data-value")]=n.attr(e,"title")}),t(a)}else t(null)})}}),i.addAttr("currentColorSp",{"load":function(t){e.ready(function(){i.onChange(["selectedSkuProp","colorSp"],function(o,i){var a=e.filter(n.query(".J_TSaleProp"),function(e){return n.hasClass(e,".tb-img")});a=a[0];var r=n.get(".tb-selected",a);if(r){var u=n.attr(r,"data-value");t({"value":u,"title":i[u]})}else t(null)})})}});var r=window.g_config.startTime||e.now();i.addAttr("clientStartTime",{"load":function(e){e(r)}}),i.addAttr("serverStartTime",{"load":function(e){i.onLoad("config",function(t){if(t&&t.renderTime&&parseInt(t.renderTime,10)<9999999999)return e(1e3*t.renderTime);i.onChange(["misc"],function(t){if(t&&t.systemTime)return e(t.systemTime);i.onLoad("clientStartTime",e)})})}}),i.addAttr("minicart",{"load":function(t){i.onLoad("config",function(n){n&&n.detail&&n.detail.isPurchaseMallVipBuyer?e.use("mui/caigou-base/minicart/index",function(e,n){t(n)}):n&&n.isAliTripComDomain?e.use("travel-detail/widgets/cart/",function(e,n){t(n)}):n&&n.isTripUser?e.use("mui/minicart/trip/cart",function(e,n){t(n)}):e.use("mui/minicart",function(e,n){t(n)})})}}),i.addAttr("comboLoc",{"load":function(e){i.onLoad("buyerLoc",function(t){t.toString().length>6&&(t=t.toString().substring(0,6)),e(t)})}}),i.onComboData=function(t,n,o,a){function r(){e.use("malldetail/common/util",function(e,r){var u=t+"_"+n+"_"+(a?"1":"0");i._cdlm=i._cdlm||{},i._cdlm[u]=i._cdlm[u]||(i._cdlm[u]=r.createLoader(function(o){i.onLoad("config",function(r){r.apiTmallCollocationInfo?e.use(["mui/kissy-polyfill/index","mui/mtop/index"],function(e,r,u){i.onLoad(["config","itemDO"],function(e,r){-1!==location.hostname.indexOf(".liangxinyao.com")?lib.mtop.config.mainDomain="liangxinyao.com":-1!==location.hostname.indexOf("tmall.hk")?(lib.mtop.config.mainDomain="tmall.hk",lib.mtop.config.prefix="h5api"):-1!==location.hostname.indexOf("yao.95095")&&(lib.mtop.config.mainDomain="yao.95095.com",lib.mtop.config.prefix="api"),lib.mtop.H5Request({"api":e.apiTmallCollocationInfo,"v":"1.0","data":{"itemId":r.itemId,"userId":r.userId,"collocationId":n},"ttid":"tmalldetail"},function(e){if(a&&(!e||!e.data))return i.onComboData(t,n,o,!1);o(e&&e.data?e.data:null)},function(e){if(a)return i.onComboData(t,n,o,!1);o(null)})})}):r.apiTmallComboInfo&&e.use("ajax",function(e,r){i.onLoad("config",function(e){r({"url":e.apiTmallComboInfo,"data":{"areaId":t,"comboId":n,"noCache":a?"true":"false"},"dataType":"jsonp","success":function(e){if(a&&(!e||!e.success))return i.onComboData(t,n,o,!1);o(e&&e.success?e:null)},"error":function(){if(a)return i.onComboData(t,n,o,!1);o(null)}})})})})})),i._cdlm[u](o)})}if(!t)return void o(null);if(n=n||""){if(i["_cda"+t])return void i.onComboData(t,"",function(e){if(e&&e.currentCombo&&e.currentCombo.id==n)return o(e);r()},a)}else i["_cda"+t]=!0;r()},i.onCombo=function(t,n,o){if(!t||!n)return void o(null);e.use("malldetail/common/util",function(e,a){var r=n;i._clm=i._clm||{},i._clm[r]=i._clm[r]||(i._clm[r]=a.createLoader(function(o){e.use("detail-model/combo",function(e,a){var r=new a;r.onLogin=i.onLogin,r.set("noCache",!1),r.addAttr("comboData",{"load":function(e){r.onChange(["buyerLoc","noCache"],function(t,o){i.onComboData(t,n,function(t){e(t&&t.currentCombo||null)},o)})}}),r.addAttr("shopId",{"load":function(e){i.onChange("config",function(t){e(t&&t.rstShopId||"")})}}),r.addAttr("buyerLoc",{"load":function(e){e(t)}}),r.addAttr("misc",{"load":function(e){i.onChange("misc",e)}}),r.addAttr("state",{"load":function(e){i.onChange("state",e)}}),r.addAttr("token",{"load":function(e){i.onChange("token",e)}}),r.addAttr("minicart",{"load":function(e){i.onChange("minicart",e)}}),r.addAttr("urlMap",{"load":function(e){i.onChange("config",function(t){var n=t&&t.url;t.apiTmallComboItem&&n&&(n.apiTmallComboItem=t.apiTmallComboItem),e(n)})}}),r.onTrackID=function(){return i.onTrackID.apply(i,arguments)},o(r)})})),i._clm[r](function(e){e.onLoad("buyerLoc",function(){e.set("buyerLoc",t),o(e)})})})},i.addAttr("comboData",{"load":function(e){i.onLoad("config",function(t){if(!t.isTmallComboSupport||!t.apiTmallComboInfo&&!t.apiTmallCollocationInfo)return void e(null);i.onChange("comboLoc",function(t){i.onComboData(t,"",e)})})}}),i.addAttr("comboList",{"load":function(e){i.onChange("comboData",function(t){e(t&&t.combos||null)})}}),i.addAttr("currentComboId",{}),i.onChange("currentComboId",function(){i.reset("currentCombo",{"silent":!0})}),i.addAttr("currentCombo",{"load":function(e){i.onChange(["comboList","currentComboId","comboLoc"],function(t,n,o){i.onCombo(o,n,e)})}}),i.addAttr("recommendSku",{"load":function(t){i.onLoad(["itemDO"],function(n){e.use("ajax",function(e,o){codeTrack("data.recommendSku.start","trade.sku.init"),o({"url":"//fs.tmall.com/sizetools/recommandUserSize.jsonp","data":{"cateId":n.categoryId,"itemId":n.itemId},"dataType":"jsonp","jsonpCallback":"jsonpRecommendSku","success":function(n){n&&n.success?(n.model&&n.model.recommandSize||t(null),n.model.recommendSize=n.model.recommandSize,i.onLoad("skuProp",function(o){e.each(o,function(o,i){e.each(o,function(e,o){e.text==n.model.recommendSize&&(n.model.pid=i,n.model.vid=o,t(n))})})})):t(null),codeTrack("data.recommendSku.end","data.recommendSku.start")},"error":function(){codeTrack("data.recommendSku.error","data.recommendSku.start"),t(null)}})})})}}),i.addAttr("currentSelectSubItem",{"value":null}),i.addAttr("subItemsData",{"load":function(t){i.onLoad("subItems",function(n){var o={};i.onMap(n,["itemData"],function(e){return e},function(n){e.each(n,function(e,t){e.index=t,o[e.itemId]=e}),t(o)})})}}),i.addAttr("isBundleItem",{"load":function(e){i.onLoad("config",function(t){e(t&&t.detail&&t.detail.isBundleItem||!1)})}}),i.addAttr("subItems",{"load":function(t){i.onLoad(["isBundleItem","config"],function(n,o){if(!n)return t(null);var a=o&&o.detail&&o.detail.bundleItemList||[],r=[];e.use("detail-model/productBundle",function(e,n){e.each(a,function(e,t){e&&(e.mainPic=e.images&&e.images.mainImage,r[t]=new n,r[t].addAttr("itemData",{"load":function(t){t(e)}}),r[t].addAttr("parent",{"load":function(e){e(i)}}))}),t(r)})})}}),i.addAttr("catPropList",{"load":function(e){i.onLoad("subItems",function(t){i.onMap(t,["itemData"],function(e){return e&&e.catPropList},function(t){e(t)})})}}),i.addAttr("subItemsData",{"load":function(e){i.onLoad("subItems",function(t){i.onMap(t,["itemData"],function(e){return e},function(t){e(t)})})}}),i.addAttr("bundleSkuMap",{"load":function(t){i.onLoad("config",function(n){var o,a=n&&n.detail&&n.detail.bundleSkuMap||null;if(!a||0===(o=e.keys(a).length))return void t(a);var r={},u=0;e.each(a,function(e,n){i.onInventory(e.skuId,function(i){i&&!i.quantity&&0===i.totalQuantity||(r[n]=e,u++),0==--o&&t(r)})})})}}),i.addAttr("bundleParams",{"load":function(t){e.use("ajax",function(e,n){i.onLoad("subItemsData",function(o){function i(){if(0==r)return t(a),!1}var a={"length":0},r=o.length||0;e.each(o,function(e){n.jsonp("//mdetail.tmall.com/mobile/itemPackage.do",{"itemId":e.itemId},function(t){r--,a[e.itemId]=t&&t.model||null,a.length+=1,i()})})})})}}),i.addAttr("bundleHasSku",{"load":function(t){i.onLoad("subItemsData",function(n){var o=!1;e.each(n,function(e){e.hasSku&&(o=!0)}),t(o)})}}),i.addAttr("carSoldStore",{"value":null}),i.addAttr("carSoldFenqi",{"value":null}),i.addAttr("carSoldStoreNum",{"load":function(e){i.onChange(["selectedSku","carSoldStore"],function(t,n){e(n&&n.qtys?t&&t.skuId?n.qtys[t.skuId]||0:n.qtys[0]||0:0)})}}),i.onChange("buyerLoc",function(e){i.reset("locModel",{"silent":!0})},0),i.addBuyValidator(function(e,t){i.onLoad(["trade","deviceType","model"],function(n,o,i){if(!n)return t(null);if("phone"===o&&i.jhsDO&&1===e.type){var a=i.jhsDO;return 1!==a.itemStatus?t({"level":8,"name":"jhs","itemStatus":a.itemStatus}):t()}return t(1==e.type?n.tradeEnable?null:{"level":8,"name":"init"}:2==e.type?n.cartEnable?null:{"level":8,"name":"init"}:null)})},8),i.addBuyValidator(function(e,t){i.onLoad(["config"],function(e){t(e&&e.isTwView?e.tradeEnable?null:{"level":8,"name":"isTwView"}:null)})},8),i.addBuyValidator(function(e,t){e&&2==e.type?t():i.onLoad(["trade"],function(e){t(e&&e.sellCountDown>0?{"level":8,"name":"sellCountDown"}:null)})},8),i.addBuyValidator(function(e,t){i.onLoad(["currentInventory","isAreaRestricted"],function(e,n){if(!e||n)return t();var o=["","\u6b64\u5546\u54c1\u6682\u65f6\u7f3a\u8d27","\u6240\u9009\u533a\u57df\u6682\u65f6\u7f3a\u8d27\uff0c\u8bf7\u67e5\u770b\u5176\u4ed6\u533a\u57df","\u6709\u4eba\u8fd8\u672a\u4ed8\u6b3e\uff0c\u82e515\u5206\u949f\u540e\u4ecd\u672a\u4ed8\u6b3e\uff0c\u60a8\u5c06\u6709\u8d2d\u4e70\u673a\u4f1a"];3==e.type?t({"level":8,"name":"stock","message":o[e.type],"stockType":e.type}):0===e.quantity?t({"level":5,"name":"stock","message":o[e.type],"stockType":e.type}):t()})},8),i.addBuyValidator(function(e,t){if(2!=e.type)return void t();i.onLoad(["deviceType","model"],function(n,o){"phone"===n?2==e.type&&o&&o.jhsDO&&0==o.jhsDO.itemStatus?t():t(o.jhsDO?{"level":8,"name":"juKey"}:null):t(i.getState("key")?{"level":8,"name":"juKey"}:null)})},8),i.addBuyValidator(function(e,t){if(2===e.type)i.onLoad("currentWrtInfo",function(e){return t(e?{"level":5,"name":"wanrentuan"}:null)});else{if(1!=e.type)return void t();i.onLoad("currentWrtInfo",function(e){var n=e;n&&2!=n.type&&(0===n.status||1==n.status||3==n.status||2==n.status&&-1!=n.maxAmount&&n.maxAmount-n.purchasedAmount<=0||0===n.remainTime&&2==n.status)?t({"level":5,"name":"wanrentuan","wrtStatus":n.status}):t()})}},5),i.addBuyValidator(function(e,t){i.onLoad(["cycle","serverStartTime"],function(e,n){e&&n>e.endTime?t({"level":5,"name":"cycle"}):t()})},5),i.addBuyValidator(function(e,t){i.onLoad(["currentAmountRestrict","amount","amountMultiple","config","currentInventory","selectedSku","buyPrice","deviceType"],function(e,n,o,i,a,r,u,c){if(!i)return void t();var d=a.quantity,l=r?r.type:i.valItemInfo&&i.valItemInfo.type;if(e&&e.restrictAmount&&(0===e.amountCanBuy||n*o>e.amountCanBuy)){var s={"1":"\u805a\u5212\u7b97\u7279\u4ef7\u5546\u54c1,\u6bcf\u4eba\u9650\u8d2d"+e.restrictAmount+"\u4ef6","2":"\u805a\u5212\u7b97\u7279\u4ef7\u5546\u54c1,\u6bcf\u4eba\u9650\u8d2d"+e.restrictAmount+"\u4ef6","3":"\u6b64\u5546\u54c1\u9650\u8d2d"+e.restrictAmount+"\u4ef6","4":"\u6bcf\u4eba\u9650\u8d2d"+e.restrictAmount+"\u4ef6\uff0c\u5df2\u8d85\u8fc7\u9650\u8d2d\u6570","5":"\u60a8\u6240\u586b\u5199\u7684\u5546\u54c1\u6570\u91cf\u8d85\u8fc7\u9650\u8d2d\u6570\u91cf\uff01"};t({"level":5,"name":"limitedCheck","message":s[e.restrictType]||""})}else t(e&&e.amountLimitDown&&n<e.amountLimitDown?{"level":5,"name":"limitedCheck","message":"\u6b64\u5546\u54c1\u5355\u6b21\u8d2d\u4e70\u6570\u91cf\u81f3\u5c11\u4e3a"+e.amountLimitDown+"\u4ef6"}:"pc"===c&&i&&i.detail&&i.detail.isMainLiaoSku&&e&&e.lowLimitAmount&&n<e.lowLimitAmount?{"level":5,"name":"limitedCheck","message":"\u6b64\u5546\u54c1\u5355\u6b21\u8d2d\u4e70\u6570\u91cf\u81f3\u5c11\u4e3a"+e.lowLimitAmount+"\u4ef6"}:e&&e.amountLimitUp&&n>e.amountLimitUp?{"level":5,"name":"limitedCheck","message":"\u6b64\u5546\u54c1\u5355\u6b21\u8d2d\u4e70\u81f3\u591a\u4e3a"+e.amountLimitUp+"\u4ef6"}:"number"==typeof d&&d<n*o&&3!=l?{"level":5,"name":"limitedCheck","message":"\u60a8\u6240\u586b\u5199\u7684\u5546\u54c1\u6570\u91cf\u8d85\u8fc7\u5e93\u5b58\uff01"}:e&&!e.restrictAmount&&e.moneyCanBuy&&1*e.moneyCanBuy<n*o*u.max?{"level":5,"name":"limitedCheck","message":"\u60a8\u6240\u586b\u5199\u7684\u5546\u54c1\u603b\u4ef7\u8d85\u8fc7\u9650\u989d\uff01"}:null)})},5),i.addBuyValidator(function(e,t){i.onLoad(["isAreaRestricted"],function(e){t(e?{"level":5,"name":"areaSold","message":"\u6b64\u5546\u54c1\u4e0d\u652f\u6301\u5728\u5f53\u524d\u533a\u57df\u9500\u552e"}:undefined)})},5),i.addBuyValidator(function(t,n){i.onLoad(["skuMap","selectedSku","skuNames","selectedSkuProp"],function(o,i,a,r){if(o&&!i){var u={"level":2,"name":"sku","tmallCarFinantialEnable":t.tmallCarFinantialEnable};if(a){var c=[];e.each(a,function(t){var n=!1;e.each(r,function(e,o){if(o=Number(o),t.id===o)return n=!0,!1}),n||c.push(t.text)}),c.length&&(u.message="\u8bf7\u9009\u62e9"+c.join("\u3001"))}return n(u)}n()})},2),i.addBuyValidator(function(t,n){i.onLoad(["trade","subItems","isBundleItem"],function(t,o,a){a&&o?i.onMap(o,["itemData","selectedSku"],function(e,t){return!e.hasSku||e.hasSku&&t&&t.skuId?{"itemId":e.itemId,"skuId":t?t.skuId:0,"hasSku":e.hasSku}:n({"level":2,"name":"subItems","message":"\u8bf7\u9009\u62e9\u7ec4\u5408\u5546\u54c1\u5c5e\u6027"})},function(t){var o=[];return e.each(t,function(e){e&&o.push(e)}),n(null)}):n(null)})},2),i.addBuyValidator(function(t,n){i.onLoad(["currentService","selectedService"],function(t,o){if(t&&t.mustSelectService&&(!o||e.isEmptyObject(o)))return n({"level":2,"name":"sku","message":"\u8bf7\u9009\u62e9\u670d\u52a1"});n()})},2),i.addBuyValidator(function(e,t){i.onLoad(["etParams","config","deviceType"],function(e,n,o){if("phone"===o){n&&n.api&&n.api.appointUrl?e?t():t({"level":2,"name":"sku","message":"\u6b63\u5728\u67e5\u8be2\u670d\u52a1\u95e8\u5e97\uff0c\u8bf7\u7a0d\u540e"}):t()}else t()})},2),i.addBuyValidator(function(e,t){i.onLoad(["isPickupStore","pickupStore","etm","deviceType"],function(e,n,o,i){"pc"===i&&"post"!==o&&e&&!n?t({"level":2,"name":"sku","message":"\u8bf7\u9009\u62e9\u95e8\u5e97"}):t()})},2),i.addBuyValidator(function(e,t){i.onLoad(["pickupPoints","pickupPoint"],function(e,n){return e&&e.length&&!n?t({"level":2,"name":"sku","message":"\u8bf7\u9009\u62e9\u63d0\u8d27\u5730\u70b9"}):t()})},2),i.addBuyValidator(function(e,t){i.onLoad(["config","selectedSku","amount","currentPromotion","currentInventory","amountMultiple"],function(e,n,o,i,a,r){return o?(o*=r)&&i&&i.limitTime&&"-1"==e.statu?void t({"level":2,"name":"limitPromo","message":"\u6d3b\u52a8\u5df2\u7ecf\u7ed3\u675f\uff0c\u4f60\u53ea\u80fd\u7528\u539f\u4ef7\u8d2d\u4e70\u4e86"}):e&&e.orderLimitQuantity&&o>e.orderLimitQuantity?void t({"level":2,"name":"limitedCheck","message":"\u5f88\u62b1\u6b49\uff0c\u5f53\u524d\u53ea\u53ef\u4ee5\u8d2d\u4e70"+e.orderLimitQuantity+"\u4ef6\u5546\u54c1"}):"number"==typeof a.quantity&&a.quantity<o&&a.quantity>=0&&3!=a.type?void t({"level":2,"name":"limitedCheck","message":"\u60a8\u6240\u586b\u5199\u7684\u5546\u54c1\u6570\u91cf\u8d85\u8fc7\u5e93\u5b58\uff01"}):void t():void t()})},2),i.addBuyValidator(function(e,t){var o=n.get("#J_Select_region");!o||null!=o.value&&""!=o.value?t():t({"level":2,"name":"twoDimensionRegion","message":"\u8bf7\u9009\u62e9\u5546\u54c1\u5151\u6362\u5730!"})},2),i.addBuyValidator(function(e,t){if(1!=e.type)return void t();i.onLoad("xshmPay",function(e){if(!e)return t();i.onChange(["progressiveInfo"],function(e){e?t():t({"level":2,"name":"xshmPay","message":"\u60a8\u7684\u6388\u4fe1\u989d\u5ea6\u4e0d\u8db3"})})})},1),e.Config.debug&&i.on("*Change",function(t){e.log(["ModelChange:",t.attrName.join(",")])})}var r,u=window,c=document,d=g_config.assetsHost=g_config.assetsHost||"//a.tbcdn.cn",l=-1!=d.indexOf(".daily.");return e.extend(a,t),e.augment(a,{"onServerTime":function(t){this.onLoad(["clientStartTime","serverStartTime"],function(n,o){t(e.now()-n+o)})},"onToken":function(e){this.onLoad("deviceType",function(t){"phone"===t?e():setTimeout(function(){function t(){var t=i.readyState;t&&"loaded"!=t&&"complete"!=t||(i.onreadystatechange=i.onload=null,codeTrack("data.token.success","data.token.start"),e(window.userCookie&&window.userCookie._tb_token_||""),e=null)}var n=document;if(n.body,window.g_config.domain,-1!=window.g_config.domain.indexOf("95095.")||-1!=window.g_config.domain.indexOf("alitrip."))TB&&TB.Global&&TB.Global.loginStatusReady(function(t){e(t.tbToken||"")});else{var n=document,o=n.getElementsByTagName("head")[0]||n.documentElement,i=n.createElement("script");i.src="//www."+(l?"daily.taobao.net":"taobao.com")+"/go/app/tmall/login-api.php",i.async=!0,"onload"in i?i.onload=t:i.onreadystatechange=t,setTimeout(function(){e&&(codeTrack("data.token.timeout","data.token.start"),e(""),e=null)},4e3),o.insertBefore(i,o.firstChild)}},100)})},"onSkuList":function(e,t){this.onLoad(["skuMap"],function(n){var o={};if(!e||!n)return void t(null);for(var i in n){var a=!0;for(var r in e)if(e.hasOwnProperty(r)){var u=new RegExp(";"+r+":"+e[r]+";");if(!u.test(i)){a=!1;break}}a&&(o[i]=n[i])}t(o)})},"onPriceInfo":function(e,t){this.onLoad("priceInfo",function(n){if("object"==typeof e)return void t(e);t(n[e||"def"])},13)},"onInventory":function(e,t){this.onLoad(["inventory","config","thirdPartyInventory"],function(n,o,i){var a=null;i&&i[e]?(a=e&&i&&i[e],a.type=a.type||1):a=e&&n&&n.skuQuantity[e];var r={"type":a?a.type:n&&n.type||o&&o.valItemInfo&&o.valItemInfo.type||0,"quantity":a?a.quantity:n?n.icTotalQuantity:null,"totalQuantity":a?a.totalQuantity:null};a&&a.inventoryInfo?r.inventoryInfo=a.inventoryInfo:n&&n.itemInventoryInfo&&(r.inventoryInfo=n.itemInventoryInfo),t(r)},13)},"onPromotionList":function(e,t){if(!e)return void t(null);var n=e.promotionList;n&&(n=n.sort(o));var i=e.suggestivePromotionList||null;!i||"jhs"!=i[0].promType&&"tCodeProm"!=i[0].promType||(n=[i[0]].concat(n||[])),t(n||null)},"onSkuFeatures":function(e,t){this.onLoad("config",function(n){var o=n&&n.valItemInfo&&n.valItemInfo.skuList||null;if(o&&e){for(var i=o.length-1;i>=0;i--)e[";"+o[i].pvs+";"]&&o[i].skuFeatures&&(e[";"+o[i].pvs+";"].skuFeatures=o[i].skuFeatures);t(e)}else t(e)})},"clearSkuProp":function(){var e=this;e.onLoad("selectedSkuProp",function(t){e.set("selectedSkuProp",{})})},"refreshCanBuyStatus":function(){var e=this;e.onLoad("canBuyStatus",function(t){e.set("canBuyStatus",++t)})},"selectSkuId":function(t){var n=this;n.onLoad("skuMap",function(o){if(o){var i=e.keys(o),a=!1;e.each(i,function(e){if(o[e].skuId==t){var i={};i[e]=o[e],n.set("selectedSkuList",i),n.set("selectedSku",o[e]),a=!0}}),a||(n.set("selectedSkuList",o),n.set("selectedSku",null))}})},"selectSkuProp":function(t,n,o){if(t.indexOf(":")>=0){var i=t.split(":",2);t=i[0],n=i[1]}var a=this;a.canSelectSkuProp(t,n,function(i){if(i<=0)return void(o&&a.onLoad("selectedSkuProp",function(i){var r=e.keys(i).sort();r[0]&&a.deselectSkuProp(r[0],"",function(){a.selectSkuProp(t,n,o)})}));a.onLoad("selectedSkuProp",function(o){if(o[t]!=n){var i={};e.mix(i,o),i[t]=n,a.set("selectedSkuProp",i)}})})},"deselectSkuProp":function(t,n,o){if(t.indexOf(":")>=0){var i=t.split(":",2);t=i[0],n=i[1]}var a=this;a.onLoad("selectedSkuProp",function(i){if(!i[t]||n&&i[t]!=n)return void(o&&o());var r={};e.each(i,function(e,n){n!=t&&(r[n]=e)}),a.set("selectedSkuProp",r),o&&o()})},"canSelectSkuProp":function(t,n,o,i){function a(e){if(i.ignoreSelection)return void e({});u.onLoad("selectedSkuProp",e)}if(i=i||{},t.indexOf(":")>=0){var r=t.split(":",2);t=r[0],n=r[1]}if(!n)return void o(0);var u=this;a(function(i){if(i[t]==n)return void o(1);var a=e.mix({},i);a[t]=n,u.onSkuList(a,function(t){if(t){var n=e.keys(t).length;if(!n)return void o(-1);e.each(t,function(e){n<0||u.onInventory(e.skuId,function(e){if(!(n<0))return 3==e.type||e.quantity>0||null===e.quantity?(o(1),void(n=-1)):void(0==--n&&o(0))})})}})})},"selectService":function(t,n){if(t){if(t.indexOf("-")>=0){var o=t.split("-",2);t=o[0],n=o[1]}n=n||"0";var i=this;i.onLoad(["cacheSelectedService","currentService"],function(o,a){if(o=o||{},!o[t]||o[t].value!=n||!o[t].checked){var r={};e.each(o,function(e,n){n!=t&&(r[n]=e)}),r[t]={"key":t,"value":n,"checked":!0},i.set("cacheSelectedService",r)}})}},"deselectService":function(t,n,o){if(t){if(t.indexOf("-")>=0){var i=t.split("-",2);t=i[0],n=i[1]}n=n||"0";var a=this;a.onLoad(["cacheSelectedService","currentService"],function(i){i=i||{};var r={};e.each(i,function(e,n){n!=t&&(r[n]=e)}),r[t]={"key":t,"value":n,"checked":!1},a.set("cacheSelectedService",r),o&&o()})}},"hasPromotionPrice":function(t){this.onLoad(["priceInfo"],function(n){var o=!1;e.each(n,function(e){if(e.promotionList&&e.promotionList.length)return void(o=!0)}),t(o)})},"canSoldArea":function(t,n,o){var a=this,t=String(t);a.onLoad(["soldArea","config","misc"],function(o,r,u){if(u&&u.townId==t&&o.currentAreaEnable!=undefined)return n(o.currentAreaEnable);var c=o&&o.cityData;if(!c||c.allAreaSold)return n(!0);var d=c.soldAreas||[];if(e.inArray(parseInt(t,10),d))return n(!0);var l=o&&o.regionData,s=l.soldAreas||[];return e.inArray(parseInt(t,10),s)?n(!0):/^\d\d0000$/.test(t)?n(!!e.filter(d,function(e){return String(e).substr(0,2)==t.substr(0,2)})[0]):e.inArray(parseInt(t,10),[110100,120100,310100,500100,13e4,14e4,15e4,21e4,22e4,23e4,32e4,33e4,34e4,35e4,36e4,37e4,41e4,42e4,43e4,44e4,45e4,46e4,51e4,52e4,53e4,54e4,61e4,62e4,63e4,64e4,65e4,71e4,81e4,82e4,990100])?n(!1):t.length<=6?void a.onAreaInfo(t,function(u){if(!u)return n(!0);if(u.level<=2)return n(!1);var c=u.parent;a.canSoldArea(c,function(u){if(!1===u)return n(u);var d=a._cityLoadMap||(a._cityLoadMap={});d[c]=d[c]||i(function(t){var n=r.selectCityApi||"//mdskip.taobao.com/core/selectCity.htm?isAreaSell=true&itemId="+r.itemDO.itemId;o&&o.useNewRegionalSales&&r.newSelectCityApi&&(n=r.newSelectCityApi),r&&r.isAreaSell&&n?(codeTrack("data.selectCity.start","model.product.init"),e.use("ajax",function(e,o){o({"url":n,"data":{"city":c},"dataType":"jsonp","jsonpCallback":"jsonpSelectCity"+c,"cache":!0,"success":function(e){e.isSuccess?(codeTrack("data.selectCity.success","data.selectCity.start"),t(e.selectCityDO.regionSoldArea?e.selectCityDO.regionSoldArea:null)):(codeTrack("data.selectCity.error","data.selectCity.start"),t(null))},"timeout":10,"error":function(){codeTrack("data.selectCity.error","data.selectCity.start"),t(null)}})})):t(null)}),d[c](function(o){return n(o&&o.soldAreas?e.inArray(parseInt(t,10),o.soldAreas):!0)})})}):void a.onAreaInfo(t,function(o){if(!o)return n(!0);var u=o.parent;a.canSoldArea(u,function(o){if(!1===o)return n(o);var c=a._areaLoadMap||(a._areaLoadMap={});c[u]=c[u]||i(function(t){var n=r.selectRegionApi;r.isAreaSell&&n?e.use("ajax",function(e,o){o({"url":n,"data":{"regionId":u,"areaSold":u},"dataType":"jsonp","jsonpCallback":"jsonpRegion"+u,"cache":!0,"success":function(e){t(e.isSuccess?e.selectRegionDO.soldAreas||null:null)},"timeout":10,"error":function(){t(null)}})}):t(!0)}),c[u](function(o){return n(o&&o.soldAreas?e.inArray(t,o.soldAreas):!0)})})})})},"onAreaInfo":function(t,n,o){var a=this,r=a._areaMap||(a._areaMap={});if(!o&&r[t]!==undefined||r[t]&&r[t].children!==undefined)return void n(r[t]);var u=a._areaLoadMap||(a._areaLoadMap={});u[t]=u[t]||i(function(i){if(!o&&r[t]!==undefined||r[t]&&r[t].children!==undefined)return void n(r[t]);codeTrack("data.addrlist.start","model.product.init"),e.use("mui/address/queryAreaInfo",function(e,n){n.getAreaInfo({"id":t,"addProvs":!r[1]||!r[1].children,"success":function(n){codeTrack("data.addrlist.success","data.addrlist.start"),e.mix(r,n.list,!0,null,!0),i(r[t]||null)},"error":function(){codeTrack("data.addrlist.error","data.addrlist.start"),i(r[t]||null)}})})}),u[t](n)},"_onCardIn":function(e,t){var n=a._cardManager;n||(n=a._cardManager=new window.JZ.CardManager({"cardCookie":"xx1","loginCookie":"xx4","timeout":1e4})),n.isIn()?t():(n.begin(e),n.onCardIn(t))},"_onMfpIn":function(t){function n(){var e=window.MFP.LoginPopup;e&&(e.oncallback(t),e.check({"cardPSW":!0}))}var o=window.g_config;window.MFP?n():e.getScript(o.assetsHost+"/p/mall/jz/popup/popup.js",{"success":function(){e.use("IFCLoginPopup",n)}})},"onTrackID":function(t){this.onLoad("config",function(n){var o=n.url,i=o.mdskip?o.mdskip+"/extension/get_tb_ck_ps.htm":o.tbskip+"/json/get_tb_ck_ps.htm";e.use("cookie",function(e,n){e.getScript(i+"?varName=__BTrackID&t="+e.now(),{"success":function(){t(u.__BTrackID&&u.__BTrackID.ct||n.get("t"))},"error":function(){t(u.__BTrackID&&u.__BTrackID.ct||n.get("t"))},"timeout":5})})})},"monitorBuyServer":function(e,t,n){var o=["src="+e,"type="+t,"rq="+encodeURIComponent(n),"t="+ +new Date];(new Image).src="//asyncwebserver.monitor.taobao.com/item?"+o.join("&")},"_buylogin":function(t,n){var o=this;if(n=n||{},-1!=g_config.domain.indexOf("95095."))var i="//buy."+window.g_config.domain+"/login/buy.do?from=itemDetail&var=login_indicator&id="+n.itemId+"&shop_id="+n.shopId+"&cart_ids=";else var i="//buy."+(l?"daily.":"")+window.g_config.domain+"/login/buy.do?from=itemDetail&var=login_indicator&id="+n.itemId+"&shop_id="+n.shopId+"&cart_ids=";e.use("cookie",function(e,a){a.remove("cookie2",""),e.getScript(i+"&t="+e.now(),{"success":function(){var i=u.login_indicator||{};i.success&&i.hasLoggedIn||!i.success?t(i):i.hasLoggedIn||(i.fastBuy&&n.fastBuy?t(i):(codeTrack("trade.buy.login","trade.run.buyForm"),o.onLogin(function(n){i.fastBuy=!1,i.hasLoggedIn=!0,i.success=!0,n&&e.mix(i,n),t(i)},{"check":!1})))},"error":function(){t({"hasLoggedIn":!0,"success":!1,"fastBuy":!1})},"timeout":10,"charset":"gbk"})})},"_buyIfc":function(t,n){var o=this;codeTrack("trade.run.buyIfc","trade.buy.run"),o._onCardIn("#J_LinkBuy",function(){o._onMfpIn(function(){o.onLoad(["config","selectedSku","selectedService","amount"],function(t,o,i,a){var r=[];i&&e.each(i,function(e,t){r.push(t+"|"+(e||0))});var u=[t.itemDO.itemId,a,o?o.skuId:0];r.length>0&&u.push(r.join("-")),location.href=t.tradeConfig[3]+"?buyer_from=ifc0001&buy_param="+u.join("_"),n&&n({"level":0})})})})},"_buyState":function(e,t){var n=this;codeTrack("trade.run.buyState","trade.buy.run"),n.onLoad(["config","selectedSku","amount"],function(e,t,n){location.href=e.tradeConfig[4]+"&state=item_id_num:"+e.itemDO.itemId+",skuId:"+(t?t.skuId:0)+",quantity:"+n})},"_buyForm":function(t,o){var i=this,a={};codeTrack("trade.run.buyForm","trade.buy.run"),i.onLoad(["config","selectedSku","selectedService","selectedSkuInfo","etm","isOfflineShop","token","buyerLoc","selectedSkuInfo","itemPrice","gateway","secKill","userInfo","currentPromotion","amount","wtBuyParam","currentCycle","currentProgressive","xshmPay","hasGift","selectedCarProp","buyFlowFrom","pickupPoint","amountMultiple","pickupStore"],function(r,d,l,s,m,f,p,v,s,g,y,h,k,b,I,S,P,x,C,T,L,A,_,D,w){function O(e,t,n){if(a[e]=t,M[e])M[e].value=t;else{var o=n?' id="'+n+'" ':"";M.innerHTML+='<input type="hidden" name="'+e+'" value="'+t+'"'+o+">"}}var M=n.get("#J_FrmBid"),B=d?d.skuId:0;M.target="_self";var F=r.tradeParams||{};for(var E in F){O(E,F[E])}r.detail&&r.detail.isPrescriptionDrug&&O("cfy_detail","1");var R=e.unparam(u.location.search.substring(1));R&&R.ybhpss&&O("ybhpss",R.ybhpss),O("root_refer",A.root_refer),O("item_url_refer",A.item_url_refer),A.u_channel&&O("umpkey",A.u_channel);var q=r.itemDO.quantity||"";(!g||1==g.promType)&&b&&b.amountRestriction&&b.amountRestriction<q&&(q=b.amountRestriction);var N=[];l&&e.each(l,function(e,t){N.push(t+"|"+(e||0))}),I*=D;var j=[r.itemDO.itemId,I,B];N.length>0&&j.push(N.join("-"));var U=[];if(e.each(s,function(e){U.push(e)}),h&&h.timeKillKeyName&&"undefined"!=typeof h.timeKillKey&&r.itemDO.isOnline&&(r.itemDO.isSecondKillFromPC||r.itemDO.isSecondKillFromPCAndWap||r.detail.timeKillAuction&&k&&k.loginUserType)&&O(h.timeKillKeyName,h.timeKillKey),y&&y.trade)for(var E in y.trade.addToBuyNow)O(E,y.trade.addToBuyNow[E]);P&&(O("buy_cycle",P.buy_cycle),O("delivery_amount",P.delivery_amount));var V={};if(r&&r.carCascade&&L&&(L=L.split(";"),L=e.map(L,function(e){return e.replace(":","_")}),V.skuExtra=L),_&&(V.pickupPoint=_),!e.isEmptyObject(V)){var K=e.JSON.stringify(V);O("extraAttribute",encodeURIComponent(K))}S&&O("wt_buy_param",S),x&&(O("installmentPay",!0),O("installmentNum",x.stages),O("installmentRate",x.rate),codeTrack("trade.buy.progressive","trade.run.buyForm")),C&&(codeTrack("trade.buy.xshmPay","trade.run.buyForm"),O("xshmPay",C)),O("allow_quantity",q),O("buy_param",j.join("_")),O("quantity",I),O("_tb_token_",p,"J_TokenField"),O("skuInfo",U.join(";")),O("use_cod","false"),O("_input_charset","UTF-8"),O("destination",v),O("skuId",B),O("bankfrom",i.getState("bankfrom")),O("from_etao","etao"==i.getState("frm")?1:""),r.isTwView||r.isWorldView?O("buyer_from","mhw"):O("buyer_from",i.getState("buyer_from")||"ecity"),O("item_id_num",r.itemDO.itemId),O("item_id",r.itemDO.itemId),O("auction_id",r.itemDO.itemId),O("seller_rank","0"),O("seller_rate_sum","0"),O("is_orginal","no"),O("point_price","false"),O("secure_pay","true"),O("pay_method","\u6b3e\u5230\u53d1\u8d27"),O("from","item_detail"),O("buy_now",r.itemDO.reservePrice),O("current_price",r.itemDO.reservePrice),O("auction_type",r.itemDO.auctionType),O("seller_num_id",r.itemDO.userId),M.strSkuId&&O("strSkuId",B),O("activity",""),O("chargeTypeId","","J_ChargeTypeId");var J=i.getState("buytraceid");J&&O("buytraceid",J);var z=i.getState("i_channel");z&&O("i_channel",z),1==r.tradeType&&O("item_url_refer",c.referrer||"OTHER"),g&&1==g.promType&&O("key",i.getState("key")),r.isHouseholdService&&O("deliveryZoneCode",v),null!==m&&(O("etm",m),w&&O("booking_shop_id",w.id)),""===m?r.detail.isHkItem?M.action=r.tradeConfig[r.tradeType]:M.action=r.tradeConfig[1]:7===r.tradeType&&(x||C||T)?M.action=r.tradeConfig[2]:M.action=r.tradeConfig[r.tradeType];var Q="",H=M.action,G=-1===H.indexOf("?")?"?":"&";Q+=G+"x-itemid="+r.itemDO.itemId,Q+="&x-uid="+(k&&k.userId),M.action=H+Q;var W=u.g_aplus_pv_id;if(W){var Z=M.action;M.action=Z+(-1===Z.indexOf("?")?"?":"&")+"spm=a220o.1000855.1.1."+W}i._buylogin(function(u){if(u=u||{},u.success&&u.token&&u.token.length>0)for(var c=u.token,d=0,l=c.length;d<l;d++)O(c[d][0],c[d][1]);if(u.fastBuy&&(M.action=r.url.buyBase+"/fastbuy/fast_buy.htm",codeTrack("trade.buy.fastBuy","trade.run.buyForm")),t.tmallCarFinantialEnable){var s=n.create('<form method="post" style="display:none"/>');document.body.appendChild(s);var m="string"==typeof r.tradeConfig[6]?e.JSON.parse(r.tradeConfig[6]):r.tradeConfig[6];m.url&&(n.attr(s,"action",m.url),i.onLoad(["currentPriceInfo","currentPromotion","mainImg","itemtitle","currentColorSp"],function(t,o,i,u,c){function d(e,t,o){a[e]=t;var i=o?' id="'+o+'" ':"",r=n.create('<input type="hidden" name="'+e+'" value="'+t+'"'+i+">");n.append(r,s)}for(var l in m.params)d(l,m.params[l]);var f;f=o?o.price:t.price,e.use("io",function(e,n){if(d("sku",n.serialize(M)),d("key2",t.encryptDES),d("carIoc",i),d("carPrice",f),d("carColor",c.title),r.detail.isSavingEnergy){var o=r.api.savingEnery;s.action=o+Q}s.submit()})}))}else{if(r.detail.isSavingEnergy){var f=r.api.savingEnery;M.action=f+Q}var p={};if(r&&(p=r.detail)&&p.enableAliMedicalComponent&&(p.isPrescriptionDrug||p.isOtcDrug))return void e.use("alijk/prescription-drug-cart/index , io",function(e,t,n){t.add(n.serialize(M))});M.submit()}o&&o({"level":0})},{"itemId":r.itemDO.itemId,"shopId":r.rstShopId,"fastBuy":!n.attr("#J_LinkBuy","data-noFastBuy")&&!f&&2!=r.tradeType})})},"_cartMini":function(t,o){var i=this;codeTrack("trade.run.cartMini","trade.cart.run"),i.onLoad(["selectedService","selectedSku","config","token","buyerLoc","amount","campaignInfo","gateway","selectedCarProp","pickupPoint","currentProgressive","xshmPay","etm","pickupStore","mianliaoParams"],function(a,r,c,d,l,s,m,f,p,v,g,y,h,k,b){var I=c&&c.carCascade,S={};I&&p&&(p=p.split(";"),p=e.map(p,function(e){return e.replace(":","_")}),S={"skuExtra":p});var P={};g&&(P.installmentPay=!0,P.installmentNum=g.stages,P.installmentRate=g.rate,S.itemExtra=P,codeTrack("trade.cart.progressive","trade.run.cartMini")),y&&(codeTrack("trade.cart.xshmPay","trade.run.cartMini"),P.xshmPay=!0,S.itemExtra=P),v&&(S.pickupPoint=v),b&&(S=e.merge(S,b));var x=function(){var p=[];a&&e.each(a,function(e,t){p.push(t+"|"+(e||0))});var v=n.attr("#J_ImgBooth","src")||"",g=f&&f.trade&&f.trade.addToCart||{};null!==h&&(g.etm=h,k&&"post"!==h&&(S.etShopId=k.id,S.etShopName=encodeURIComponent(k.name)));var y={};i.onTrackID(function(a){i.onLoad(["minicart","itemDO","buyFlowFrom"],function(f,h,k){y={"_tb_token_":d,"anim":{"img":v,"startNode":t.button,"endNode":n.get("#J_MiniCart")||n.get("#TMinaCart")||undefined},"add":e.mix({"deliveryCityCode":l,"campaignId":m&&m.campaignId||i.getState("campaignId")||0,"from_etao":"etao"==i.getState("frm")?1:"","tpId":i.get("tpId"),"umpkey":k.u_channel,"items":[e.merge(g,{"itemId":c.itemDO.itemId,"skuId":r?r.skuId:0,"iChannel":i.getState("i_channel")||"","quantity":s,"serviceInfo":p.join("-"),"extraAttribute":S})]},g)},y.tsid=a,y.itemId=h.itemId,y.sellerId=h.userId,y.categoryId=h.categoryId,y.root_refer=k.root_refer,y.item_url_refer=k.item_url_refer;var b=e.unparam(u.location.search.substring(1));b&&b.ybhpss&&(y.extParam="{ybhpss:'"+b.ybhpss+"'}"),f.add(y,function(e){var e=e||{};(c.isTwView||c.isWorldView)&&setTimeout(function(){TB.Global.tmUpdate()},1e3),o({"method":"mini","level":0,"message":e.warn||"","response":e,"request":y})},function(e){codeTrack("trade.cart.error","trade.run.cartMini",{"group":e.errorCode}),o({"method":"mini","level":-1,"name":e.errorCode,"message":e.error})})})})};codeTrack("trade.cart.login","trade.run.cartMini"),i.onLoad("config",function(e){if(e&&e.detail&&e.detail.isPurchaseMallVipBuyer)return void x();i._buylogin(function(e){e.success&&e.hasLoggedIn?x():i.onLogin(x,{"check":!1})})})})},"_cartUrl":function(t,n){var o=this;codeTrack("trade.run.cartUrl","trade.cart.run");var i=function(t,i,a){t+="&ct="+i,e.getScript(t,{"success":function(){var r;if(TB&&TB.Detail&&(r=TB.Detail.CartResult,TB.Detail.CartResult=null,delete TB.Detail.CartResult),void 0===r)return o.monitorBuyServer("gwc","invalid",t),void(n&&n({"method":"obuy","trackId":i,"level":-5,"name":"fatalError","message":"\u65e0\u6cd5\u52a0\u8f7d\u8d2d\u7269\u8f66\u6570\u636e"}));"undefined"!=typeof r.error?"UserCartIsFull"===r.error||"TrackCartIsFull"===r.error?n&&n({"method":"obuy","trackId":i,"result":r,"level":-2,"name":r.error,"message":r.error}):n&&n({"method":"obuy","trackId":i,"result":r,"level":-5,"name":"fatalError","message":r.error}):(a&&e.use("cookie",function(e,t){var n,o;n=a+(-1===a.indexOf("?")?"?":"&")+"userid="+t.get("cookie17")+"&pre="+encodeURIComponent(c.URL),o=new Image(1,1),o.src=n.replace("{loc}","1")+"&cache="+ +new Date,o.onload=function(){o=null}}),n&&n({"method":"obuy","trackId":i,"result":r,"level":0}))},"error":function(){o.monitorBuyServer("gwc","timeout",t),n&&n({"method":"obuy","trackId":i,"level":-5,"name":"fatalError","message":"\u63a5\u53e3\u8bbf\u95ee\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5\u3002"})},"timeout":10,"charset":c.charset||c.characterSet||"gb2312"})};o.onLoad(["selectedSku","config","selectedService","buyerLoc","isOfflineShop","amount"],function(t,n,a,r,u,c){var d=t?2:1,l=n.valCartInfo||{},s=t?t.skuId:l.itemId,m=n.apiAddCart||"",f=l.dbNum,p=(-1===m.indexOf("?")?"?":"&")+"outer_id="+s+"&outer_id_type="+d+"&quantity="+c+"&x_id="+f;p+="&nekot="+e.now();var v=o.getState,g=v("buytraceid"),y="&bankfrom="+v("bankfrom");!u&&g&&(g="&buytraceid="+g,y+=g),p+=y;var h=[];a&&e.each(a,function(e,t){h.push(t+"|"+(e||0))}),p+="&serviceInfo="+h.join("-"),p+="&devisionCode="+r;var k=m+p,b=l.statsUrl;u?o._onCardIn("#J_LinkAdd",function(){o.onTrackID(function(e){i(k,e,b)})}):o.onTrackID(function(e){i(k,e,b)})})},"_mobilebuy":function(t,n){var o=this;codeTrack("trade.run.mobilebuy","trade.mbuy.run"),this.onLoad(["config","itemDO","selectedSku","selectedService","selectedSkuInfo","amount","mainImg"],function(t,i,a,r,u,c,d){var l={"itemId":t.itemDO.itemId,"itemImg":d.replace(/_\d{2,3}x\d{2,3}(q90)?.jpg/,"_80x80.jpg"),"relEl":"#J_ImgBooth","num":c},s=o.getState("key");if(s&&(l.tgKey=s),l.skuId=a?a.skuId:0,r){var m=[];e.each(r,function(e,t){m.push(t+"|"+e)}),l.serv=m.join("-")}i&&i.isElecCouponItem&&(l.type=1),e.use("mui/mobilecross",function(e,t){t.crossBuy(l),n({"level":0})})})},"buy":function(t){function n(e){o.set("tradeResult",e),clearTimeout(i),2==t.type?e.level?codeTrack("trade.cart.failure","trade.cart.run",{"group":e.level}):codeTrack("trade.cart.success","trade.cart.run"):3==t.type?e.level?codeTrack("trade.mbuy.failure","trade.mbuy.run",{"group":e.level}):codeTrack("trade.mbuy.success","trade.mbuy.run"):4==t.type?e.level?codeTrack("trade.buycar.failure","trade.buycar.run",{"group":e.level}):codeTrack("trade.buycar.success","trade.buycar.run"):e.level?codeTrack("trade.buy.failure","trade.buy.run",{"group":e.level}):codeTrack("trade.buy.success","trade.buy.run"),t.callback&&t.callback(e)}var o=this;t=t||{};var i;2==t.type?(codeTrack("trade.cart.start","model.product.init"),i=setTimeout(function(){codeTrack("trade.cart.lose","trade.cart.start",{"reject":"trade.cart.login"})},4096)):3==t.type?(codeTrack("trade.mbuy.start","model.product.init"),i=setTimeout(function(){codeTrack("trade.mbuy.lose","trade.mbuy.start",{"reject":"trade.mbuy.login"})},4096)):4==t.type?(codeTrack("trade.buycar.start","model.product.init"),i=setTimeout(function(){codeTrack("trade.buycar.lose","trade.buycar.start",{"reject":"trade.buycar.login"})},4096)):(codeTrack("trade.buy.start","model.product.init"),i=setTimeout(function(){codeTrack("trade.buy.lose","trade.buy.start",{"reject":"trade.buy.login"})},4096)),o.canBuy(t,function(i){if(i.type=t.type||1,i.level>0)return void n(i);o.onLoad(["deviceType","config"],function(i,a){"phone"===i?1==t.type?o._buyInPhone(t,n):2==t.type?o._cartInPhone(t,n):3==t.type&&o._chaoshiCartInPhone(t,n):2==t.type?(codeTrack("trade.cart.run","trade.cart.start"),e.use("dom",function(e,i){var a=i.parent("#J_LinkAdd");a&&!i.hasClass(a,"tb-hidden")?o._cartUrl(t,n):o._cartMini(t,n)})):3==t.type?(codeTrack("trade.mbuy.run","trade.mbuy.start"),o._mobilebuy(t,n)):(codeTrack("trade.buy.run","trade.buy.start"),o.onLoad(["isOfflineShop","config"],function(e,i){return e?void o._buyIfc(t,n):4==i.tradeType?void o._buyState(t,n):void o._buyForm(t,n)}))})})},"canBuy":function(e,t){function n(o){var u,c,d=!1;if(o<r||a.level>=o)t&&t(a);else if((u=i[o])&&(c=u.length))for(var l=c-1;l>=0;l--)u[l](e,function(e){if(e||(e={"level":0}),!d){if(c--,e.level){if(e.level>=o)return t&&t(a=e),void(d=!0);e.level>a.level&&(a=e)}0===c&&n(o-1)}});else n(o-1)}e=e||{};var o=this,i=o._bvList,a={"level":0,"checkType":e.type};i&&i.maxLevel||t&&t(a);var r=e.level||0;n(i.maxLevel)},"addBuyValidator":function(e,t){t=t||0;var n=this,o=n._bvList||(n._bvList={}),i=o[t]||(o[t]=[]);(o.maxLevel===undefined||t>o.maxLevel)&&(o.maxLevel=t),i.push(e)},"_decisionVList":[],"needDecision":function(e){function t(){for(var t=0,n=o.length;t<n;t++)o[t](function(t){if(!a){if(i--,t)return a=!0,e(!0);0===i&&e(!1)}})}var n=this,o=n._decisionVList,i=o.length,a=!1;t()},"needDecisionValidator":function(e){this._decisionVList.push(e)},"canSaveSkuValidator":function(e){this.onLoad(["skuMap","selectedSku","skuNames","selectedSkuProp","config"],function(t,n,o,i,a){if(t&&!n)return e(!1);e(!0)})},"setBuyParam":function(e,t,n){function o(n){i.onLoad("gateway",function(o){var i=o&&o.trade&&o.trade[n];null===t||t===undefined?i&&delete i[e]:(o.trade||(o.trade={}),i=i||(o.trade[n]={}),i[e]=t)})}if(codeTrack("tmshop.setBuyParam","app.init"),e){n=n||0;var i=this;1!==n&&0!==n||o("addToBuyNow"),2!==n&&0!==n||o("addToCart")}},"onProgressive":function(e,t){function n(e){return 1*(Math.floor(100*e)/100).toFixed(2)}function o(e,t,o){return(n(e/t)+n(e*o/t)).toFixed(2)}this.onLoad(["progressiveInfo","itemDO","totalPrice"],function(n,i,a){var r,u;if(n&&(r=n.extInfos)&&r.installFee&&e&&(u=r.installFee[e])){var c,d=parseInt(e,10);c=u.rate,t({"type":e,"stages":d,"minPrice":o(a.min,d,c),"maxPrice":o(a.max,d,c),"rate":c,"coupon":u.coupon,"couponPrice":u.couponPrice,"couponVisable":!(!u.coupon||!u.couponPrice)&&a.min*c<=u.couponPrice/100,"enabled":n.enable})}else t(null)})},"onWrtProgressive":function(e,t,n){function o(e){return 1*(Math.floor(100*e)/100).toFixed(2)}function i(e,t,n){return(o(e/t)+o(e*n/t)).toFixed(2)}function a(e,t,n){return(1*e+1*t.min)*n}this.onLoad(["itemPrice","servicePrice","amount"],function(o,r,u){if(o&&e&&0!=e.status){var c=-1==e.FEstepCur?0:e.FEstepCur,d={};if(e.priceRange){var l=e.priceRange;l.minTail==l.maxTail?(e.FEwk=(l.minTail/100).toFixed(2),d.min=d.max=a(e.FEwk,r,u)):(d.min=a((l.minTail/100).toFixed(2),r,u),d.max=a((l.maxTail/100).toFixed(2),r,u))}else e.FEwk=e.wrtLevelFinalPrices.length?e.wrtLevelFinalPrices[c]-e.FEdj:e.finalPayment,e.depositExpandBySku&&(e.FEwk=e.FEwk-(e.depositExpandBySku-e.price)),d.min=d.max=a((e.FEwk/100).toFixed(2),r,u);e.FEwk=(e.FEwk/100).toFixed(2),n({"stages":t.stages,"minPrice":i(d.min,t.stages,t.rate),"maxPrice":i(d.max,t.stages,t.rate),"rate":t.rate,"coupon":t.coupon,"couponVisable":!(!t.coupon||!t.couponPrice)&&d.min*t.rate<=t.couponPrice/100,"couponPrice":t.couponPrice})}else n(null)})},"getState":function(t){return e.isArray(t)?e.mix({},this.get("state"),undefined,t):(this.get("state")||{})[t]||""},"safeGet":function(e){var t,n=this;e=e.split(".");for(var o=0,i=e.length;o<i&&(void 0!==(t=0===o?n.get(e[o]):t[e[o]])&&null!==t);o++);return t}}),e.mix(a,{"instance":function(){return r||(r=new a)},"onPriceInfo":function(){var e=a.instance();return e.onPriceInfo.apply(e,arguments)},"onPromotionList":function(){var e=a.instance();return e.onPromotionList.apply(e,arguments)},"clearSkuProp":function(){var e=a.instance();return e.clearSkuProp.apply(e,arguments)},"refreshCanBuyStatus":function(){var e=a.instance();return e.refreshCanBuyStatus.apply(e,arguments)},"selectSkuProp":function(){var e=a.instance();return e.selectSkuProp.apply(e,arguments)},"deselectSkuProp":function(){var e=a.instance();return e.deselectSkuProp.apply(e,arguments)},"canSelectSkuProp":function(){var e=a.instance();return e.canSelectSkuProp.apply(e,arguments)},"selectService":function(){var e=a.instance();return e.selectService.apply(e,arguments)},"deselectService":function(){var e=a.instance();return e.deselectService.apply(e,arguments)},"onChange":function(){var e=a.instance();return e.onChange.apply(e,arguments)},"onLoad":function(){var e=a.instance();return e.onLoad.apply(e,arguments)},"buy":function(){var e=a.instance();return e.buy.apply(e,arguments)},"canBuy":function(){var e=a.instance();return e.canBuy.apply(e,arguments)},"set":function(){var e=a.instance();return e.set.apply(e,arguments)},"get":function(e){var t=a.instance();return t.onLoad(e),t.get.apply(t,arguments)}}),a},{"requires":["detail-model/model","dom"]});KISSY.add("detail-model/model",function(t,e,n){function o(){o.superclass.constructor.apply(this,arguments),codeTrack("app.init")}return window.batTrack=window.batTrack||function(){},window.codeTrack=function(){try{window.batTrack.apply(this,arguments)}catch(t){}},t.extend(o,e),t.augment(o,n.Target,{"load":function(e,n){var o=this,a=o.getAttrs(),i=a&&a[e]&&a[e].load,r=function(e,n){if(e===n)return!0;if(typeof e!=typeof n)return!1;if("object"==typeof e){if(!e||!n)return e===n;if(e.constructor!==n.constructor)return!1;var o=!0;if(t.isArray(e)){if(e.length!=n.length)return!1;for(var a=0;a<e.length;++a)if(!(o=typeof e[a]==typeof n[a]&&("object"==typeof e[a]?arguments.callee(e[a],n[a]):e[a]===n[a])))return!1}else if(t.isObject(e)){var i=0,r=0;for(var c in e)if(e.hasOwnProperty(c)&&(o="object"==typeof e[c]&&"object"==typeof n[c]?arguments.callee(e[c],n[c]):e[c]===n[c],i++,!o))return!1;if(o){for(var c in n)n.hasOwnProperty(c)&&r++;if(i!=r)return!1}}return o}return e===n};i&&(i(function(t){r(o.get(e),t)||o.set(e,t)},n),delete a[e].load)},"onChange":function(e,n,o){var a=this;if(t.isArray(e)){var i,r=new Array(e.length),c=function(t,e){for(r[e]=t,i=r.length-1;i>=0&&r[i]!==undefined;i--);if(i<0)try{n&&n.apply(null,r)}catch(o){setTimeout(function(){throw o},0)}};return void t.each(e,function(t,e){a.onChange(t,function(t){c(t,e)},o)})}if(o=o!==undefined?o:1,o&&a.load(e,o),n){var u=a.get(e);if(u!==undefined){try{n&&n(u)}catch(l){setTimeout(function(){throw l},0)}if(8&o)return}var d="after"+(e.charAt(0).toUpperCase()+e.substring(1))+"Change",m=function(t){8&o&&a.detach(d,m);try{n&&n(t.newVal)}catch(l){setTimeout(function(){throw l},0)}};if(a.on(d,m),t.Config.debug){var s=a["__~ks_custom_events"][d].observers.length;t.log("Event:"+d+","+s),s>16&&t.debug&&t.debug()}}},"onLoad":function(t,e,n){this.onChange(t,e,8|(n||1))},"onMap":function(e,n,o,a){var i=t.keys(e).length,r=t.isArray(e)?new Array(i):{};KISSY.each(e,function(t,e){t.onLoad(n,function(){r[e]=o.apply(t,arguments),0==--i&&a(r)})})}}),o},{"requires":["base","event/custom"]});KISSY.add("malldetail/main/baseDetail",function(e){var t=window,a=t.g_config,i=a.assetsHost=a.assetsHost||"//assets.alicdn.com",o=(t.location.hostname,a.isDaily=-1!=i.indexOf(".daily.")),n=e.startsWith(t.location.href,"https:");return e.mix(TShop,{"_onTMShop":TShop.createLoader(function(t){if(window.TMShop)return t(window.TMShop);e.use("shop/app,shop/page/detail-mdv,shop/app.css,shop/page/detail-mdv.css",function(){t(window.TMShop)})}),"onMdv":TShop.createLoader(function(e){TShop._onTMShop(function(t){t.onMdv(function(t){t.onProduct=TShop.onProduct,t.onDatalazyload=TShop.onDatalazyload,e(t)})})}),"t":function(){return a.t},"addDomainAgentCallback":function(e){if(!window.onDomainAgentChange){var t=[];window.onDomainAgentChange=function(e){for(var a=t.length-1;a>=0;a--)if(t[a](e))return!0;return!1},window.addDomainAgentCallback=function(e){t.push(e)}}window.addDomainAgentCallback(e)},"isDaily":function(){return o},"isHttps":function(){return n},"sendImg":function(t,a){if(t){var i={"rn":TShop.getUrlParams("rn")};return TShop.onProduct&&TShop.onProduct(function(t){t.onLoad(["itemDO","config"],function(t,a){e.mix(i,{"catid":t.categoryId,"itemId":t.itemId,"pagetype":TShop.getPageType(),"sellerId":t.userId});var o=a&&a.detail&&a.detail.abTestParam;o&&(i.abTestParam=o)})}),TShop.sendImg=function(t,a){if(t){var a=a||{};a=e.mix(a,i,!1),-1==t.indexOf("?")?t+="?"+e.param(a):t+="&"+e.param(a),TShop.sendImage(t+"&_tm_cache="+e.now())}},TShop.sendImg(t,a)}},"getPageType":function(){var e=location.href;switch(!0){case"temai"==a.pageType:return a.pageType;case/spu_detail/.test(e):return"spu";case/meal_detail/.test(e):return"meal";default:return"item"}},"sendImage":function(a){var i="jsFeImage_"+e.guid(),o=t[i]=new Image;o.onload=o.onerror=function(){t[i]=null},o.src=a,o=null},"sendAtpanel":function(t,a,i){var o=i;if(e.isNumber(a)&&(o=a,a=undefined),!((o=0)&&Math.floor(Math.random()*o)>0)){var n="//gm.mmstat.com/"+t;TShop.sendImg(n,a)}},"sendAcAtpanel":function(e,t){var a="//ac.mmstat.com/"+e;TShop.sendImg(a,t)},"sendErr":function(e,t){t=t||{},t.type=e,TShop.sendAtpanel("tmalldetail.15.2",t)},"flush":t.CollectGarbage||function(){},"throttle":function(t,a,i){function o(){n&&(n.cancel(),n=0),l=e.now(),t.apply(i||this,arguments),s=e.now()}var n,l=0,s=0,a=a||150;return e.mix(function(){!l||s>=l&&e.now()-s>a||s<l&&e.now()-l>8*a?o():(n&&n.cancel(),n=e.later(o,a,0,null,arguments))},{"stop":function(){n&&(n.cancel(),n=0)}})},"getUrlParams":function(a){var i=TShop._urlParams||(TShop._urlParams=e.unparam(t.location.search.substring(1)));return"string"==typeof a?i[a]||"":e.isArray(a)?e.mix({},i,undefined,a):i},"onLogin":function(a,i){codeTrack("login.init","app.init");var o=setTimeout(function(){codeTrack("login.timeout","login.init"),location.href="//login."+(TShop.isDaily()?"daily.taobao.net":"tmall.com")+"/?redirect_url="+encodeURIComponent(location.href)},4096);e.use("mui/minilogin",function(e,n){clearTimeout(o),n._domainAgentInited||(TShop.addDomainAgentCallback(function(t){var a=e.unparam(t.location.search.substring(1));if("minilogin"!=a.type)return!1;try{window[a.callback](t.login_indicator),window[a.callback]=null;try{delete window[a.callback]}catch(i){}codeTrack("login.callback","login.init")}catch(o){setTimeout(function(){throw o},0)}return!0}),n._domainAgentInited=!0);var l="//"+t.location.host,s="";e.startsWith(t.location.href,"http:")&&(s="http:"),e.startsWith(t.location.href,"https:")&&(s="https:"),TShop.onProduct&&TShop.onProduct(function(e){e.onLoad("config",function(e){e&&e.url&&e.url.xCrossServer&&(l=e.url.xCrossServer)})}),e.startsWith(l,"http:")||e.startsWith(l,"https:")||(l=s+l);var r=e.mix({"proxyURL":l+"/cross/x_cross_iframe.htm?type=minilogin&t="+TShop.t()},i);n.show(a,r)})},"onIsWebpSupport":function(t){e.use("mui/datalazyload/webp",function(e,a){a.isSupport(t)})},"onDatalazyload":TShop.createLoader(function(t){e.use("mui/datalazyload/index",function(e,a){var i=new a(document.body,{"autoDestroy":!1,"diff":{"top":0,"bottom":10}});i.set("webpReplacer",function(e){return/(?:taobaocdn.com|md.alicdn.com)\/.+\.(?:jpg)/.test(e)&&(/_\.webp$/.test(e)||(e+="_.webp")),e}),t(i),TShop.afterWinLoad(function(){e.use("dom",function(e,t){i.set("diff",{"top":-42,"bottom":t.viewportHeight()})})})})}),"addLazyCallback":function(t,a){TShop.onDatalazyload(function(i){e.use("dom",function(e,o){(t=o.get(t))&&i.addCallback(t,function(){return"none"!=o.css(t,"display")&&a(t)})})})},"refreshLazy":function(){TShop.onDatalazyload(function(e){e.refresh()})}}),{"init":function(){}}});KISSY.add("malldetail/main/productDetail",function(e,t){var a,i,o,n,l=document,s=window,r=s.g_config,d=s.location.hostname,c=1;return e.mix(TShop,{"loadMdskip":function(t){function a(t){s.onMdskip=null,n=n?n(t):function(e){e(t)};var a=e.now()-i;t?(TShop.onProduct(function(e){e.set("timeminus",a)}),codeTrack("data.mdskip.success","data.mdskip.load",{"autoGroup":"time"})):codeTrack("data.mdskip.error","data.mdskip.load",{"autoGroup":"time"})}codeTrack("data.mdskip.load"),setTimeout(function(){TShop.onProduct(function(e){e.get("mdskip")||(codeTrack("data.mdskip.timeout","data.mdskip.load",{"autoGroup":"time"}),e.set("mdskip",{}))})},t.noSkipMode&&t.noSkipMode.timeout||15e3);var i=e.now();if(window.onMdskip)return window.onMdskip(a),void codeTrack("data.mdskip.preload","data.mdskip.load");var o=TShop.getUrlParams(["ip","campaignId","key","abt","cat_id","q","u_channel","areaId"]);o.ref=encodeURIComponent(l.referrer),o.brandSiteId=t.itemDO.brandSiteId;var r=document.cookie.match("(^|;) ?l=([^;]*)(;|$)"),d=document.cookie.match("(^|;) ?isg=([^;]*)(;|$)");o.isg=r&&r[2],o.isg2=d&&d[2];var c=e.param(o);s.onMdskip=a,e.getScript(t.initApi+"&callback=onMdskip&"+c,{"error":a})},"aldPreprocess":function(t){function a(e){return((16386^e)/100).toFixed(2)}var i=-1;return TShop.onProduct(function(e){e.onLoad(["config","serverStartTime"],function(e,t){var a=e.detail.recommendBigMarkDownStartTime||14498496e5;t>(e.detail.recommendBigMarkDownEndTime||1449936e6)?i=1:t>a&&(i=0)})}),e.each(t,function(e){if(e&&(1===i&&e.isTmall1111&&delete e.isTmall1111,0===i&&e.esp!==undefined&&""!==e.esp)){var t=a(e.esp);1*t>0&&(e.price=e.item_price=t)}}),t},"initFoot":function(e){codeTrack("data.config.load1","app.init")},"getQrURL":function(t){var a=e.substitute("http://m.laiwang.com/market/laiwang/tmall/app-download.php?type=detail&iframe=1&key={itemId}&src=pcdetail&mmstat={mmstat}&biz=tmall",{"itemId":t.itemId,"mmstat":t.mmstat});return"//gcodex.alicdn.com/qrcode.do?biz_code=tmallpc&content="+encodeURIComponent(a)+"&size=175&margin=0&logo_url="+encodeURIComponent("http://img.alicdn.com/tfs/TB1xrwucwMPMeJjy1XcXXXpppXa-198-198.png")+"&channel_id="+c++}}),{"init":function(c,m){t.init(c,m),c.product.onLogin=TShop.onLogin,i={"pageStatus":0,"focusTime":0,"maxScrollTop":0,"clickCount":0,"validHits":0},a=c.product,a.set("state",TShop.getUrlParams()),c.product.set("deviceType",TShop.detector.deviceType),-1!=d.indexOf(".tmall.")?r.domain=d.substr(d.indexOf(".tmall.")+1):-1!=d.indexOf(".taobao.")?r.domain=d.substr(d.indexOf(".taobao.")+1):-1!=d.indexOf("95095.")?r.domain=d.split(".").slice(1).join("."):-1!=d.indexOf("liangxinyao.")?r.domain=d.substr(d.indexOf(".liangxinyao.")+1):-1!=d.indexOf("b2byao.")?r.domain=d.substr(d.indexOf(".b2byao.")+1):r.domain=l.domain.split(".").slice(-2).join(".");try{-1!==r.domain.indexOf("yao.")?-1!==r.domain.indexOf("daily.")?l.domain="etao.net":-1!==r.domain.indexOf("liangxinyao.")?l.domain=r.domain:-1!==r.domain.indexOf("b2byao.")?l.domain=r.domain:l.domain=r.domain.replace("yao.",""):l.domain=r.domain}catch(u){}e.use(["event","dom","io","malldetail/common/util"],function(e,t,d,c,m){function u(e){var t=e&&e.defaultModel&&e.defaultModel.pageJumpDO;if(t)return codeTrack("page.jump.init","app.init",{"group":t.type}),void(s.location.href=t.url);a.set("mdskip",e||null)}var p=window.history;if(p&&p.replaceState){var f=location.href.split("?")[0]+"?";a.onChange("state",function(t){var a=e.keys(t),i=[];e.each(a,function(a){t[a]&&(e.isArray(t[a])?e.each(t[a],function(e){i.push(a+"="+e)}):i.push(a+"="+t[a]))});var o=f+i.join("&");p.replaceState(null,null,o)}),a.onChange(["selectedSku","selectedSkuProp"],function(t,i){a.onLoad("state",function(o){var n=null;if(t)n=e.merge(o,{"sku_properties":null,"skuId":t.skuId});else{var l=[];e.each(e.keys(i),function(e){l.push(e+":"+i[e])}),n=e.merge(o,{"skuId":null,"sku_properties":l.join(";")})}a.set("state",n)})})}TShop.onProduct=function(e){e(a)},TShop.onMdv(function(e){e.addElement(".j-mdv")}),e.ready(function(){TShop.onMdv(function(e){e.addElement(".j-mdv")})}),n=n?n(u):u;var h;if(o=(h=/sampling_v=(\d+)/.exec(location.search))&&h[1]||parseInt(1e4*Math.random()),a.set("visitStat",i),a.set("samplingVisit",o),i){t.on(s,"load",function(){i.pageStatus=8|i.pageStatus});var g=function(e){i.pageStatus=16|i.pageStatus,i.maxScrollTop=Math.max(i.maxScrollTop,d.scrollTop())};t.on(l,"scroll",g),t.on(l,"click",function(t){i.clickCount++,t&&t.target&&(e.inArray(t.target.nodeName,["A","BUTTON","INPUT","AREA"])||d.parent(t.target,"A")||"pointer"==d.css(t.target,"cursor"))&&i.validHits++});var v=parseInt(r.startTime/1e3,10),b=function(){var t=parseInt(e.now()/1e3,10);t<=v||(i.focusTime+=1e3*Math.min(t-v,4),v=t)};t.on(l,"scroll click mousedown keydown mousemove",b),t.on(s,"unload",function(){g();var t=d.get("#J_Detail"),a=d.get("#J_DcTopRight"),o=d.get("#J_DcBottomRight");TShop.sendAtpanel("tmalldetail.49.3",{"pageStatus":i.pageStatus,"unloadTime":e.now()-r.startTime,"focusTime":i.focusTime||0,"descWidth":t?d.width(t):0,"descHeight":t?d.height(t):0,"descTop":t?parseInt(d.offset(t).top,10):0,"dctrHeight":a?d.height(a):0,"dctrTop":a?parseInt(d.offset(a).top,10):0,"dcbrHeight":a?d.height(o):0,"dcbrTop":o?parseInt(d.offset(o).top,10):0,"maxScrollTop":i.maxScrollTop,"clickCount":i.clickCount,"validHits":i.validHits,"pageWidth":d.width(l),"pageHeight":d.height(l),"refer":encodeURIComponent(document.referrer||"")},1e4)})}a.onLoad("config",function(t){t&&(t.newSkuRight=!0,t.sizeHelperEnable=!0,TShop.loadMdskip(t)),t.renderReq&&((new Image).src=t.renderSystemServer+"/index.htm?keys="+encodeURIComponent(t.renderReq));var i=[];t.valFlashUrl&&i.push("malldetail/other/flashplayer"),t.isTmallComboSupport&&i.push("malldetail/body/combo"),d.get("#promote")&&i.push("malldetail/sku/promotion"),t.itemDO&&t.itemDO.tagPicUrl&&!t.itemDO.isNewProGroup&&i.push("malldetail/tabbar/tabbarAttr"),t.itemDO&&t.itemDO.isNewProGroup&&i.push("malldetail/tabbar/standardAttr"),e.use(i),a.onLoad(["isDownShelf","mdskip"],function(e){e||setTimeout(function(){a.onLoad("reviewCount")},0)}),e.getScript("//g.alicdn.com/mm/cps/trace.js?t=20130926_"+r.t)})}),a.onLoad("model",function(t){var a,i=t&&t.dyTimeComponent||null,o={"init":function(t){if(a)return a;a=t.startTime-e.now()},"now":function(){return e.now()+(a||0)}},n=null;if(i){var l=i.currentTime,s=i.dyEndTime,r=i.dyStartTime,d=i.dyUrl;o.init({"startTime":l}),n=setInterval(function(){o.now()>=r&&o.now()<=s&&(clearTimeout(n),d?location.href=d:location.reload())},1e3)}}),a.onLoad("misc",function(t){var a=function(e){var t=[];for(var a in e)t.push(a+":"+e[a]);return t.join(",")},i={};t&&(i.rn=t.rn||"",i.source=-1!=document.referrer.indexOf("//")?document.referrer.split("//")[1].split("/")[0]:"",i=e.mix(i,t.trackParams,!1),TShop.sendAtpanel("tmalldetail.110.97",{"param":a(i)}))}),e.use("malldetail/view/main",function(e,t){t.init(c)}),TShop.afterWinLoad(function(){e.use("malldetail/common/destroy",function(e,t){t.init({"product":a})})}),m&&m()}}},{"requires":["malldetail/main/baseDetail"]});KISSY.add("malldetail/common/template",function(e){function t(t){if(!a[t]){var i,l,o=e.guid(s),n=[p,o,g,l=k(t),h];try{i=new Function(o,n.join(""))}catch(r){n[3]=d+m+c+","+r.message+d+m,i=new Function(o,n.join(""))}a[t]={"name":o,"o":l,"parser":n.join(""),"render":i}}return a[t]}var a={},i={"#":"start","/":"end"},l="KS_TEMPL_STAT_PARAM",o=new RegExp(l,"g"),n="KS_TEMPL",s="KS_DATA_",r="as",d='");',m=n+'.push("',c="KISSY.Template: Syntax Error. ",u="KISSY.Template: Render Error. ",p="var "+n+"=[],"+l+"=false;with(",g="||{}){try{"+n+'.push("',h='");}catch(e){'+n+'=["'+u+'" + e.message]}};return '+n+'.join("");',v=function(e){return e.replace(/\\"/g,'"')},f=function(e){return e.replace(/"/g,'\\"')},b=e.trim,k=function(t){var a,l;return f(b(t).replace(/[\r\t\n]/g," ").replace(/\\/g,"\\\\")).replace(/\{\{([#\/]?)(?!\}\})([^}]*)\}\}/g,function(t,s,r){if(a="",r=v(b(r)),s){l=r.indexOf(" "),r=-1===l?[r,""]:[r.substring(0,l),r.substring(l)];var c,u=r[0],p=b(r[1]),g=y[u];g&&i[s]&&(c=g[i[s]],a=String(e.isFunction(c)?c.apply(this,p.split(/\s+/)):c.replace(o,p)))}else a=n+".push(typeof ("+r+') ==="undefined"?"":'+r+");";return d+a+m})},y={"if":{"start":"if(typeof ("+l+') !=="undefined" && '+l+"){","end":"}"},"else":{"start":"}else{"},"elseif":{"start":"}else if("+l+"){"},"each":{"start":function(e,t,a,i){var l="_ks_value",o="_ks_index";return t===r&&a&&(l=a||l,o=i||o),"KISSY.each("+e+", function("+l+", "+o+"){"},"end":"});"},"!":{"start":"/*"+l+"*/"}};return e.mix(t,{"log":function(i){i in a?"js_beautify"in window||e.log(a[i].parser,"info"):(t(i),this.log(i))},"addStatement":function(t,a){e.isString(t)?y[t]=a:e.mix(y,t)}}),e.Template=t});KISSY.add("malldetail/common/util",function(e,t,a){function i(e){return function(){for(var t=0;t<e.length;t++){e[t].status=2;for(var a,i=e[t].callbacks;a=i.shift();)a(e[t].getter?e[t].getter():undefined)}}}var o={};return{"createLoader":function(e){var t,a,i,o=[];return function(l,n){return 0===n||n||(n=1),1&n&&!a&&(a=!0,e(function(e){for(t=e;i=o.shift();)i&&i.apply(null,[t])})),t!==undefined?(l&&l.apply(null,[t]),t):(2&n||l&&o.push(l),t)}},"createAsyn":function(e,t){var a,i,o,l,n=[];return e(function(e){for(i=e;l=n.shift();)l.handle.apply(null,[i])},0),function(l,s){if(0===s||s||(s=1),1&s&&!a&&(setTimeout(function(){if(i===undefined){o=!0;for(var e=0;e<n.length;e++)n[e].handle.apply(null,[i]),8&n[e].type||(n.splice(e,1),e--)}},t||200),e(null,s)),l)return i===undefined&&4&s?void(o?(l(),8&s&&e(l,s)):n.push({"handle":l,"type":s})):void e(l,s)}},"loadAssets":function(t,a,l){function n(){0==--r&&a&&a()}if(e.isArray(t)){var s=this,r=t.length;return void e.each(t,function(e){s.loadAssets(e,n)})}var d;if(l&&(d=l())!==undefined)return void(a&&a(d));t=t.replace(/^[\/\\]+/g,"").replace(/\?\?/g,"?");var c=t.split("?",2),m=c[0],u=c[1]||"",p=o[m]||(o[m]={"path":m,"status":0,"callbacks":[],"timestamp":[]});if(l&&(p.getter=l),2==p.status)return void(a&&a(l?l():undefined));a&&p.callbacks.push(a),u&&p.timestamp.push(u),!p.status&&setTimeout(function(){var t={};for(var a in o){var l=o[a];if(!l.status){l.status=1;var n=/\.([^\.$]+)$/.exec(a),s=n&&n[1]||"js",r=t[s]||(t[s]={"items":[]});r.items.push(l)}}for(var a in t){var d,r=t[a],c=r.items,m=window.g_config.assetsHost||"//assets.alicdn.com",u=[],p=[],g=undefined;m+="/";for(var h=0;h<c.length;h++){var v=c[h].path;if(g===undefined)g=v,d=g.length;else for(;g&&v.substring(0,d)!=g;){var f=g.lastIndexOf("/",g.length-2);if(f<0){g="";break}g=g.substring(0,f+1),d=g.length}u.push(c[h].path),p=p.concat(c[h].timestamp)}if(g&&u.length>1){m+=g+"??";for(var h=0;h<u.length;h++)u[h]=u[h].substring(d)}else m+="??";m+=u.join(","),p.sort();for(var h=p.length-1;h>=0;h--)p[h]==p[h-1]&&p.splice(h,1);p[0]&&(m+="?"+p.join("&")),e.getScript(m,{"success":i(c),"charset":"utf-8"})}},16)},"initHover":function(){var e=arguments.callee._hover;return e===undefined&&((e=arguments.callee._hover=!("ontouchstart"in document))?t.addClass("body","enableHover"):t.removeClass("body","enableHover")),e},"fixHover":function(i,o,l){var n=this.initHover(),s=6==e.UA.ie;l=l||"hover",n&&!s||(o=s?"mouse":o||"click",e.each(t.query(i),function(e){function i(a){t.addClass(e,l)}function r(a){("touch"==o||"mouse"==o||a.target!=e&&!t.contains(e,a.target))&&t.removeClass(e,l)}(!n||s&&"A"!=e.nodeName)&&("touch"==o?(a.on(e,"touchstart",i),a.on(e,"touchend",r),t.style(e,{"WebkitTouchCallout":"none"})):"mouse"==o?(a.on(e,"mouseenter",i),a.on(e,"mouseleave",r)):(a.on(e,"mousedown touchstart",i),a.on(document,"mousedown touchstart",r)))}))},"bucketStat":function(t,a){var i;return!!(i=a&&a.match(/\[(.+)]/)[1].split(","))&&(!!e.inArray(t.toString(),i)||"no"!=i[0]&&"all"==i[0])},"openNewSafeTab":function(e,i){var o=i||document.body,l=t.create('<a target="_blank" style="display:none" href="'+e+'"></a>');t.append(l,o),a.fire(l,"click")}}},{"requires":["dom","event"]});KISSY.add("malldetail/sku/buylink",function(e,t,a){function i(e){codeTrack("trade.buylink.init","trade.main.init"),e=e||{};var i=e.el,n=e.product;if(i&&!t.get(".ensureText",i)){var o=t.create('<span class="ensureText">\u786e\u8ba4</span>');t.append(o,i)}n.onChange("canBuyStatus",function(){n.canBuy({"type":1,"level":4},function(e){e.level>6?t.addClass(t.parent(i),"tb-hidden"):(t.removeClass(t.parent(i),"tb-hidden"),e.level>3?(t.addClass(i,"noPost"),"stock"===e.name&&n.onLoad(["currentInventory","state","bucketId"],function(e,t,a){e&&0===e.quantity&&TShop.sendAtpanel("tmalldetail.34.1")}),"areaSold"!==e.name&&"stock"!==e.name||n.onLoad(["currentInventory","state","bucketId"],function(e,t,a){t.areaId&&TShop.sendAtpanel("msearch.10.2",{"areaid":t.areaId,"bucketId":a})}),"cycle"===e.name&&t.html(i,"\u8ba2\u8d2d\u5df2\u7ed3\u675f\uff0c\u4e0b\u6b21\u65e9\u70b9\u6765\u54e6")):t.removeClass(i,"noPost"))})}),a.on(i,"click",function(a){codeTrack("trade.buylink.click","trade.buylink.init"),a.preventDefault(),t.hasClass(t.parent(a.target),"noPost")||(TShop.sendAtpanel("tmalldetail.50.1"),window.gfbtrack&&"function"==typeof window.gfbtrack&&window.gfbtrack("Purchase",{"content_ids":window.g_config?window.g_config.itemId:"","content_type":"product"}),n.buy({"type":1,"button":i,"callback":function(t){t.level?e.showMsg(t.message):e.hideMsg()}}))})}return{"init":i}},{"requires":["dom","event"]});KISSY.add("malldetail/sku/cartlink",function(e,t,a){return{"init":function(e){function i(r){codeTrack("trade.cartlink.click","trade.cartlink.init");try{r.preventDefault()}catch(c){}var l=r.target;"B"==l.tagName&&(l=a.parent(l)),a.hasClass(l,"noPost")||(o.onLoad(["config","itemDO"],function(e,t){TShop.sendAtpanel("tmalljy.1.1",{"shopid":e.rstShopId,"itemid":t.itemId,"pos":"detailclickadd"})}),o.onLoad(["isLogin","itemDO"],function(a,l){!a&&l&&l.showCompanyPurchase&&l.isEnterprisePath?TShop.onLogin(function(){window.location.reload()}):o.buy({"type":2,"button":n,"callback":function(a){if(a.level){if(o.onLoad(["itemDO"],function(e){e&&e.showCompanyPurchase&&e.isEnterprisePath&&TShop.sendAtpanel("tmalljy.2.52",{"pos":"addToCartF","type":"pc","biz":"detail"}),e&&window.gfbtrack&&"function"==typeof window.gfbtrack&&window.gfbtrack("AddToCart",{"content_ids":e.itemId||"","content_type":"product"})}),TShop.sendAtpanel("tmalljy.2.52",{"pos":"addToCartF","type":"pc","biz":"detail"}),a.level<-3)a.message&&alert(a.message);else if("obuy"==a.method)switch(a.name){case"TrackCartIsFull":var n="//login."+(g_config.isDaily?"daily.taobao.net":"taobao.com")+"/member/login.jhtml?from=detail&style=simple&redirectURL="+encodeURIComponent(location.href);e.showMsg('\u60a8\u6dfb\u52a0\u7684\u5546\u54c1\u79cd\u7c7b\u5df2\u7ecf\u8fbe\u5230\u4e0a\u9650\u4e86\uff0c<a href="'+n+'">\u767b\u5f55</a>\u540e\u53ef\u7ee7\u7eed\u6dfb\u52a0');break;default:e.showMsg(a.message)}else if("mini"==a.method){switch(a.name){case"BuyerNeedLogin":TShop.onLogin(function(){i(r)},{"check":!1});break;case"TrackCartIsFull":var l=a.message;l=l.replace(/<a\s+[^>]+>\u767b\u5f55<\/a>/,'<a class="Tms_Comm_Login" href="#">\u767b\u5f55</a>'),e.showMsg(l),setTimeout(function(){t.on(".Tms_Comm_Login","click",function(e){TShop.onLogin(function(){i(e)},{"check":!1})})},1024);break;default:e.showMsg(a.message,"attention")}return}"twoDimensionRegion"==a.name||"limitedCheck"==a.name||"limitPromo"==a.name||"stock"==a.name?e.showMsg(a.message):e.hideMsg()}else o.onLoad(["itemDO"],function(e){e&&e.showCompanyPurchase&&e.isEnterprisePath&&TShop.sendAtpanel("tmalljy.2.52",{"pos":"addToCartS","type":"pc","biz":"detail"})}),a.message?e.showMsg(a.message,"attention"):e.hideMsg()}})}),TShop.sendAtpanel("tmalldetail.50.3"))}codeTrack("trade.cartlink.init","trade.main.init"),e=e||{};var n=e.el,o=e.product;if(n&&!a.get(".ensureText",n)){var r=a.create('<span class="ensureText">\u786e\u8ba4</span>');a.append(r,n)}o.onChange("canBuyStatus",function(){o.canBuy({"type":2,"level":4},function(e){e.level>6?a.addClass(a.parent(n),"tb-hidden"):(a.removeClass(a.parent(n),"tb-hidden"),e.level>3?a.addClass(n,"noPost"):a.removeClass(n,"noPost"))})}),t.on(n,"click",i)}}},{"requires":["event","dom"]});KISSY.add("malldetail/sku/action",function(e,t,a,i,n){return{"init":function(o){var r=o.product,l=o.el;codeTrack("trade.action.init","trade.main.init");var c=t.get("#J_LinkBuy");c?(i.init({"el":c,"showMsg":o.showMsg,"hideMsg":o.hideMsg,"product":r}),o.onBuyEnable&&o.onBuyEnable()):codeTrack("trade.main.noLinkBuy","trade.action.init");var s=t.get("#J_LinkAdd"),d=t.get("#J_LinkBasket");!s||t.hasClass(t.parent(s),"tb-hidden")?(t.addClass(t.parent(s),"tb-hidden"),s=d):t.addClass(t.parent(d),"tb-hidden"),s?n.init({"el":s,"showMsg":o.showMsg,"hideMsg":o.hideMsg,"product":r}):codeTrack("trade.main.noLinkAdd","trade.action.init"),r.onChange(["tradeResult","config"],function(a,i){a&&"obuy"==a.method&&a.result&&e.use("malldetail/other/obuycart",function(e,n){var o=i&&i.valCartInfo&&i.valCartInfo.cartUrl,r=a.trackId;if(o){var l=["ct="+r],c=TShop.getUrlParams("buytraceid");!g_config.offlineShop&&c&&l.push("buytraceid="+c),o=o+(-1===o.indexOf("?")?"?":"&")+l.join("&")}else o="//buy."+(g_config.isDaily?"daily.taobao.net":"taobao.com")+"/auction/cart/my_cart.htm";n.update({"parentEl":t.parent(s,2),"cartUrl":o,"result":a.result})})}),r.onChange("canBuyStatus",function(e){r.canBuy(1,function(e){var a=t.get(".tb-action");"isTwView"===e.name&&e.level>=7&&(t.text(a,"\u672c\u5546\u54c1\u4e0d\u652f\u6301\u672c\u5340\u57df\u92b7\u552e"),t.addClass(a,"tm-tw-cannotbuy"))})});var u;r.onChange("currentInventory",function(e){3==e.type?(u||t.append(u=t.create('<span class="tm-change-left">\u8fd8\u6709\u673a\u4f1a</span>'),l),t.show(u)):u&&t.hide(u)}),r.onLoad("tmallCarFinantialEnable",function(a){a&&e.use("malldetail/sku/buycar",function(e,a){a.init({"relEl":t.parent(c,".tb-btn-sku"),"showMsg":o.showMsg,"hideMsg":o.hideMsg})})});var m=!1,p=!1;r.onChange("tradeResult",function(a){t.removeClass(e.query("a.tb-act",l),"tb-act"),t.removeClass(e.query("a.tb-btn-inbox",l),"tb-btn-inbox"),a&&a.level>0&&"sku"==a.name?(p=!0,1!=a.type||a.tmallCarFinantialEnable||t.addClass(c,"tb-act"),1==a.type&&a.tmallCarFinantialEnable&&t.addClass("#J_LinkBuyCar","tb-act"),2==a.type&&t.addClass(s,"tb-act"),m||(m=!0,r.onChange("canBuyStatus",function(){if(p){var a=t.query("a.tb-act",l);e.each(a,function(e){r.canBuy({"type":"J_LinkBuy"===e.id?1:2},function(e){e.level>0&&"sku"==e.name?t.removeClass(a,"tb-btn-inbox"):t.addClass(a,"tb-btn-inbox")})})}}),codeTrack("trade.sku.attention","trade.action.init"))):p=!1});var f;r.onChange(["trade","itemPrice","itemDO"],function(i,n,o){if(!(i&&i.sellCountDown>0)||n&&n.wanrentuanInfo)f&&t.remove(f),o.isHotItem||t.show(l);else{if(!f){f=t.create('<div class="tm-countdown"><div class="tb-btn-wait">\u5373\u5c06\u5f00\u59cb &middot; &middot; &middot; </div><div class="tm-countdown-notice">\u8ddd\u5f00\u552e \u8fd8\u5269<div class="tm-countdown-timer"></div></div></div>');var c=t.get(".tm-countdown-notice",f);8==i.tradeDisableTypeEnum?r.onLoad("qrcodeUrl",function(e){e&&(t.css(c,{"clear":"both"}),t.append(t.create('\uff0c\u624b\u673a\u96f6\u70b9\u63d0\u524d\u5f00\u552e\uff0c\u626b\u7801\u62a2\u5148\u8d2d&gt;<img class="tm-countdown-qrcode" src="'+e+'&w=70&h=70"/>'),c))}):-1===location.href.indexOf("95095.")&&(13===i.tradeDisableTypeEnum?(t.append(t.create('\uff0c\u70b9\u51fb<a href="#" class="reserve">\u8bbe\u7f6e\u5f00\u62a2\u63d0\u9192</a>'),c),a.on(t.get(".reserve",c),"click",function(t){t.halt(!0),e.use(["mui/reserve-3c/index","mui/reserve-3c/index.css"],function(e,t){TShop.onLogin(function(){r.onLoad("token",function(e){new t("#J_Reserve",{"reserveId":i.remindId,"source":"pc","from":"detail","isMobile":!1}).getReserve(e)})})})})):(t.append(t.create('\uff0c\u8bf7\u5148<a href="#" class="addfav">\u6536\u85cf\u5546\u54c1</a>'),c),a.on(t.get(".addfav",c),"click",function(t){t.preventDefault(),e.use("malldetail/action/addfav",function(e,a){TShop.onLogin(function(){r.onLoad(["itemDO","token"],function(e,i){a.run({"itemId":e.itemId,"sellerId":e.userId,"categoryId":e.categoryId,"token":i,"event":t})})})})}))),e.use("malldetail/control/timer",function(e,a){new a({"leftTime":i.sellCountDown,"container":t.get(".tm-countdown-timer",f),"template":2,"tpl":"{date}"}).onStop(function(){r.set("trade.sellCountDown",0),codeTrack("trade.timer.stop","trade.timer.init")}),codeTrack("trade.timer.init","trade.action.init")})}t.hide(l),t.insertAfter(f,l),a.on(t.get(".tb-btn-addbag",f),"click",function(e){return r.buy({"type":2,"button":this,"callback":function(e){}}),!1})}});var h;r.onChange(["trade","misc","deviceType"],function(a,i,n){function o(e){if(h||(h=t.create('<div id="J_ButtonWaitWrap"></div>'),t.insertAfter(h,l)),t.html(h,e),t.show(h),"pad"==n){var a=t.get("#J_AddFavorite");t.hide(a)}}function c(){h&&t.hide(h)}var s=a&&!a.tradeEnable&&a.tradeDisableTypeEnum;if(!s)return void c();e.use("malldetail/sku/tradeArgue",function(e,t){t.init({"typeNum":s,"trade":a,"show":o,"hide":c,"product":r})})}),r.onLoad(["deviceType"],function(a){if("pc"===a){var i=null,n=!1;r.onChange("canBuyStatus",function(){r.canBuy({"type":g_config&&"chaoshi"===g_config.pageId?2:1,"level":4},function(a){0===a.level?n?i&&i.show():(n=!0,r.onLoad("memberMultiPoint",function(a){var n=TShop.getUrlParams("memberMultiPoint");if(n&&(a=n),a){var o=t.create('<div class="tm-btn-wrap"></div>');t.append(t.parent(c),o),t.append(t.parent(d),o);var l=t.get(".tb-action");t.append(o,l),t.addClass(l,"tb-action-vertical"),e.use(["malldetail/sku/memberpoint","malldetail/sku/memberpoint.css","malldetail/sku/memberpoint.tpl"],function(e,t){t.init({"memberMultiPoint":a,"product":r,"relEl":l}),i=t})}})):i&&i.hide()})})}})}}},{"requires":["dom","event","malldetail/sku/buylink","malldetail/sku/cartlink"]});KISSY.add("malldetail/sku/editEntry",function(e,t,a){return{"init":function(i){codeTrack("act.edit.init","view.metaLeft.init"),i.product.onLoad(["config","userInfo","itemDO"],function(i,n,o){var r=e.get("#J_EditItem"),l=[],c=i.detail,s=i.tag,d=i.url;if(r){if(n&&"seller"==n.loginUserType)c.canEditInItemDet&&(o.isBidden?o.isInRepository?l.push('<a href="{{url.topUploadServerBaseUrl}}/auction/publish/edit.htm?item_num_id={{itemDO.itemId}}&auto={{itemDO.isAutoConsignment}}" target="_blank">\u7f16\u8f91</a>'):o.isAutoConsignment&&"b"==o.auctionType?l.push('<a href="{{url.topUploadServerBaseUrl}}/auction/goods/auto_edit.jhtml?id={{itemDO.itemId}}&auction_id={{itemDO.itemId}}" target="_blank" {{#if !detail.isAutoccUser}} onClick="alert(\'\u60a8\u7684\u81ea\u52a8\u53d1\u552e\u6743\u9650\u5df2\u88ab\u53d6\u6d88\uff0c\u4e0d\u80fd\u7f16\u8f91\u5df2\u6709\u51fa\u4ef7\u7684\u81ea\u52a8\u53d1\u552e\u5546\u54c1\'); return false;"{{/if}}>\u7f16\u8f91</a>'):l.push('<a href="{{url.topUploadServerBaseUrl}}/auction/publish/edit.htm?item_num_id={{itemDO.itemId}}&auto={{itemDO.isAutoConsignment}}" target="_blank">\u7f16\u8f91</a>'):l.push('<a href="{{url.topUploadServerBaseUrl}}/auction/publish/edit.htm?item_num_id={{itemDO.itemId}}&auto={{itemDO.isAutoConsignment}}" target="_blank" {{#if itemDO.isAutoConsignment && itemDO.auctionType == "a" && !detail.isAutoccUser}} onClick="return confirm(\'\u60a8\u7684\u81ea\u52a8\u53d1\u552e\u6743\u9650\u5df2\u88ab\u53d6\u6d88\n\u5982\u8981\u7ee7\u7eed\u7f16\u8f91\uff0c\u5efa\u8bae\u4e8b\u5148\u5907\u4efd\u597d\u5361\u5bc6\uff0c\u5426\u5219\u5c06\u4e22\u5931\');"{{/if}}>\u7f16\u8f91</a>')),c.isShowPreClosed&&(c.goNewAuctionFlow?l.push('<a href="{{url.BIDRedirectionitemDomain}}/close_auction.htm?item_id={{itemDO.itemId}}">\u63d0\u524d\u6210\u4ea4</a>'):l.push('<a href="{{url.tradeBaseUrl}}/close_auction.htm?auction_id={{itemDO.itemId}}">\u63d0\u524d\u6210\u4ea4</a>')),e.get("#J_GoodsErrorSeller")&&t.removeClass("#J_GoodsErrorSeller","tb-hidden"),codeTrack("act.edit.seller","act.edit.init");else if(n&&"xiaoer"==n.loginUserType)e.get("#J_GoodsErrorOther")&&t.removeClass("#J_GoodsErrorOther","tb-hidden"),codeTrack("act.edit.xiaoer","act.edit.init");else{if(c.isAllowReport&&!s.isMedical||128&g_config.bizTag){var u="",m="";i.isTripUser&&(m="&FromSource=trip"),l.push('<a href="//jubao.taobao.com/index.htm?itemId={{itemDO.itemId}}&spm=a1z6q.7847058'+m+'" target="_blank">'+u+"\u4e3e\u62a5</a>"),codeTrack("act.report.guest","act.edit.init")}e.get("#J_GoodsErrorOther")&&(t.removeClass("#J_GoodsErrorOther","tb-hidden"),codeTrack("act.report.error","act.edit.init"))}l.length&&(r.innerHTML=a(l.join(" | ")).render({"url":d,"tag":s,"itemDO":o,"detail":c}))}})}}},{"requires":["dom","malldetail/common/template"]});KISSY.add("malldetail/sku/focus",function(e,t,a){return{"init":function(i){codeTrack("trade.sku.focus","trade.main.init");var n=i.el,o=i.product;o.onLoad("config",function(i){function r(){o.onLoad(["tmallShopProm","deviceType","detailPageTips"],function(a,i,o){var r=t.create('<dl class="tm-shopPromo-panel"></dl>'),l=e.clone(a),c=t.get(".tm-shopPromo-panel",n);t.append(r,n),e.use("malldetail/sku/shopPromotion",function(e,t){t.init({"data":l,"el":r,"lastPanel":c,"deviceType":i})})})}if(i&&i.detail.is0YuanBuy){var l=t.create('<dl class="tm-0yuanbuy-panel"><dt class="tb-metatit">\u4f18\u60e0</dt><dd><div class="price"><em class="tm-yen">\xa5</em> <span class="tm-price">0.00</span><em class="tm-promo-type"><s></s>\u4f59\u989d\u5b9d0\u5143\u8d2d</em></div><div class="notice">\u8d2d\u673a\u4ef7\u683c <em class="tm-yen">\xa5</em> <span class="tm-price"></span> \u9700\u6388\u6743\u51bb\u7ed3<span class="tm-price"></span>\u5143\u4f59\u989d\u5b9d\u5bf9\u5e94\u91d1\u989d\uff0c\u534f\u8bae\u671f\u6ee1\u540e\u5982\u65e0\u8fdd\u7ea6\u5168\u989d\u89e3\u9664\u51bb\u7ed3</div></dd><dl>');o.onChange("buyPrice",function(e){t.html(t.query(".tm-price",t.get(".notice",l)),e.min)});var c=t.get(".tm-price-panel",n),s=t.get(".tm-promo-panel",n);return t.insertAfter(l,c),t.hide(c),t.hide(s),void codeTrack("trade.0yuanbuy.init","trade.sku.focus")}i.isTripUser||o.onChange(["itemDO","itemPrice","currentPromotion"],function(e,i,o){if(!i.hasTmallappProm||!o||!o.extraPromPrice)return t.remove(".tm-phoneprice"),!1;var r,l,c='<div class="wraper"><span class="phoneprice">\u60f3\uffe5'+o.extraPromPrice+'\u62ff\u4e0b\uff1f</span><span class="qrtrigger">\u624b\u673a\u5929\u732b\u8d2d\u4e70\u66f4\u4fbf\u5b9c</span></div>';if(t.get(".tm-phoneprice"))t.html(t.get(".tm-phoneprice"),'<dt class="tb-metatit">&nbsp;</dt><dd>'+c+"</dd>");else{var s=t.create('<dl class="tm-phoneprice"><dt class="tb-metatit">&nbsp;</dt><dd>'+c+"</dd></dl>");t.append(s,n);var d=t.get(".qrtrigger",s);a.on(d,"mouseover mouseout",function(a){r&&clearTimeout(r),r=setTimeout(function(){"mouseover"==a.type?(l||(l=t.create('<img class="qrpic"/>'),t.append(l,d),l.src=TShop.getQrURL({"itemId":e.itemId,"mmstat":"detail_pcfocus"}),codeTrack("trade.qrcode.hover","trade.sku.focus")),t.show(l)):t.hide(l)},300)})}}),o.onLoad(["itemPrice"],function(e){if(e&&e.taojinbiForHK){var a=t.create('<dl class="tm-otherPromo-panel"><dt class="tb-metatit">\u5176\u4ed6\u4f18\u60e0</dt><dd>'+e.taojinbiForHK+"</dd></dl>");codeTrack("mod.taojinbi.init","trade.sku.focus"),t.append(a,n)}}),o.onLoad("mdskip",function(e){e&&e.defaultModel&&e.defaultModel.ctCollectionInfo&&KISSY.use("tmdetail/components/packageSale/index",function(e,t){t.init()})}),o.onLoad("itemPrice",function(e){e&&e.firstN&&!t.get(".restrict")&&t.append(t.create('<div class="restrict">'+e.firstN+"</div>"),t.get(".tm-fcs-panel"))}),o.onLoad(["campaignInfo"],function(a){if(a&&!g_config.offlineShop&&"undefined"!=typeof a.serviceType&&2!=a.serviceType){var i=t.create('<dl class="tm-campaign-panel"><dt class="tb-metatit">\u8de8\u5e97\u4f18\u60e0</dt><dd></dd></dl>');t.append(i,n),e.use("malldetail/body/campaign,malldetail/body/campaign.tpl",function(e,t){t.init({"campaignInfo":a,"el":i})})}}),o.onLoad("model",function(e){e&&e.gatewayDO&&e.gatewayDO.changeLocationGateway&&e.gatewayDO.changeLocationGateway.queryProm?o.onChange("locModel",function(e){r()}):r()});var d=t.get(".tm-promo-panel",n);d&&o.onLoad(["itemPrice","serverStartTime","currentPromotion","detailPageTips","currentWrtInfo","model"],function(a,n,r,l,c,s){if(!a)return void t.hide(d);if(a&&c&&0!=c.status)t.addClass(d,"tm-promo-panel-wrt"),t.html(d,'<dt class="tb-metatit">\u9884\u552e\u4ef7</dt><dd></dd>'),e.use("malldetail/sku/yushou",function(e,a){a.init({"wanrentuanInfo":c,"serverStartTime":n,"linkBuy":t.get("#J_LinkBuy"),"product":o})});else{t.get("dd",d)||t.html(d,'<dt class="tb-metatit">\u4fc3\u9500\u4ef7</dt><dd></dd>');var u=s.doubleEleven2014;if(u&&2==u.step||l&&2==l.showDuo11Stage){var m=l.dou11PromPriceTitle;l.onlyShowOnePrice&&(m="\u4ef7\u683c"),m&&t.html(t.get(".tb-metatit",d),m),l.onlyShowOnePrice||t.css(t.get(".tb-metatit",d),{"color":"#FF0036","fontWeight":"bold"})}r&&"tmallBrandMember"==r.promType&&t.html(d,'<dt class="tb-metatit">\u4e13\u4eab\u4ef7</dt><dd></dd>'),e.use("malldetail/sku/productPromotion",function(e,t){t.init({"el":d,"product":o,"showZhe":"temai"===g_config.pageType})})}!(i.detail&&i.detail.isHiddenNonBuyprice||g_config.hiddenNonBuyprice)||u&&l&&(2==u.step||2==l.showDuo11Stage)&&l.dou11PromPriceTitle||t.html(t.get(".tb-metatit",d),"\u4ef7\u683c")});var u=t.get(".tm-price-panel",n);if(u){o.onChange(["detailPageTips","tagPrice","itemPrice","currentPromotion","config"],function(a,i,n,r,l){return i&&a&&2==a.priceDisplayType?void t.hide(u):i&&a&&3==a.priceDisplayType&&r?void t.hide(u):r&&"jhs"==r.promType&&a&&a.onlyShowOnePrice&&"block"==t.css(d,"display")?void t.hide(u):(t.get("dd",u)||t.html(u,'<dt class="tb-metatit">\u4ef7\u683c</dt><dd>'+t.html(u)+"</dd>"),e.use("malldetail/sku/price",function(e,t){t.init({"el":u,"product":o})}),2==n.duo11Stage&&r||1==n.duo11Stage&&r?void t.hide(u):void t.show(u))});var m=t.get(".tb-metatit",d),p={};m&&(p={"style":m.getAttribute("style"),"html":m.innerHTML}),o.onChange(["detailPageTips","tagPrice","internationalComponent","itemPrice","selectedSku"],function(e,a,n,o,r){if(!(a&&a.str&&e)||0!==e.priceDisplayType&&2!=e.priceDisplayType&&3!=e.priceDisplayType||g_config&&g_config.hiddenNonBuyprice||i.detail&&i.detail.isHiddenNonBuyprice)return void t.remove(t.get(".tm-tagPrice-panel"));if(e&&e.onlyShowOnePrice)return void t.remove(t.get(".tm-tagPrice-panel"));var l=o.duo11Stage,c="\u4e13\u67dc\u4ef7";l&&l>0&&i&&i.detail&&i.detail.isHkItem&&(c=1==l?"":"\u4ef7\u683c");var s=t.get(".tm-tagPrice-panel");if(!s&&c&&(s=t.create('<dl class="tm-tagPrice-panel"><dt class="tb-metatit">'+c+"</dt><dd></dd></dl>")),codeTrack("mod.tagPrice.init","trade.sku.focus"),c){var d=i.detail.currency||"&yen;";t.get("dd",s).innerHTML=a?' <em class="tm-yen">'+d+'</em> <span class="tm-price">'+a.str+"</span>":""}a&&c&&t.insertBefore(s,u),r&&o.priceInfo&&o.priceInfo[r.skuId]&&o.priceInfo[r.skuId].onlyShowOnePrice&&m?(t.hide(s),t.attr(m,"style",""),t.html(m,"\u4ef7\u683c")):(t.show(s),t.attr(m,"style",p.style||""),t.html(m,p.html||"\u4ef7\u683c"))})}d&&u&&t.insertAfter(d,u),o.onLoad(["itemDO","userInfo"],function(e,a){if((!e||!e.isEnterprisePath)&&e&&e.showCompanyPurchase&&a&&a.companyPurchaseUser){var i=location.href.replace("/item.htm","/enterprise.htm");t.append(t.create("<dl class='tm-qicai-tips'><dd><a href='"+i+"'>\u4f60\u7684\u4f01\u4e1a\u91c7\u8d2d\u4e13\u4eab\u4ef7,\u53bb\u770b\u770b &gt;</a></dd></dl>"),"#J_DetailMeta .tm-fcs-panel")}});var f=t.get("#J_Progressive");f&&o.onLoad(["userInfo","itemDO","model","progressiveInfo"],function(a,i,n,r){r&&(n.switcherDO&&n.switcherDO.progressiveDisable?t.hide(f):e.use("malldetail/sku/progressive",function(e,t){t.init({"el":f,"product":o})}))}),o.onLoad(["internationalComponent","delivery"],function(e,i){var n=null;if(a.delegate("#J_DetailMeta","click",".j_dialogSize",function(t){t.preventDefault(),n?n.show():KISSY.use("mui/overlay/dialog",function(t,a){n=new a({"width":560,"height":441,"skin":"gray","bodyContent":"<div class='wrapDialog'><img src='"+e.sizeCartUrl+"'/><span class='dialogAfter'></span></div>","align":{"points":["cc","cc"]}}),n.render(),n.show()})}),i&&i.extraInfo&&t.insertAfter(t.create("<span>&nbsp;"+i.extraInfo+"</span>"),"#J_PostageToggleCont"),e&&e.tariff&&e.tariff.value){var o="",r=e.taxCoupon||{};r.link&&r.linkText&&r.text&&(o='<span class="deduction">('+r.text+' <a href="'+r.link+'" target="_blank">'+r.linkText+"</a>)</span>"),t.append(t.create("<dl class='tariff-rule'><dt class=\"tb-metatit\">"+e.tariff.name+"</dt><dd>"+e.tariff.value+o+"</dd></dl>"),"#J_DetailMeta .tm-fcs-panel"),t.append(t.create("<a href='#' class='c_totalRule'>\u603b\u4ef7\u89c4\u5219</a>"),".tariff-rule dd");var l=null;l?l.show():KISSY.use("malldetail/common/tip",function(e,a){var i=["\u5230\u624b\u4ef7\uff1d\u5546\u54c1\u6210\u4ea4\u4ef7\u683c+\u7a0e\u8d39+\u8fd0\u8d39","\u4e2d\u56fd\u6d77\u5173\u89c4\u5b9a\u8fdb\u53e3\u5546\u54c1\u9700\u8981\u7f34\u7eb3\u8fdb\u53e3\u7a0e\uff0c\u6bcf\u4e2a\u5546\u54c1\u56e0\u7c7b\u76ee\u4e0d\u540c\uff0c\u6709\u4e0d\u540c\u7684\u7a0e\u7387\u3002","\u8fdb\u53e3\u7a0e\uff1d\u5546\u54c1\u5b8c\u7a0e\u4ef7\u683cX\u7a0e\u7387\uff0c\u5b8c\u7a0e\u4ef7\u683c\u7531\u6d77\u5173\u6700\u7ec8\u8ba4\u5b9a"];l=new a(t.get(".c_totalRule"),i.join("<br/>"),{"triggerType":"mouse","align":{"points":["br","tr"],"offset":[1,0]},"arrow":!0,"arrowDir":"top-right"})})}}),o.onLoad(["detailPageTips"],function(e){if(e&&e.coupon&&e.coupon.logo&&e.coupon.txt&&e.coupon.linkText){var a=e.coupon,i="<div class='tm-coupon-panel'><img height='16' src='"+a.logo+"' />"+a.txt+" <a id='J_guaGuaKaPc' target='_blank'>"+a.linkText+"</a></div>";t.insertBefore(t.create(i),t.get(".tm-fcs-panel").children[0]),2==a.displayType?KISSY.use("mui/zebra-guaguaka-detail-pc/index-pc,event",function(e,t,a){var i=null;a.on("#J_guaGuaKaPc","click",function(e){e.halt(),i=new t({"dom":document.body})})}):t.attr(t.get("#J_guaGuaKaPc"),"href",a.url)}})})}}},{"requires":["dom","event","malldetail/sku/productPromotion","malldetail/sku/price"]});KISSY.add("malldetail/sku/indices",function(e,t,a,i){return{"initSellCount":function(e){var n=e.el,o=e.config,r=e.product;codeTrack("mod.sellCount.init","mod.indices.init"),r.onChange(["currentPriceInfo","sellCount","bucketId","currentWrtInfo"],function(e,a,r,l){if(!a||"number"!=typeof a.sellCount&&"number"!=typeof a.orderPersons&&!a.marketHeat||i.bucketStat(r,g_config.monthlySalesBucketTestIdArray)||l&&l.status<3)t.hide(n);else{var c=a.sellCountLabel||"\u6708\u9500\u91cf",s=o.detail.isCyclePurchase?a.orderPersons:a.sellCount;a.sellCountLabel&&(s=a.levelCount),a.marketHeat&&(c="\u6708\u9500\u70ed\u5ea6",s=a.marketHeat,s+="(\u603b\u52065)");var d=['<div class="tm-indcon">','<span class="tm-label">'+c+"</span>",'<span class="tm-count">'+s+"</span>","</div>"];n.innerHTML=d.join(""),e&&e.monthlyAvgPrice?t.addClass(n,"tm-line3"):t.removeClass(n,"tm-line3"),t.show(n),codeTrack("mod.sellCount.show","mod.sellCount.init")}}),e.onClick&&(t.addClass(n,"canClick"),a.on(n,"click",function(t){t.preventDefault(),e.onClick(),codeTrack("mod.sellCount.click","mod.sellCount.show")}))},"initReviewCount":function(e){var i=e.el,n=e.product;codeTrack("mod.reviewCount.init","mod.indices.init"),n.onChange("reviewCount",function(e){if(e&&e.gradeAvg){var a=['<div class="tm-indcon"><span class="tm-label">\u7d2f\u8ba1\u8bc4\u4ef7</span>','<span class="tm-count">'+e.rateTotal+"</span>","</div>"];i.innerHTML=a.join(""),t.addClass(i,"tm-line3"),codeTrack("info.review.level","mod.reviewCount.init")}else t.hide(i)}),e.onClick&&(t.addClass(i,"canClick"),a.on(i,"click",function(t){t.preventDefault(),e.onClick(),TShop.sendAtpanel("tmalldetail.12.1"),codeTrack("info.review.trigger","mod.reviewCount.init")}))},"initEmPoint":function(e){var a=e.el,i=(e.config,e.product);codeTrack("mod.emPoint.init","mod.indices.init"),i.onLoad(["memberRight","model","config"],function(e,n,o){var r=o.isTripUser,l=e&&!e.pricePointExt&&e.activeName?e.activeName:"",c=e&&e.time>0?e.time:parseFloat(o.valPointTimes),s=e&&e.value>0?e.value:parseFloat(o.valPointRate);i.onChange(["buyPrice","currentCycle"],function(e,i){if(e){var o=0;if(!n.switcherDO||!n.switcherDO.pointDisable){if(i)for(var d=0,u=i.priceStep.length;d<u&&(o+=Math.floor(i.priceStep[d]*i.amount*s/100),1!=i.payType);d++);else r&&(s=.5),o+=Math.floor(e.min*s);e.min!=e.max&&(o+="<span>\u8d77</span>"),c>1&&!0!==r&&(o="<span>\u9001"+c+'\u500d</span><span class="gong">\u5171</span>'+o)}var m=['<div class="tm-indcon">','<a href="//vip.tmall.com/vip/index.htm" target="_blank">','<span class="tm-label">'+(r?"\u7d2f\u79ef\u65c5\u7a0b":"\u9001\u5929\u732b\u79ef\u5206")+"</span>",'<span class="tm-count">'+o+"</span>",l?'<span class="tm-active"><em>'+l+"</em></span>":"","</a>","</div>"];t.html(a,m.join("")),codeTrack("mod.emPoint.show","mod.emPoint.init"),l?t.addClass(a,"tm-line3"):t.removeClass(a,"tm-line3")}})})},"init":function(e){codeTrack("mod.indices.init","trade.main.init");var a=this,i=e.el,n=e.config,o=e.product,r=t.get(".tm-ind-sellCount",i);!r&&e.autoFill&&(r=t.create('<li class="tm-ind-item tm-ind-sellCount"></li>'),t.append(r,i)),r&&a.initSellCount({"el":r,"config":n,"onClick":e.onSellCountClick,"product":o});var l=t.get(".tm-ind-reviewCount",i);!l&&e.autoFill&&(l=t.create('<li class="tm-ind-item tm-ind-reviewCount"></li>'),t.append(l,i)),l&&!n.itemDO.isHotItem&&a.initReviewCount({"el":l,"config":n,"onClick":e.onReviewClick,"product":o});var c=t.get(".tm-ind-emPointCount",i);!c&&e.autoFill&&(c=t.create('<li class="tm-ind-item tm-ind-emPointCount"></li>'),t.append(c,i)),c&&!n.itemDO.isHotItem&&a.initEmPoint({"el":c,"product":o,"config":n})}}},{"requires":["dom","event","malldetail/common/util"]});KISSY.add("malldetail/sku/freight",function(e,t,a,i,n){var o,r="",l=!1;return{"init":function(a){var i=a.el,c=a.product,s=t.get(".tb-postAge",i);codeTrack("mod.freight.init","view.meta.init"),c.onChange("buyerLoc",function(e){e>=81e4&&e<=820999&&TShop.sendAcAtpanel("tmalldetail.100.1")}),c.onLoad(["config","model"],function(a,s){s.switcherDO&&s.switcherDO.deliveryDisable?t.hide("#J_PostageToggleCont"):"auction"!==window.g_config.pageType&&c.onChange(["currentDelivery","delivery"],function(c,s){if(!c)return void t.addClass(i,"tb-hidden");var d="",u=[];1===(c[0]?c[0].type:c.type)&&(l||(TShop.sendAcAtpanel("tmalldetail.921921.*"),l=!0)),e.each(c,function(e){2===e.type&&TShop.sendAcAtpanel("tmalldetail.100.2"),e.name=e.name||"",e.currency=a.detail.currency||"&yen;",d+=n(e),r=s&&s.tips&&s.tips.text||"",c.length>0&&(r=r||c[0].serviceSimpleDesc||"",u=c[0].signText||r),t.removeClass(i,"tm-delivery-highLight"),e.warning?t.addClass(i,"tm-delivery-highLight"):s&&s.tips&&s.tips.icon&&(u=s.tips.link?'<a href="'+s.tips.link+'" target="_blank"><img src="'+s.tips.icon+'" class="tm-posticon"/></a>'+u:'<img src="'+s.tips.icon+'" class="tm-posticon"/>'+u)}),t.html(t.get("#J_PostageToggleCont",i),d),t.removeClass(i,"tb-hidden"),u?(o||(o=t.create('<div class="signText"></div>'),t.append(o,t.get("dd",i))),t.html(o,u),t.show(o)):o&&t.hide(o),codeTrack("mod.freight.show","mod.freight.init")})}),c.onLoad("config",function(e){if(e.isAreaSell){codeTrack("feature.deliveryHighlight.init","mod.freight.init");var a=t.get("#friInfo",s);a||(a=t.create('<div id="friInfo">\u786e\u8ba4\u6536\u8d27\u5730\uff0c\u4ee5\u786e\u4fdd\u5728\u5546\u5bb6\u9500\u552e\u533a\u57df</div>'),t.append(a,s))}}),c.onLoad("config",function(e){}),c.onChange(["delivery"],function(e){var a=t.get("#J_announcement");t.remove(a),e&&"string"==typeof e.announcement&&(a=t.create("<div class='tb-announcement' id='J_announcement'>"+e.announcement+"</div>"),t.insertAfter(a,s))});var d=t.get("#J_AddrSelectTrigger",i);d&&(c.onChange(["delivery","currentDelivery","mdskip","config","model","globalSellInfo"],function(a,n,o,r,l,c){if(a&&a.deliveryAddress){var d=t.get("#J_deliveryAdd",i);if(d||(d=t.create("<span></span>",{"class":"tb-deliveryAdd","id":"J_deliveryAdd"}),t.prepend(d,s),t.insertAfter(t.create("\u81f3"),d)),n?e.each(n,function(e){e.skuDeliveryAddress?t.text(d,e.skuDeliveryAddress):t.text(d,a.deliveryAddress)}):t.text(d,a.deliveryAddress),a&&a.transfername){t.get("#J_interRegion")||t.insertAfter(t.create("<span id='J_interRegion'>&nbsp;\u81f3&nbsp;"+a.transfername+"&nbsp;</span>"),"#J_deliveryAdd")}var u,m;if(n&&(u=n[0])&&(m=u.secondPostage)){var p=t.get(".secondPostage");p?p.innerHTML=m:t.append(t.create("<span class='secondPostage'>"+m+"</span>"),s)}var f=t.get(".shinee-sell");if(c&&c.otherSiteName){var h=c.otherSiteName;a.destination;if(f)t.html(t.get(".shinee-sell"),"<span class='shinee-font'><i class='icon'>&#xe62f;</i>\u6709\u540c\u6b3e\u53ef\u552e\u5356\u81f3"+h+"</span><span><a href='"+c.otherSiteItem+"'>\u67e5\u770b\u5546\u54c1<i class='go'>&#xe630;</i></span></a>");else{var v="<div class='shinee-sell'><span class='shinee-font'><i class='icon'>&#xe62f;</i>\u6709\u540c\u6b3e\u53ef\u552e\u5356\u81f3"+h+"</span><span><a href='"+c.otherSiteItem+"'>\u67e5\u770b\u5546\u54c1<i class='go'>&#xe630;</i></span></a></div>";t.insertBefore(t.create(v),".tm-ind-panel")}}else f&&t.remove(f);codeTrack("feature.deliveryAddress.show","mod.freight.init")}}),e.use("malldetail/sku/address",function(e,t){t.init({"el":d,"product":c})}))}}},{"requires":["dom","event","io","malldetail/sku/freight.tpl"]});KISSY.add("malldetail/sku/freight.tpl",function(){return function(e,t){var a={"escapehash":{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#x27;","/":"&#x2f;"},"escapereplace":function(e){return a.escapehash[e]},"escaping":function(e){return"string"!=typeof e?e:e.replace(/[&<>"]/gim,this.escapereplace)},"detection":function(e){return void 0===e?"":e}},i=function(e){if("undefined"!=typeof console){if(console.warn)return void console.warn(e);if(console.log)return void console.log(e)}throw e};t=t||{},t.__escapehtml=a,t.__throw=i;var e=e||{},n="";n+="";try{n+="";var o=e.name,r=e.money,l=e.postage,c=e.serviceLinkUrl,s=e.serviceLinkText,d=e.warning;e.p,e.em,e.yen,e.span,e.error,e.a;n+="<p>     ",o&&(n+="",n+=t.__escapehtml.detection(o),n+=""),n+="     ",r&&(n+='<em class="tm-yen">',n+=t.__escapehtml.detection(r),n+="</em>"),n+="     ",l&&(n+="<span ",d&&(n+=' class="tm-error"'),n+=">",n+=t.__escapehtml.detection(l),n+="</span>"),n+="     ",s&&c&&(n+=' <a href="',n+=t.__escapehtml.detection(c),n+='" target="_blank">',n+=t.__escapehtml.detection(s),n+="</a>"),n+=" </p>"}catch(u){t.__throw("Juicer Render Exception: "+u.message)}return n+=""}});KISSY.add("malldetail/sku/metaLeft",function(e,t,a,i,n,o){return{"addIcon":function(e){var a=t.get(".tb-meta-icons",".tb-gallery");a||(a=t.create('<ul class="tb-meta-icons"></ul>'),t.append(a,".tb-gallery"));var i;if(i=t.create("<li></li>",e),e.href){var n=t.create("<a></a>",{"href":e.href,"title":e.title,"target":"_blank","css":{"width":40,"height":42,"display":"block","position":"absolute","top":0,"left":0}});t.append(n,i)}t.append(i,a)},"init":function(r){codeTrack("view.metaLeft.init","view.main.init");var l=this,c=r.product,s=i.createLoader(function(a){c.onLoad(["config"],function(i){if(0!=i.detail.show9sVideo){var o=i&&i.itemDO&&i.itemDO.imgVedioPic,r=i&&i.itemDO&&i.itemDO.imgVedioUrl;o&&r&&e.use("malldetail/sku/focusVideo",function(e,i){i.init({"videoPic":o,"videoUrl":r,"onPlay":function(){n.hideZoomer()},"el":t.get(".tb-booth","#J_DetailMeta")}),a(i)})}})});n.init({"onSwitch":function(){s(function(e){e.stopVideo()},2)},"product":c}),TShop.afterWinLoad(function(){c.onLoad(["config"],function(e){if(0!=e.detail.show9sVideo){var t=e&&e.itemDO&&e.itemDO.imgVedioPic,a=e&&e.itemDO&&e.itemDO.imgVedioUrl;t&&a&&s()}})}),c.onLoad(["propertyPics"],function(a){function i(a){var i=t.get("#J_DetailMeta .tb-img");if(i){var o=t.query("li",i);e.each(o,function(e){var i=t.attr(e,"data-value"),o=i.split(":");if(a[o[0]]==o[1]){var r=t.get("a",e),l=t.css(r,"backgroundImage");if(-1!==l.indexOf("url(")){var c=l.match(/url\("?([^\)^"]*)/)[1];c=c.substring(0,c.lastIndexOf("_")),n.show(c)}return!1}})}}var o=!1;c.onChange(["selectedSkuProp","selectedSkuList"],function(t,r){if(t&&e.keys(t).length>0&&r&&e.keys(r).length>0){var l=[];for(var c in r)if(r[c].images&&r[c].images[0]){o=!0,l=r[c].images;break}if(o&&l&&l.length>0)return void(1===l.length?(a&&a["default"]&&n.changeFrom(a["default"],!0),n.show(l[0])):l.length>1&&n.changeFrom(l))}if(a&&a["default"]){var s=a["default"];e.each(t,function(e,t){var i=";"+t+":"+e+";",n=a[i];n&&(o=!0,s=n)}),s&&(s.length>1||s==a["default"])?o&&(n.changeFrom(s),o=!1):s&&1==s.length?n.show(s[0]):i(t)}else i(t)})});var d=t.get("#J_CollectCount");d&&(codeTrack("mod.collectCount.init","view.metaLeft.init"),c.onLoad(["shopDynamicRating","config"],function(e,a){if(a&&e){var i=parseInt(e["ICCP_1_"+a.itemDO.itemId],10);if(i>0&&i<1e6)return d.innerHTML="\uff08"+i+"\u4eba\u6c14\uff09",void codeTrack("mod.collectCount.show","view.metaLeft.init")}t.hide(d)})),c.onLoad(["config","detailPageTips"],function(t,a){var i=[];a&&(i=a.primaryPicIcons||i,i=e.map(i,function(e){return{"title":e.title,"tagImage":e.url,"tagLink":e.link}}));var n=t.serviceIconList||[];n=n.concat(i),e.each(n,function(t){l.addIcon({"title":t.description,"href":t.tagLink,"css":{"width":40,"height":42,"background":"url("+t.tagImage+") no-repeat","marginLeft":5,"position":"relative","top":20,"display":6==e.UA.ie?"inline":"block","zoom":1,"float":"left"}})})}),c.onLoad(["detailPageTips"],function(e){e&&e.showDou12CornerIcon&&(l.addIcon({"class":"tm-meta-iconDouble11"}),codeTrack("meta.icon.double11","view.metaLeft.init"))}),o.init({"product":c}),t.html(t.get("i","#J_AddFavorite"),"&#xe609;"),a.on("#J_AddFavorite","click",function(t){TShop.sendAtpanel("tmalldetail.13.4"),t.preventDefault(),e.use("malldetail/action/addfav",function(e,a){TShop.onLogin(function(){c.onLoad(["itemDO","token"],function(e,i){a.run({"itemId":e.itemId,"sellerId":e.userId,"categoryId":e.categoryId,"event":t,"token":i})})})})}),c.onLoad("config",function(i){var n=t.get("#J_IShare");if(i.isTwView||i.isWorldView){e.use("malldetail/action/copyLink",function(e,t){t.init()}),t.html(t.get("i",n),"&#xe60e;");var o="https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(location.href)+"&t="+encodeURIComponent(document.title);a.on(n,"click",function(t){t.preventDefault();var a=800,i=e.one(window).width();window.open(o,"newwindow","height=400,width="+a+",top=100,left="+(i-a)/2+",toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no")})}else t.html(t.get("i",n),"&#xe607;"),a.on("#J_IShare","click",function(t){t.preventDefault(),codeTrack("external.iShare.init","view.metaLeft.init"),e.use("mui/share",function(e,t){codeTrack("external.iShare.run","external.iShare.init"),new t({"style":"none","id":1,"container":"#J_IShare","type":"item","showRecTip":!1,"key":window.g_config.itemId}).popup(),TShop.sendAtpanel("tmalldetail.13.11"),codeTrack("external.iShare.runSuccess","external.iShare.run")})})})}}},{"requires":["dom","event","malldetail/common/util","malldetail/sku/thumbViewer","malldetail/sku/editEntry"]});KISSY.add("malldetail/sku/paymethods",function(e,t,a){var i,n,o,r="pay-credit-hover";return{"init":function(e){this.el=e.el,codeTrack("mod.paymethods.init","trade.main.init");var a=this;i=e.el,n=e.promiseDisable,o=e.payDisable,a._payCod(e.delivery,e.pageType),t.html(t.get("#J_Toggler",i),"&#xe62b;"),t.show(t.get("#J_Toggler",i)),a._bindEvents()},"_toggleHandler":function(e){e&&e.preventDefault(),TShop.refreshLazy(),t[t.hasClass(i,r)?"removeClass":"addClass"](i,r),t.html(t.get("#J_Toggler",i),t.hasClass(i,r)?"&#xe62c;":"&#xe62b;"),TShop.sendAtpanel("tmalldetail.4.6"),codeTrack("mod.paymethods.click","mod.paymethods.show")},"_payCod":function(l,c){if(l&&l.otherServiceList){var s=this,d=l.otherServiceList,u=[];if(n)s._hideSerPromise();else if("Miao"===c){t.text(".tm-ser .tb-metatit","\u55b5\u9c9c\u751f\u7279\u8272");var m=["\u6e90\u4ea7\u5730\u76f4\u4f9b","\u65b0\u9c9c\u5230\u5bb6","\u95ea\u7535\u8d54\u4ed8"],p="";e.each(m,function(e){p+="<li>"+e+"</li>"}),t.html(".tb-serPromise",p)}else for(var f=0,h=d.length;f<h;f++)u.push('<a href="'+d[f].url+'" target="_blank"><s style="background:url('+d[f].imgUrl+') no-repeat center center"></s>'+d[f].title+"</a>");o?s._hidePayMethod():(t.prepend(t.create(u.join("")),t.get(".J_Paylist",i)),a.on(document,"click",function(e){t.hasClass(i,r)&&!t.contains(i,e.target)&&s._toggleHandler()})),o&&n&&t.hide(".tm-ser"),codeTrack("mod.paymethods.show","mod.paymethods.init")}},"_insertSerPromise":function(e){var a=t.get(".tb-serPromise");a&&t.append(t.create(e),a)},"_hideSerPromise":function(){t.hide(".tm-pledge3c-meta"),t.hide(".tm-ser > .tm-clear")},"_hidePayMethod":function(){t.hide(".tm-pay-box")},"_bindEvents":function(){a.on("#J_Toggler","click",this._toggleHandler),a.on(t.get(".pay-title",this.el),"click",this._toggleHandler)}}},{"requires":["dom","event"]});KISSY.add("malldetail/sku/promoBanner",function(e,t){function a(t,a,i){return 6===e.UA.ie?i?t?"<style>.logoPic_"+a+'{_background-image:none;display:block;_filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true,sizingMethod=scale,src="'+t.logoUrl+'");}</style><a class="logoPic logoPic_'+a+'" target="_blank" href="'+i+'" title="'+(t.tips||"")+'"></a>':"":t?"<style>.logoPic_"+a+'{_background-image:none;_filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true,sizingMethod=scale,src="'+t.logoUrl+'");}</style><div class="logoPic logoPic_'+a+'" title="'+(t.tips||"")+'"></div>':"":i?t?'<a class="logoPic logoPic_'+a+'" target="_blank" href="'+i+'" title="'+(t.tips||"")+'"><img src="'+t.logoUrl+'" height="28"/></a>':"":t?'<div class="logoPic logoPic_'+a+'" title="'+(t.tips||"")+'"><img src="'+t.logoUrl+'" height="28"/></div>':""}function i(t){return'<div class="tm-sm-wrap"><div class="tm-sm-userGraph"><img width="52" height="52" src="'+e.substitute("//wwc.alicdn.com/avatar/getAvatar.do?userId={userId}&width=60&height=60&type=sns",{"userId":t.userId})+'" /></div>'+(-1!=t.activeStatus?'<div class="tm-sm-icon"><i class="tm-sm-iconc">&#xe61b;</i><span class="tm-sm-itext">T'+t.activeStatus+"</span></div></div>":"")}function n(e){var t,a=[];return(e=parseInt(e/1e3))<=0?a.join(""):(t=e%60,a.unshift(t+"\u79d2"),(e=(e-t)/60)<=0?a.join(""):(t=e%60,a.unshift(t+"\u5206"),(e=(e-t)/60)<=0?a.join(""):(a.pop(),t=e%24,a.unshift(t+"\u5c0f\u65f6"),(e=(e-t)/24)<=0?a.join(""):(a.pop(),a.unshift(e+"\u5929"),a.join("")))))}return{"init":function(o){codeTrack("mod.promoBanner.init","trade.main.init");var r=o.product,l=o.el;r.onChange(["config","currentPromotionList","itemPrice","currentSuggestivePromotionList","allSuggestivePromotionList","detailPageTips","misc","model","userInfo","selectedSku"],function(o,s,c,d,u,m,p,f,h,g){function v(){for(var t="",a=null,i=0,n=y.length;i<n;i++)if("jhs_warm"==y[i].promType){a=y[i],t="jhs_warm";break}return null===g&&"jhs_warm"==t&&(u=e.filter(u,function(e){return"jhs_warm"==e.promType}),u[0]&&(a=u[0]),u.length>1&&u[0].price==u[u.length-1].price&&(O=!1)),{"_promotion":a,"jhsType":t}}var b,y=[].concat(s||[]).concat(d||[]),k=e.filter(y,function(e){return"keyJhs"==e.promType||"jhs"==e.promType||"jhs_warm"==e.promType})[0],_=e.filter(y,function(e){return"tmallBigMarkDown"==e.promType})[0],w=e.filter(y,function(e){return"tmallBrandMember"==e.promType})[0],T=e.filter(y,function(e){return"awp"==e.promType})[0],S=t.get("dd",l),I=t.get("dt",l),C=f.minisiteDO&&f.minisiteDO.validMlhItem&&0===f.minisiteDO.itemStatus,x=f.minisiteDO&&f.minisiteDO.validMlhItem&&1===f.minisiteDO.itemStatus,P=f.minisiteDO&&f.minisiteDO.validMlhItem&&4===f.minisiteDO.itemStatus,D=f.doubleEleven2014;D&&D.doubleElevenItem&&D.step;var L=!(!_||1!=_.status||!m.warmingUpHintText),A=!(!_||!m.campaignText),M=function(){if(m.warmingUpHintText){return m.warmingUpHintText.replace(/\$\{(.+)\}/g,function(e,t){switch(t){case"hurriedPrice":var a=_&&"tmallBigMarkDown"==_.promType?_.price:"";return a?'<span class="tm-yen">&yen;</span><span class="tm-price">'+a+"</span>":""}return""})}return""},O=!0;switch(t.show(t.get(".tm-focus-banner")),!0){case!(!T||1!=m.crowdType&&2!=m.crowdType&&3!=m.crowdType):t.hide(I);var B=m.crowdType;t.addClass(l,"tm-sm-prom");var J="";B&&1!==B&&(t.addClass(l,"tm-sm-promHasCrown"),J=i(h));var R="",q=m.campaignText||"",E=m.campaignUrl||"",j="";q&&E&&(j='<a href="'+E+'" target="_blank">'+q+"</a>"),R=L?a(m.warmUpIcons&&m.warmUpIcons[0],0,b):a(m.icons&&m.icons[0],0,b),t.html(S,R+J+(j||q));break;case L:t.addClass(l,"green"),t.hide(I);var N=M(),U=/[,^]3394[,$]/.test(o.tagsId)?'<div class="cornerIcon ju">&#xe601;</div>':"",R=a(m.warmUpIcons&&m.warmUpIcons[0],0,b);m.double11BgIcon&&t.css(l,{"backgroundImage":"url("+m.double11BgIcon+")","backgroundSize":"100% 50px"}),t.html(S,U+R+N);break;case A:t.hide(I),t.addClass(l,"golden");var U=/[,^]3394[,$]/.test(o.tagsId)?'<div class="cornerIcon ju">&#xe601;</div>':"",R=a(m.icons&&m.icons[0],0,b);m.double11BgIcon&&t.css(l,{"backgroundImage":"url("+m.double11BgIcon+")","backgroundSize":"100% 50px"}),t.html(S,U+R+(m.campaignText||""));break;case!!m.showDou11Style:if(t.hide(I),m.double11BgIcon){m.double11BgIcon;t.css(l,{"backgroundImage":"url("+m.double11BgIcon+")","backgroundSize":"100% 50px"})}var U=/[,^]3394[,$]/.test(o.tagsId)?'<div class="cornerIcon ju">&#xe601;</div>':"",N=M()||m.campaignText,R=a(m.warmUpIcons&&m.warmUpIcons[0],0,b)||a(m.icons&&m.icons[0],0,b);t.html(S,U+R+N);break;case!(!k||1!=k.status):t.addClass(l,"green-ju"),t.addClass(l,"normalJhs"),t.attr(S,{"data-spm":"1998059570"});var F=v(),z=O&&!g?"\u8d77":"\u5143";if(F._promotion){_promotion=F._promotion;var H=new Date(k.startTime),V=H.getMonth()+1;1==(V+"").length&&(V="0"+V);var K=H.getDate();1==(K+"").length&&(K="0"+K);var Y=H.getHours();1==(Y+"").length&&(Y="0"+Y);var W=H.getMinutes();1==(W+"").length&&(W="0"+W),t.html(S,'<div class="logoIcon">&#xe600;</div>\u6b64\u5546\u54c1 <strong>'+V+"\u6708"+K+"\u65e5 "+Y+":"+W+"</strong>\u53c2\u52a0\u805a\u5212\u7b97  \u805a\u5212\u7b97\u4ef7\uff1a<strong>"+_promotion.price+"</strong>"+z+' <a class="linkJu" href="#">&#xe61a;</a>')}else t.html(S,'<div class="logoIcon">&#xe600;</div>\u6b64\u5546\u54c1\u5373\u5c06\u53c2\u52a0\u805a\u5212\u7b97\uff0c'+(k.startTime?"<strong>"+n(k.startTime-p.systemTime)+"</strong>\u540e\u5f00\u59cb\uff0c":"")+'<a class="linkJu" href="#">\u53bb\u8bbe\u7f6e\u63d0\u9192</a>\uff01');r.onLoad("trade",function(a){t.attr(t.get(".linkJu",S),"href",o.url.tgDetailDomain+"/home.htm?item_id="+o.itemDO.itemId+"&"+(a&&a.param&&e.param(a.param)||""))}),k.startTime&&"jhs_warm"!=F.jhsType&&e.use("malldetail/control/timer",function(e,a){new a({"leftTime":(k.startTime-p.systemTime)/1e3,"container":t.get("strong",S),"tpl":"{date}"}).onStop(function(){location.reload()})});break;case!!k:t.addClass(l,"red"),t.addClass(l,"normalJhs"),t.html(S,'<div class="logoIcon">&#xe600;</div>\u6b64\u5546\u54c1\u6b63\u5728\u53c2\u52a0\u805a\u5212\u7b97\uff0c'+(k.endTime?"<strong>"+n(k.endTime-p.systemTime)+"</strong>\u540e\u7ed3\u675f\uff0c":"")+"\u8bf7\u5c3d\u5feb\u8d2d\u4e70\uff01"),k.endTime&&e.use("malldetail/control/timer",function(e,a){new a({"leftTime":(k.endTime-p.systemTime)/1e3,"container":t.get("strong",S),"tpl":"{date}"}).onStop(function(){location.reload()})});break;case!!w:if(w.promText&&/\u767b\u5f55/.test(w.promText))t.hide(l);else{t.addClass(l,"red"),t.html(S,'<span class="tm-brandtitle">\u54c1\u724c\u4e13\u4eab\u7279\u6743</span>\u6b63\u5728\u53c2\u52a0\u54c1\u724c\u56de\u9988\u6d3b\u52a8\uff0c\u5e2e\u60a8\u7acb\u7701<span class="tm-viponly-price"></span>\u5143\uff0c\u8bf7\u5c3d\u5feb\u8d2d\u4e70');var X=t.get(".tm-viponly-price");r.onChange(["selectedSkuProp","currentPromotion","currentPriceInfo"],function(e,t,a){X&&"tmallBrandMember"==t.promType&&(X.innerHTML=parseInt(a.price)-parseInt(t.price))})}break;case m.showDou11Style:t.hide(I),t.addClass(l,"golden");var U=/[,^]3394[,$]/.test(o.tagsId)?'<div class="cornerIcon ju">&#xe601;</div>':"",R=a(m.icons&&m.icons[0],0,b);t.html(S,U+R+(m.campaignText||""));break;case!!C:t.addClass(l,"black"),t.addClass(l,"normalJhs"),t.html(S,'<div class="logoIcon">&#xe633;</div>\u8ddd\u62a2\u8d2d\u5f00\u59cb\u8fd8\u5269: '+(f.minisiteDO.startTime?"<strong>"+n(f.minisiteDO.startTime-p.systemTime)+"</strong>":"")),f.minisiteDO.startTime&&e.use("malldetail/control/timer",function(e,a){new a({"leftTime":(f.minisiteDO.startTime-p.systemTime)/1e3,"container":t.get("strong",S),"tpl":"{date}"}).onStop(function(){location.reload()})});break;case!!x:t.addClass(l,"black"),t.addClass(l,"normalJhs"),t.html(S,'<div class="logoIcon">&#xe633;</div>\u8ddd\u62a2\u8d2d\u7ed3\u675f\u8fd8\u5269: '+(f.minisiteDO.endTime?"<strong>"+n(f.minisiteDO.endTime-p.systemTime)+"</strong>":"")),f.minisiteDO.endTime&&e.use("malldetail/control/timer",function(e,a){new a({"leftTime":(f.minisiteDO.endTime-p.systemTime)/1e3,"container":t.get("strong",S),"tpl":"{date}"}).onStop(function(){location.reload()})});break;case!!P:t.addClass(l,"black"),t.addClass(l,"normalJhs"),t.html(S,'<div class="logoIcon">&#xe633;</div>\u62a2\u8d2d\u5df2\u7ed3\u675f');break;default:t.hide(l)}b&&t.wrap(t.get("img",S),t.create('<a class="logoLink" target="_blank" href="'+b+'"></a>'))})}}},{"requires":["dom"]});KISSY.add("malldetail/sku/price",function(e,t){return{"init":function(a){codeTrack("mod.price.init","trade.sku.focus");var i=a.el,n=a.product,o=!0,r=t.query(".tm-price-item",i);""===e.trim(t.html(t.get(".tm-price",i)))&&n.onChange("config",function(e){t.remove(r);var a=e.detail.currency||"&yen;";t.html(t.get("dd",i),'<em class="tm-yen">'+a+'</em> <span class="tm-price">'+(e.detail.defaultItemPrice||"")+"</span>"),t.append(r,t.get("dd",i))}),n.onChange(["config","misc","detailPageTips","tagPrice","originalPrice","buyPrice","currentPromotion","3rdExtraInfo","trade","interPrice","internationalComponent","interTagPrice","interOrignPrice","model","itemPrice","suggestivePromotionPrice","selectedSku","priceInfo"],function(a,l,c,s,d,u,m,p,f,h,g,v,b,y,k,_,w,T){var S=a.detail.currency||"&yen;";if(14===f.tradeDisableTypeEnum&&!t.get("#J_CarMarketTip")){var I=t.get(".tb-metatit",i);if(t.addClass(i,"tm-recommend-price"),a.detail.isOnePriceCar)t.html(I,"\u4e00\u53e3\u4ef7");else if(a.detail&&a.detail.isZhengChe);else{t.html(I,"\u5b98\u65b9\u6307\u5bfc\u4ef7");var C=t.create('<dl id="J_CarMarketTip" style="color: #999;margin: 0 0 0 10px;">\u6ce8\uff1a\u5b9e\u9645\u6210\u4ea4\u4ef7\u8bf7\u548c 4S \u5e97\u8c08\u59a5\uff0c\u4e0d\u5f71\u54cd\u989d\u5ea6</dl>');t.insertAfter(C,i)}}c=c||{};var x=!(m&&(!m.limitTime||!1!==m.start))||a.emPointsBuy,D=m&&m.promText;t.remove(r);var P=p&&p.price;t.html(t.get("dd",i),'<em class="tm-yen">'+S+'</em> <span class="tm-price">'+(P||(s&&1==c.priceDisplayType?s.str:d.str))+"</span>"),t.append(r,t.get("dd",i)),t.removeClass(i,"tm-price-cur"),t.removeClass(i,"tm-price-uncertain"),x?(t.addClass(i,D?"tm-price-uncertain":"tm-price-cur"),(g_config&&g_config.hiddenNonBuyprice||a.detail&&a.detail.isHiddenNonBuyprice)&&t.show(i),D||!a.isTwView&&!a.isWorldView||e.use("malldetail/sku/priceExtra",function(e,t){t.render({"product":n,"el":i})})):(T.hiddenNonBuyPrice||g_config&&g_config.hiddenNonBuyprice||a.detail&&a.detail.isHiddenNonBuyprice)&&t.hide(i);var L;if(!m&&(L=t.get("#J_PromoHintText"))){var A=t.create('<div class="staticPromoTip">');t.html(A,L.innerHTML);var M,O;(M=t.get(".J_Track",A))&&M.value&&TShop.sendAcAtpanel(M.value),(O=t.get(".J_Spm",A))&&t.attr(A,"data-spm",O.value),t.append(A,t.get("dd",i))}o&&(o=!1,codeTrack("mod.price.show","mod.price.init"));var B=null,J=null;if(g&&h&&g.foreignPriceName&&h.interTagPrice){var R=h.interOrignPrice;v&&(B=v.str),b&&(J=b.str),!B&&h.interTagPrice&&(B=h.interTagPrice.str),!J&&R&&(J=R.str||R.value);var q=t.get("#J_hkinterOriginPrice");R&&(q?q.innerHTML='<dt class="tb-metatit">'+R.name+'</dt><dd><em class="tm-yen">'+g.foreignPriceUnitSymbol+'</em><span class="tm-price">'+J+"</span></dd>":t.insertBefore(t.create('<dl class="tm-price-panel" id="J_hkinterOriginPrice"><dt class="tb-metatit">'+R.name+'</dt><dd><em class="tm-yen">'+g.foreignPriceUnitSymbol+'</em><span class="tm-price">'+J+"</span></dd></dl>"),"#J_StrPriceModBox"))}var E=t.get("#J_hkInterTagPrice");if(E&&B&&(E.innerHTML="&nbsp;&nbsp;"+g.foreignPriceName+"&nbsp;"+g.foreignPriceUnitSymbol+B),!E&&B&&(m?(t.insertAfter(t.create("<span id='J_hkInterTagPrice'>&nbsp;&nbsp;"+g.foreignPriceName+"&nbsp;"+g.foreignPriceUnitSymbol+B+"</span>"),"#J_PromoPrice .tm-price"),t.remove(".tm-promo-type")):t.insertAfter(t.create("<span id='J_hkInterTagPrice'>&nbsp;&nbsp;"+g.foreignPriceName+"&nbsp;"+g.foreignPriceUnitSymbol+B+"</span>"),"#J_StrPriceModBox .tm-price")),k&&1==k.duo11Stage&&c.showDou11SugPromPrice&&_&&_.str){var j=t.get("#J_PromoPrice"),N=c.dou11PromPriceTitle,U='<dt class="tb-metatit">'+N+'</dt><dd> <em class="tm-yen">'+S+'</em> <span class="tm-price">'+_.str+"</span></dd>",F=t.get(".tm-fcs-panel .tm-happy11-panel");F?t.html(F,U):t.after(t.create("<dl class='tm-happy11-panel'>"+U+"</dl>"),j)}else t.remove(t.get(".tm-happy11-panel"));w&&w.skuId&&y&&y.detailPageTipsDO&&y.detailPageTipsDO.skuSubscriptionMap&&y.detailPageTipsDO.skuSubscriptionMap[w.skuId]&&t.insertAfter(t.create('<em id="J_depositTip" class="depositTip">\u8ba2\u91d1\u53ef\u62b5\u7528<em class="tm-yen">'+S+"</em>"+y.detailPageTipsDO.skuSubscriptionMap[w.skuId]+"\u5143,\u5728\u95e8\u5e97\u786e\u8ba4\u5c3e\u6b3e\u540e\u53ef\u5206"+y.detailPageTipsDO.stage+"\u671f\u652f\u4ed8</em>"),"#J_StrPriceModBox .tm-price");var z=t.get("dd",i);if(z&&y&&y.extras&&y.extras.pricedCoupon){var H=y.extras.pricedCoupon;H.entranceLink&&H.entranceText&&(t.css(z,"position","relative"),t.append(t.create('<a href="'+H.entranceLink+'" target="_blank" style="text-decoration: underline;color: #666;font-size: 12px;line-height: 18px;position: absolute; top: 8px; cursor: pointer;right: 8px;">'+H.entranceText+"</a>"),z))}})}}},{"requires":["dom","event"]});KISSY.add("malldetail/sku/productPromotion",function(e,t,a,i){function n(n){codeTrack("mod.promoPrice.init","trade.sku.focus");var o,r=n.el,l=n.product;l.onChange(["currentPromotion","currentPriceInfo","currentSuggestivePromotion","originalPrice","buyPrice","promoPrice","detailPageTips","config","model"],function(c,s,d,u,m,p,f,h,g){if(!c)return void t.hide(r);t.show(r),c&&"jhs"==c.promType&&f&&f.onlyShowOnePrice&&t.html(t.get(".tb-metatit",r),"\u4ef7\u683c");var v="";if(n.showZhe&&m){var b=100*Number(m.min),y=100*Number(m.max),k=100*Number(u.min),_=100*Number(u.max),w=[Math.floor(100*b/k)/10],T=Math.floor(100*y/_)/10;w[0]!=T&&w.push(T),v=w.sort().join("-"),"10"==v&&(v="")}var S=!f||f&&!f.hideIcons,I=!1,C=!1;if("tmallBrandMember"==c.promType)if(c.promText&&/\u767b\u5f55/.test(c.promText)){c.promText=c.promText.replace("\u767b\u5f55",'<a class="J_loginCheckProm">\u767b\u5f55</a>');var x="\u4e13\u4eab";try{x='<em class="tm-promo-type tm-promo-type-red"><s></s><i class="tm-small-heart">&#xe60f;</i>'+c.promText.match(/\{(.+)\}/)[1]+"</em>"}catch(L){}c.promText=c.promText.replace(/\{.+\}/,x),S=!1,C=!1}else I=!0,C=!0;var P=h.detail.currency;t.html(t.get("dd",r),i({"currentPromotion":c,"zheStr":v,"buyPrice":m,"originalPrice":u,"promoPrice":p,"showIcon":S,"showHeartIcon":I,"redBackground":C,"priceIcons":f.priceIcons,"currency":P||"\xa5","isMeilihui":g&&g.minisiteDO&&g.minisiteDO.validMlhItem,"priceOff":g&&g.minisiteDO&&g.minisiteDO.priceOff||0})),m!=u||c&&c.promText?(t.addClass(r,"tm-promo-cur"),(h.isTwView||h.isWorldView)&&e.use("malldetail/sku/priceExtra",function(e,t){t.render({"product":l,"el":r})})):t.removeClass(r,"tm-promo-cur"),c.limitTimeUTC&&e.use(["malldetail/control/timer"],function(e,a){l.onServerTime(function(e){o&&o.clear();var i=(parseInt(c.limitTimeUTC,10)-e)/1e3;o=new a({"leftTime":i,"container":t.get(".limitTime",r),"tpl":"\u8be5\u4fc3\u9500{date}\u540e\u7ed3\u675f"}).onStop(function(){window.location.reload()}),codeTrack("mod.promoPrice.timer","mod.promoPrice.init")})});var D=t.get(".J_loginCheckProm");t.css(D,{"cursor":"pointer"}),D&&a.on(D,"click",function(e){e.halt(!0),TShop.onLogin(function(){window.location.reload()})})})}return{"init":n}},{"requires":["dom","event","malldetail/sku/productPromotion.tpl"]});KISSY.add("malldetail/sku/productPromotion.tpl",function(){return function(e,t){var a={"escapehash":{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#x27;","/":"&#x2f;"},"escapereplace":function(e){return a.escapehash[e]},"escaping":function(e){return"string"!=typeof e?e:e.replace(/[&<>"]/gim,this.escapereplace)},"detection":function(e){return void 0===e?"":e}},i=function(e){if("undefined"!=typeof console){if(console.warn)return void console.warn(e);if(console.log)return void console.log(e)}throw e};t=t||{},t.__escapehtml=a,t.__throw=i;var e=e||{},n="";n+="";try{n+="";var o=e.priceIcons,r=e.currency,l=e.promoPrice,c=e.currentPromotion,s=(e.item,e.priceOff),d=e.zheStr,u=e.buyPrice,m=e.showIcon,p=e.isMeilihui,f=e.redBackground,h=e.showHeartIcon,v=(e.div,e.promo,e.price,e.originalPrice);e.em,e.yen,e.span,e.a,e.index,e.img,e.type,e.s,e.OFF,e.red,e.i,e.small,e.heart,e.nbsp,e.pointAdd,e.zhe,e.p,e.strong;n+='<div class="tm-promo-price">     ',u==v&&l==v||(n+='         <em class="tm-yen">',n+=t.__escapehtml.detection(r),n+='</em> <span class="tm-price">',n+=t.__escapehtml.detection(l.str),n+="</span>     "),n+="     ",c.promText&&(n+="         ","\u767b\u5f55\u540e\u786e\u8ba4\u662f\u5426\u4eab\u6709\u6b64\u4f18\u60e0"==c.promText?n+='             <a class="J_loginCheckProm">\u767b\u5f55</a>\u540e\u786e\u8ba4\u662f\u5426\u4eab\u6709\u6b64\u4f18\u60e0         ':(n+="             ",n+=t.__escapehtml.detection(c.promText),n+="         "),n+="     "),n+="  ",m&&(n+="         ",o&&o.length>0?(n+="             ",function(){for(var e in o)if(o.hasOwnProperty(e)){var a=o[e];n+='                 <img src="',n+=t.__escapehtml.escaping(t.__escapehtml.detection(a.logoUrl)),n+='" height="16" />             '}}(),n+="         "):(n+="             ",p?(n+="                 ",s>0&&(n+='                 <em class="tm-promo-type"><s></s>',n+=t.__escapehtml.escaping(t.__escapehtml.detection(s)),n+="%OFF</em>                 "),n+="             "):c.type&&(c.promText||-1==u.str.indexOf("-"))&&(n+='             <em class="tm-promo-type ',f&&(n+="tm-promo-type-red"),n+='"><s></s>',h&&(n+='<i class="tm-small-heart">&#xe60f;</i>'),n+="",n+=t.__escapehtml.detection(c.type),n+="</em>             "),n+="         "),n+="         &nbsp;&nbsp;         ",c.add&&(n+='<span class="tm-pointAdd">',n+=t.__escapehtml.detection(c.add),n+="</span>"),n+="         ",c.gift&&(n+="",n+=t.__escapehtml.detection(c.gift),n+=""),n+="         ",d&&(n+='<span class="tm-zhe">',n+=t.__escapehtml.detection(d),n+="\u6298</span>"),n+="     "),n+=" </div> <p> ",(c.limitTime||c.limitTimeUTC)&&(n+='     <span class="limitTime">',c.limitTime&&(n+="",n+=t.__escapehtml.detection(c.limitTime),n+=""),n+="</span> "),n+=" ",(c.amountRestriction||c.orderAmountRestriction)&&"keyJhs"!=c.promType&&"jhs"!=c.promType&&"wrt"!=c.promType&&(n+='     <span class="amountRestriction">         ',c.amountRestriction&&(n+="\u6b64\u4f18\u60e0\u9650<strong>",n+=t.__escapehtml.detection(c.amountRestriction),n+="</strong>\u4ef6\uff0c\u8d85\u51fa\u5219\u8be5\u5546\u54c1\u5168\u90e8\u6062\u590d\u975e\u6d3b\u52a8\u4ef7"),n+="         ",c.orderAmountRestriction&&(n+="\u6bcf\u5355\u9650\u8d2d<strong>",n+=t.__escapehtml.detection(c.orderAmountRestriction),n+="</strong>\u4ef6"),n+="     </span> "),n+=" </p>"}catch(g){t.__throw("Juicer Render Exception: "+g.message)}return n+=""}});KISSY.add("malldetail/sku/shopPromotion",function(e,t,a,i){function n(e){if(!e)return"";e="object"!=typeof e?new Date(parseInt(e,10)):e;var t=(e.getMonth()+1).toString(),a=e.getDate().toString(),i=e.getHours()+"",n=e.getMinutes()+"",o=e.getSeconds()+"";return t=1==t.length?"0"+t:t,a=1==a.length?"0"+a:a,i=1==i.length?"0"+i:i,n=1==n.length?"0"+n:n,o=1==o.length?"0"+o:o,e.getFullYear()+"-"+t+"-"+a+" "+i+":"+n+":"+o}var o,r,l,s,c,d,u,m,p={"boxOpen":!1,"elsUnfold":-1};return{"init":function(e){var a=this;r=e.data,o=e.el,u=e.lastPanel,d=e.deviceType,t.remove(u),r&&r.length&&(l="\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d\u5341",codeTrack("focus.shopPromotion.show","trade.sku.focus"),a.render())},"render":function(){var e=this,a="";c=new Array(r.length),s=new Array(r.length);for(var u=0,p=0;p<r.length;p++)if(r[p]){var f="";"88Card"==r[p].bizType&&(u++,f="card-promotion"),1==r.length?(r[p].promotionIndex="",r[p].actTitle?r[p].stitle=r[p].actTitle:r[p].stitle="\u672c\u5e97\u6d3b\u52a8"):r[p].actTitle?(r[p].stitle=r[p].actTitle,r[p].promotionIndex=""):(r[p].stitle="\u6d3b\u52a8",r[p].promotionIndex=l.charAt(p-u));var h="tm-gold";r[p].houseHoldFor618&&(h="tm-3c-blue");var g="",v='<a class="more">\u66f4\u591a'+("pad"==d?"":"\u4f18\u60e0")+"<s>&#xe62b;</s></a>";r[p].isFree&&(g=r[p].title,v="",r[p].campaignUrl&&r[p].linkText&&(v='<a class="more" target="_blank" href="'+r[p].campaignUrl+'">'+r[p].linkText+"<s>&#xe61a;</s></a>"));var b=t.create('<div class="tm-shopPromotion-title '+h+" "+f+'"><dt class="tb-metatit">'+r[p].stitle+r[p].promotionIndex+"</dt><dd>"+g+"</dd>"+v+"</div>");t.append(b,o),r[p].startTime=n(r[p].startTime),r[p].endTime=n(r[p].endTime);for(var y="",k=0,_=r[p].promPlan.detailMsg.length;k<_;k++){var T=r[p].promPlan.detailMsg[k];T&&T.method&&T.method.logistics&&T.method.logistics.selected&&!y&&T.method.logistics.exclusionName&&T.method.logistics.exclusionName.length&&(y=T.method.logistics.exclusionName.join(";"))}r[p].info=y,r[p].host="detail.tmall.com",r[p]&&r[p].campaignUrl&&~r[p].campaignUrl.indexOf("id=-1_")&&(r[p].campaignUrl=""),a+=i(r[p])}t.append(t.create('<div class="tm-floater-Box  hidden"></div>',{"html":a}),o),s=t.query(".tm-shopPromotion-title",o),c=t.query(".floater",o),m=t.get(".tm-floater-Box",o),function(e){for(var e=e||20,a=function(t){return t=t.replace(/\s/g,""),t.length<=e?t:t.substring(0,e)+"\u2026"},i=0;i<r.length;i++)if(r[i]&&!r[i].isFree){var n=t.query(".noCoupon",c[i]);n.length<2&&n.length>0?t.html(t.get("dd",s[i]),a(t.text(t.get("p",n[0])))):t.html(t.get("dd",s[i]),a(t.text(t.get("p",n[0]))+"\uff1b"+t.text(t.get("p",n[1]))))}}(30),e.bindEvent()},"bindEvent":function(i){function n(i,n){if(p.boxOpen){c[n]&&t.toggleClass(c[n],"fold");var o=e.filter(t.query(".floater",m),function(e){return!t.hasClass(e,"fold")&&!t.equals(e,c[n])});if(o.length>0)for(var r=0;r<o.length;r++)t.addClass(o[r],"fold");else m&&t.toggleClass(m,"hidden"),setTimeout(function(){a.remove(document,"click",l),p.boxOpen=!1},1)}else m&&t.toggleClass(m,"hidden"),c[n]&&t.toggleClass(c[n],"fold"),setTimeout(function(){a.on(document,"click",l),p.boxOpen=!0},1)}for(var l=function(e){if(!e||e.target!=m&&!t.contains(m,e.target)){t.addClass(m,"hidden");for(var i=0;i<c.length;i++)t.addClass(c[i],"fold");p.boxOpen=!1,a.remove(document,"click",l)}},d=0;d<r.length;d++)r[d]&&(r[d].isFree||(a.on(s[d],"click",function(e){n(undefined,this.index),e.preventDefault()},{"index":d}),a.delegate(c[d],"click",".hd",function(e){n(undefined,this.index),e.preventDefault()},{"index":d})));a.delegate(o,"mouseenter mouseleave",".tm-gf-item",function(e){"mouseenter"==e.type?t.addClass(t.parent(e.target,"li"),".focus"):t.removeClass(t.parent(e.target,"li"),".focus")})}}},{"requires":["dom","event","malldetail/sku/shopPromotion.tpl"]});KISSY.add("malldetail/sku/shopPromotion.tpl",function(){return function(e,t){var a={"escapehash":{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#x27;","/":"&#x2f;"},"escapereplace":function(e){return a.escapehash[e]},"escaping":function(e){return"string"!=typeof e?e:e.replace(/[&<>"]/gim,this.escapereplace)},"detection":function(e){return void 0===e?"":e}},i=function(e){if("undefined"!=typeof console){if(console.warn)return void console.warn(e);if(console.log)return void console.log(e)}throw e};t=t||{},t.__escapehtml=a,t.__throw=i;var e=e||{},n="";n+="";try{n+="";var o=e.promPlan,r=(e.plan,e.stitle),l=e.promotionIndex,c=e.campaignName,s=e.startTime,d=e.endTime,u=(e.index,e.host),m=(e.item,e.info),p=e.campaignUrl,f=e.bizType,h=e.isFree,v=e.warmUp,g=e.houseHoldFor618;e.div,e.em,e.promotion,e.a,e.s,e.ul,e.li,e.p,e.music,e.market,e.vippacks,e.id,e.gflist,e.gf,e.img,e.pic,e.span,e.title;n+='<div class="floater fold">     <div class="hd">         <em class ="title ',"88Card"==f&&(n+="card-promotion"),n+='">',n+=t.__escapehtml.detection(r),n+="",n+=t.__escapehtml.detection(l),n+="</em>         ",n+=t.__escapehtml.detection(c),n+="         ",h||(n+="         ",v?(n+="             \u4ece",n+=t.__escapehtml.detection(s),n+="\u5f00\u59cb         "):(n+="             \u5230",n+=t.__escapehtml.detection(d),n+="\u7ed3\u675f         "),n+='         <a class="more unmore">\u6536\u8d77<s>&#xe62c;</s></a>         <a class="more">\u66f4\u591a\u4f18\u60e0<s>&#xe62b;</s></a>         '),n+='     </div>     <ul class="bd">         ',function(){for(var e in o.detailMsg)if(o.detailMsg.hasOwnProperty(e)){var a=o.detailMsg[e],i=e;n+='         <li class="',a.method.coupon||(n+="noCoupon"),n+='" data-index="',n+=t.__escapehtml.detection(i),n+='">             <p>                 ',3==o.unit?(n+="",n+=t.__escapehtml.detection(a.method.selfDefined),n+=""):(n+="                     ",g&&(n+="\u73b0\u5728\u4e0b\u5355"),n+="\u6ee1<em>",n+=t.__escapehtml.detection(a.method.man),n+="</em>",1==o.unit?n+="\u4ef6":2==o.unit&&(n+="\u5143"),n+="                     ",g&&a.method.discount&&a.method.discount.selected&&(n+="                     \uff0c\u5929\u732b\u5e2e\u4f60"),n+="",a.method.discount&&a.method.discount.selected&&(n+="",2==o.unit&&(n+="\u51cf"),n+="",3==o.unit&&(n+="\u51cf"),n+="<em>",n+=t.__escapehtml.detection(a.method.discount.quota),n+="</em>",1==o.unit?n+="\u6298":2==o.unit&&(n+="\u5143"),n+=""),n+="                     ",a.method&&a.method.benefitStr&&(n+="                         ,",n+=t.__escapehtml.detection(a.method.benefitStr),n+="                     "),n+="                     ",a.infinite&&i==o.detailMsg.length-1&&(n+="                         ,\u4e0a\u4e0d\u5c01\u9876                     "),n+="                     ",a.method.logistics&&a.method.logistics.selected&&(n+="                         ,\u5305\u90ae                     "),n+="                     ",a.method.musicPack&&a.method.musicPack.selected&&(n+="                         ,\u9001<a href='//music.taobao.com/market/music/vippacks.php?id=",n+=t.__escapehtml.detection(a.method.musicPack.packId),n+="' target='_blank'>",n+=t.__escapehtml.detection(a.method.musicPack.packName),n+="</a>                     "),n+="                     ",a.method.shopCoupon&&a.method.shopCoupon.selected&&(n+="                         ,\u9001",n+=t.__escapehtml.detection(a.method.shopCoupon.price),n+="\u5143\u5e97\u94fa\u4f18\u60e0\u5238                     "),n+="                     ",a.method.selectFlowWallet&&a.method.flowWallet.selected&&(n+="                         ,\u9001",n+=t.__escapehtml.detection(a.method.flowWallet.flow),n+="M\u6d41\u91cf                     "),n+="                     ",a.method.gift&&a.method.gift.selected&&(n+='                         ,\u8d60:<a href="//',n+=t.__escapehtml.detection(u),n+="/item.htm?id=",n+=t.__escapehtml.detection(a.method.gift.id),n+='" target="_blank">                             ',a.method.gift.nameEscape?(n+="",n+=t.__escapehtml.detection(a.method.gift.nameEscape),n+=""):(n+="",n+=t.__escapehtml.detection(a.method.gift.name),n+=""),n+="                         </a>                     "),n+="                     ",a.method.ebook&&a.method.ebook.selected&&(n+='                         ,\u9001\u7535\u5b50\u4e66:\u300a<a href="//',n+=t.__escapehtml.detection(u),n+="/item.htm?id=",n+=t.__escapehtml.detection(a.method.ebook.ebookId),n+='" target="_blank" title="',n+=t.__escapehtml.detection(a.method.ebook.ebookName),n+='">',n+=t.__escapehtml.detection(a.method.ebook.ebookName),n+="</a>\u300b                     "),n+="                     ",a.method.giftPool&&a.method.giftPool.selected&&(n+="                         ,\u9001\u4efb\u610f",n+=t.__escapehtml.detection(a.method.giftPool.selectNum),n+="\u4ef6\u8d60\u54c1\uff08\u8d60\u5b8c\u5373\u6b62\uff09                     "),n+="                     ",a.method.telCharge&&a.method.telCharge.selected&&(n+="                         ,\u9001",n+=t.__escapehtml.detection(a.method.telCharge.count),n+="\u5143\u6dd8\u8bdd\u8d39                     "),n+="                 "),n+="             </p>             ",a.method.giftPool&&a.method.giftPool.selected&&a.method.giftPool.giftList&&a.method.giftPool.giftList.length&&(n+='             <ul class="tm-gflist">                 ',function(){for(var e in a.method.giftPool.giftList)if(a.method.giftPool.giftList.hasOwnProperty(e)){var i=a.method.giftPool.giftList[e];n+='                 <li>                     <a class="tm-gf-item" target="_blank" href="//',n+=t.__escapehtml.detection(u),n+="/item.htm?id=",n+=t.__escapehtml.detection(i.id),n+='">                         <img class="tm-gf-pic" src="',n+=t.__escapehtml.detection(i.picUrl),n+='_60x60.jpg" alt="',n+=t.__escapehtml.detection(i.name),n+='"/>                         <span class="tm-gf-title">',n+=t.__escapehtml.detection(i.name),n+="</span>                     </a>                 </li>                 "}}(),n+="             </ul>             "),n+="         </li>         "}}(),n+='     </ul>     <div class="ft">         ',m&&(n+='<span class="title">\u4e0d\u5305\u90ae\u5730\u533a\uff1a</span>',n+=t.__escapehtml.detection(m),n+=""),n+="         ",p&&(n+='<a class="all" target="_blank" href="',n+=t.__escapehtml.detection(p),n+='">\u6240\u6709\u6d3b\u52a8\u5546\u54c1</a>'),n+="     </div> </div>"}catch(b){t.__throw("Juicer Render Exception: "+b.message)}return n+=""}});KISSY.add("malldetail/sku/meta",function(e,t){return{"init":function(a){codeTrack("view.meta.init","trade.main.init");var i=(a.el,a.product),n=t.get("#J_RSPostageCont");n&&i.onLoad(["isDownShelf","config","itemDO","model"],function(a,o,r,l){if(a)return void t.remove(n);t.get("dd",n)||t.html(n,'<dt class="tb-metatit">\u8fd0\u8d39</dt><dd>'+t.html(n)+"</dd>"),o.isTwView?e.use("malldetail/sku/freightTw",function(e,t){t.init(i)}):e.use("malldetail/sku/freight",function(e,t){t.init({"el":n,"product":i})})})}}},{"requires":["dom"]});KISSY.add("malldetail/sku/propertyHandler",function(e,t,a){var i,n=(e.UA,document),o=window,r=(o.g_config,function(i,o){var r=t.query("li",o),l=t.attr(r,"data-value").split(":")[0];t.query("span",o);n.createElement("i").appendChild(n.createTextNode("\u5df2\u9009\u4e2d")),i.onLoad(["config","skuProp","userInfo"],function(a,n,o){function s(e){if(!o||!o.nicker||!a.isShowSizeRecommend)return e(null);i.onLoad("recommendSku",e)}s(function(a){var i;a&&a.model&&(i=a.model.pid+":"+a.model.vid,TShop.sendAtpanel("tmalldetail.37.1",{"uid":o.userId,"pidvid":i})),e.each(r,function(o){var r=t.attr(o,"data-value");if(!r)return!1;var s=r.split(":")[1],c="",d="";if(a&&i&&r==i){c="<p>\u60a8\u53ef\u80fd\u9002\u5408\uff1a"+a.model.recommendSize+"</p>";var u=t.get("a",o);t.addClass(u,"tm-recommend-size"),t.prepend(t.create('<div class="tm-recommend-icon"></div>'),u)}n&&n[l]&&n[l][s]&&n[l][s].tip&&(d=n[l][s].tip),(c||d)&&e.use("malldetail/common/tip",function(e,t){new t(o,c+d,{"triggerType":"mouse","align":{"points":["bl","tl"],"offset":[0,8]},"arrow":!(e.UA.ie&&e.UA.ie<8),"arrowDir":"top left"})})})})});var s=t.hasClass(o,"tb-carmodel");i.onLoad("config",function(r){var l=s&&!0===r.carCascade;if(!l){var c=t.query("li",o),d=t.attr(c,"data-value").split(":")[0],u=t.query("span",o),m=n.createElement("i");m.appendChild(n.createTextNode("\u5df2\u9009\u4e2d")),e.each(u,function(e){var n=e.parentNode,o=t.parent(e,function(e){return!!e.getAttribute("data-value")}),r=o.getAttribute("data-value");if(n.hideFocus=!0,l||i.onChange("thirdPartyInventory",function(){i.canSelectSkuProp(r,"",function(e){e<0?(codeTrack("trade.sku.propHide","trade.sku.init"),t.hide(o)):t.show(o)},{"ignoreSelection":!0})}),1===u.length&&""===n.style.background){var s=!1;i.onLoad("skuMap",function(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t].images){s=!0;break}!s&&i.selectSkuProp(o.getAttribute("data-value"),"")})}a.on(n,"click",function(e){e.preventDefault(),TShop.sendAtpanel("tmalldetail.13.1",1e4);var a=t.parent(e.target,function(e){return!!e.getAttribute("data-value")}),n=r.split(":");t.hasClass(a,"tb-out-of-stock")||i.onLoad("selectedSkuProp",function(e){e[n[0]]==n[1]?i.deselectSkuProp(n[0],n[1]):i.selectSkuProp(n[0],n[1])})})}),i.onChange(["tradeResult","selectedSkuProp"],function(e,a){e&&e.level>0&&"sku"==e.name&&!a[d]?t.addClass(t.get(".tb-metatit",t.parent(o,".tb-prop")),"tb-h"):t.removeClass(t.get(".tb-metatit",t.parent(o,".tb-prop")),"tb-h")}),i.onChange(["selectedSkuProp","skuPropSelectivity","thirdPartyInventory"],function(a){e.each(u,function(e){var n=t.parent(e,function(e){return!!e.getAttribute("data-value")}),o=n.getAttribute("data-value"),r=o.split(":");a[r[0]]==r[1]?(t.addClass(n,"tb-selected"),n.appendChild(m)):(t.removeClass(n,"tb-selected"),i.canSelectSkuProp(o,"",function(e){e<=0?t.addClass(n,"tb-out-of-stock"):t.removeClass(n,"tb-out-of-stock")}))})})}})}),l=function(i,n){function o(e){var a=t.get("#J_DetailMeta .mac-color-ul"),i=t.get('[data-value="'+e.id+'"]',a);t.hasClass(i,"J_MACSKU_hidden")&&(t.prepend(i,a),t.removeClass(i,"J_MACSKU_hidden"))}function r(){var e=t.query(".mac-color-ul .J_MACSKU_hidden");t.removeClass(e,"J_MACSKU_hidden"),t.show(e),t.hide(".mac-color-ul .J_mac_sku_more")}if(!n)return void r();var l="",s={},c=i.get("config"),d=c&&c.valItemInfo&&c.valItemInfo.skuList||[];e.each(d,function(e,t){s[e.skuId]=e}),i.onChange("selectedSku",function(e){l=e?s[e.skuId].pvs:""}),a.on(".J_mac_sku_more","click",function(e){try{window.showMacModal(n,l,function(e){i.selectSkuProp(e.id),o(e)},i)}catch(e){return r(),!1}return!1})};return{"init":function(n){function o(a,i,n){var o="\u5df2\u5339\u914d\uff0c\u8bf7\u8d2d\u4e70",r="";524===a||305===a||""===i?(o="",r="tb-cascade-error",i="\u8bf7\u586b\u5199\u8f66\u578b\u4e3a\u60a8\u7cbe\u786e\u5339\u914d"):525===a?o="\u4e0d\u5339\u914d\uff0c\u4e0d\u5efa\u8bae\u8d2d\u4e70":526===a&&(o="\u8f66\u578b\u4fe1\u606f\u4e0d\u5b8c\u6574"),t.html("#J_CascadeInfo",'<span class="tb-cascade-tips">'+o+'</span><a class="tb-cascade-carinfo '+r+'" href="javascript:" title="'+i+'" data-car="'+n+'">'+i+"</a>"),n&&(p?d.set("selectedCarProp",n):(s&&e.each(n.split(","),function(e){d.deselectSkuProp(e.split(":")[0],"")}),e.each(n.split(","),function(e){d.selectSkuProp(e,"",!0)}),s=n))}if(i=n.config){var s,c=n.elmProps,d=n.product,u=i.itemDO,m=this,p=!0===i.carCascade;if(codeTrack("decision.carCascade.init","app.init"),i.detail&&i.detail.isCarCascade){codeTrack("decision.carCascade.isCar","decision.carCascade.init");var f=t.create('<div class="tb-car-cascade"><div class="tb-cascade-icon">&#xe628;</div><div class="tb-cascade-info"><p id="J_CascadeInfo" class="j_CascadeInfo"></p><span class="tb-cascade-modify j_CascadeInfo">&#xe629;</span><div class="tb-cascade-ww" title="\u54a8\u8be2\u5546\u5bb6">\u54a8\u8be2\u5546\u5bb6<span class="slogo-ww J_WangWang" data-nick="'+i.itemDO.sellerNickName+'" data-tnick="'+i.itemDO.sellerNickName+'" data-encode="true" data-display="inline" data-icon="static"></span></div></div></div>');t.prepend(f,t.get(".tb-sku","#detail")),e.use("ajax",function(e,t){t({"url":"//server-jia.tmall.com/car/checkItemAndManCar.do","data":{"itemid":u.itemId,"sellerid":u.userId},"dataType":"jsonp","jsonpCallback":"jsonpCheckItemAndManCar","cache":!0,"success":function(t){if(t){if(305===t.errorCode)return o(t.errorCode,"","");codeTrack("decision.carCascade.checkItemUserCar.true","decision.carCascade.isCar");var a="",i=[];e.each(["brand","car","cotyYear","model"],function(e){t.object&&t.object[e+"PropertyId"]&&t.object[e+"PropertyValue"]&&(i.push(t.object[e+"PropertyId"]+":"+t.object[e+"PropertyValue"]),a+=t.object[e+"Name"]+" ")});var n=i.join(";");o(t.errorCode,a,n)}else codeTrack("decision.carCascade.checkItemUserCar.false","decision.carCascade.isCar")},"timeout":10,"error":function(){codeTrack("decision.carCascade.checkItemUserCar.error","decision.carCascade.isCar")}})}),a.on(".j_CascadeInfo","click",function(){TShop.onLogin(function(){m.carSelector?(m.carSelector.show(),codeTrack("decision.carCascade.userClick.repeat","decision.carCascade.userClick")):(codeTrack("decision.carCascade.userClick.once","decision.carCascade.userClick"),e.use(["mui/kissy-polyfill/","mui/car-selector/index-pc"],function(e,t,a){d.onLoad("token",function(t){m.carSelector=new a({"isSave":!0,"token":t}),m.carSelector.show(),m.carSelector.on("done",function(t){var a=[],n="";e.each(["brand","type","year","model"],function(e){t&&t.values&&t.values[e]&&t.values[e].propertyId&&t.values[e].valueId?(a.push(t.values[e].propertyId+":"+t.values[e].valueId),n+=t.values[e].name+" "):a.push("")});var r=a.join(";");codeTrack("decision.carCascade.userClick.save","decision.carCascade.userClick"),e.use("ajax",function(e,t){t({"url":"//server-jia.tmall.com/car/checkItemAndManCar.do","data":{"itemid":i.itemDO.itemId,"sellerid":i.itemDO.userId,"pvs":r},"dataType":"jsonp","jsonpCallback":"jsonpCheckItemAndManCar","cache":!0,"success":function(e){e?(305===e.errorCode&&TShop.login(),o(e.errorCode,n,r),codeTrack("decision.carCascade.userClick.true","decision.carCascade.userClick.save")):codeTrack("decision.carCascade.userClick.false","decision.carCascade.userClick.save")},"timeout":10,"error":function(){codeTrack("decision.carCascade.userClick.error","decision.carCascade.userClick.save")}})})}).on("error",function(e){codeTrack("decision.carCascade.userClick.selectError","decision.carCascade.userClick")})})}))})})}e.each(c,function(e){r(d,e)}),d.onLoad("config",function(e){l(d,e&&e.valItemInfo&&e.valItemInfo.macSkuProperty)}),d.onLoad(["config","itemDO"],function(a,i){if(a&&a.detail&&a.detail.isMainLiaoSku&&i.isEnterprisePath){var n=t.create('<div id="J_mainliaosku"></div>');t.insertAfter(n,t.get(".tb-sku .tm-sale-prop","#detail")),e.use(["detail-mods/fabrics/index"],function(e,t){console.log("\u52a0\u8f7d\u6210\u529fFabrics",t),t.init({"el":n})})}}),codeTrack("trade.sku.init","trade.main.init")}}}},{"requires":["dom","event"]});KISSY.add("malldetail/sku/main",function(S,DOM,NODE,Event,Action,PromoBanner,Focus,Meta,Indices,util,Amount,PropertyHandler,PadAdapte,bundleTpl){function showMsg(e,t,a){hasMsg=!0,S.use("malldetail/sku/skuMsg",function(i,n){n.show(e,t,a)})}function hideMsg(e){hasMsg&&S.use("malldetail/sku/skuMsg",function(t,a){a.hide(e)})}var $=NODE.all,hasMsg,timer=null;return{"init":function(cfg){codeTrack("trade.main.init","view.main.init"),setTimeout(function(){codeTrack("trade.buylink.none","trade.main.init",{"reject":["trade.buylink.init","trade.bid.init","trade.main.down"]}),codeTrack("trade.cartlink.none","trade.main.init",{"reject":["trade.cartlink.init","trade.bid.init","trade.main.down"]})},4096);var win=window,doc=document,g_config=win.g_config,config=cfg.config,product=cfg.product,el=DOM.get(".tb-wrap",DOM.get(".tb-property","#detail"));product.onLoad(["model"],function(e){var t=$(".tb-detail-hd p");config&&config.detail&&config.detail.isNewAttraction&&S.each(t,function(e){var t=$(e);t.hasClass("hitp")||t.addClass(".newp")}),e&&e.regionalizedData&&e.regionalizedData.subTitle&&e.regionalizedData.subTitle.show&&e.regionalizedData.subTitle.data&&1==t.length&&(t.html(e.regionalizedData.subTitle.data),t.addClass(".newp")),product.onChange("locModel",function(e){e&&e.regionalizedData&&e.regionalizedData.subTitle&&1==t.length&&e.regionalizedData.subTitle.show&&(e.regionalizedData.subTitle.data?(DOM.show(t),t.html(e.regionalizedData.subTitle.data),t.addClass(".newp")):DOM.hide(t))}),e&&e.detailPageTipsDO&&e.detailPageTipsDO.prime&&S.use("malldetail/sku/mtHead",function(e,t){t.init(config)})}),product.onLoad(["internationalComponent"],function(e){if(e){var t=e.nationalIcon,a=e.fromName;t&&a&&DOM.before(DOM.create("<div class='fromName'><img src='"+t+"' width='20' height='20' />&nbsp;"+a+"</div>"),DOM.get(".tb-detail-hd h1"))}}),product.onChange(["servicePromise"],function(e){product.onLoad(["itemDO"],function(t){if(t&&t.showCompanyPurchase&&t.isEnterprisePath)return!1;if(e&&e.show&&e.servicePromiseList){for(var a=e.servicePromiseList,i=e.titleInformation,n=[],o=0,r=a.length;o<r;o++){var l=a[o],c="";l.rank>0&&(c="<s>T"+l.rank+"</s>"),l.link?n.push("<li>"+c+"<a href='"+l.link+"' title='"+l.description+"' target='_blank' >"+l.displayText+"</a></li>"):n.push("<li>"+c+"<a title='"+l.description+"' target='_blank' >"+l.displayText+"</a></li>")}DOM.html(".tb-serPromise",n.join(""));var s="",d="";i&&i.length&&(d=i[0].icon)&&e.has3CPromise?s='<a target="_blank" href="'+i[0].link+'"><img class="ylxb-img" src="'+d+'" height="18" /></a>':i&&i.length&&(s=i[0].displayText+'<a class="tm-help" title="'+i[0].description+'" target="_blank" href="'+i[0].link+'">?</a>');var u=DOM.get(".tb-detail-sellpoint");if(u)DOM.html(u,s);else{var m="<div class='tb-detail-sellpoint'>"+s+"</div>";DOM.append(DOM.create(m),".tb-detail-hd")}}})});var titlePreEl;product.onChange("detailPageTips",function(e){if(!e||!e.itemTitle)return void(titlePreEl&&DOM.html(titlePreEl,""));titlePreEl||DOM.insertBefore(titlePreEl=DOM.create('<h3 class="tm-titlePre"></h3>'),DOM.get("h3",".tb-detail-hd")),codeTrack("trade.main.titlePre","trade.main.init"),DOM.html(titlePreEl,e.itemTitle)}),product.onChange("canBuyStatus",function(){product.canBuy({"level":4},function(e){hideMsg("canBuy"),e.level&&e.message&&showMsg(e.message,null,"canBuy")})});var actionEl=DOM.get(".tb-action","div.tb-sku");actionEl&&(Action.init({"el":actionEl,"showMsg":function(e,t){return showMsg(e,t)},"hideMsg":function(){return hideMsg()},"product":product}),product.onLoad(["trade","config"],function(e,t){if(14===e.tradeDisableTypeEnum){if(t.detail&&t.detail.isZhengChe)return;var a=DOM.get("#J_CarFinance");a||(a=DOM.create('<dl id="J_CarFinance"><dt class="tb-metatit">\u7533\u8bf7\u5206\u671f</dt><dd>\u6700\u9ad8\u5206\u671f\u989d\u5ea6 <span class="price" style="font-family: arial"></span></dd></dl>'));var i=DOM.get(".price",a);product.onChange("buyPrice",function(e){var t=null,a=.8;e.min!==e.max?(t=(100*e.min*a/100).toFixed(2)+"-",t+=(100*e.max*a/100).toFixed(2)):t=(100*e.str*a/100).toFixed(2),DOM.html(i,"&yen;"+t)}),DOM.insertBefore(a,actionEl)}}));var focusEl=DOM.get(".tm-fcs-panel",el);focusEl&&product.onLoad(["itemDO","model","userInfo","config"],function(e,t,a,i){function n(){DOM.show(focusEl),product.onChange(["model"],function(e){if(null==DOM.get(".tm-focus-vip-banner")&&e.detailPageTipsDO&&e.detailPageTipsDO.vip95CardBanner){var t=DOM.create('<div class="tm-focus-vip-banner" style="background-image:url('+e.detailPageTipsDO.vip95CardBanner.bgIcon+");color:"+e.detailPageTipsDO.vip95CardBanner.textColor+'" >'+e.detailPageTipsDO.vip95CardBanner.text+"</div>");DOM.insertBefore(t,focusEl)}}),product.onChange(["currentSuggestivePromotionList","currentPromotionList","model"],function(e,t,a){if(null==DOM.get(".tm-focus-banner")&&(a.minisiteDO&&a.minisiteDO.validMlhItem||a.detailPageTipsDO&&a.detailPageTipsDO.showDou11Style||S.filter([].concat(e||[]).concat(t||[]),function(e){return"keyJhs"==e.promType||"jhs"==e.promType||"jhs_warm"==e.promType||"tmallBigMarkDown"==e.promType||"tmallBrandMember"==e.promType||"awp"==e.promType||"wrt"==e.promType})[0])){var i=DOM.create('<dl class="tm-focus-banner"><dt class="tb-metatit"></dt><dd></dd></dl>');DOM.insertBefore(i,focusEl),S.use("malldetail/sku/promoBanner",function(e,t){t.init({"el":i,"product":product})})}}),Focus.init({"el":focusEl,"product":product})}var o,r=i&&i.valItemInfo&&i.valItemInfo.skuList||[];e&&e.showCompanyPurchase&&(Event.on("#J_MiaoBar","click",function(e){var t=DOM.get("a.rightBtn",this);DOM.contains(t,e.target)||t==e.target||Event.fire(DOM.clone(t),"click")}),DOM.css("#J_MiaoBar","cursor","pointer")),e&&e.showCompanyPurchase&&e.isEnterprisePath&&a&&window.Caigou?(o=DOM.create('<div id="CaigouPrice"></div>'),DOM.insertAfter(o,focusEl),DOM.css(o,"margin-right","20px"),DOM.hide(focusEl),window.Caigou.init("CaigouPrice",{"userInfo":a,"skuList":r},function(){TShop.sendAtpanel("tmalljy.2.52",{"pos":"pageShow","type":"pc","biz":"detail"}),window.Caigou.render(""),product.onChange(["amount","selectedSkuInfo"],function(e,t){window.Caigou.render(S.keys(t),e)})},function(){n()})):n()});var hotItemEl=DOM.get("#J_HotItem");config.itemDO.isHotItem&&(hotItemEl||(hotItemEl=DOM.create('<div id="J_HotItem" class="tm-clear"></div>'),DOM.insertBefore(hotItemEl,actionEl)),S.use("malldetail/sku/hotitem",function(e,t){t.init({"actionEl":actionEl,"hotItemEl":hotItemEl,"product":product})}));var metaEl=DOM.get(".tb-meta",el);DOM.get("#J_RSPostageCont",focusEl)&&DOM.prepend(DOM.get("#J_RSPostageCont",focusEl),DOM.get(".tb-meta",el)),Meta.init({"el":metaEl,"product":product});var stepRate=config.itemDO.stepPaymentFirstStepPriceRate;stepRate&&DOM.get(".tm-step-panel")&&(product.onChange(["currentPromotion"],function(e){!e||e.limitTime&&!1===e.start||DOM.html(".J_stepPriceTitle","\u4fc3\u9500\u4ef7x")}),product.onChange(["buyPrice"],function(e){var t,a="<s>\xa5</s><span>"+(e.min*stepRate).toFixed(2)+"</span>";e.min!=e.max&&(a+=" - <span>"+(e.max*stepRate).toFixed(2)+"</span>"),t="\u9996\u6b21\u4ec5\u652f\u4ed8"+a+"\uff0c\u5269\u4f59\u91d1\u989d\u5206\u9636\u6bb5\u4ed8\u6b3e",DOM.html(".tm-step-first",t),DOM.addClass(DOM.parent(".tm-step-first"),"tm-step-action")}),Event.on(".J_stepRule","mouseover touchstart",function(){DOM.show(".tm-step-rule")}),Event.on(".J_stepRule","mouseout touchend",function(){DOM.hide(".tm-step-rule")})),product.onLoad("model",function(e){e&&e.detailPageTipsDO&&e.detailPageTipsDO.showCuntaoIcon&&S.use("tmdetail/components/goodsTag/index",function(e,t){t.init()})});var indicesEl=DOM.get(".tm-ind-panel",el);!indicesEl&&cfg.autoFill&&(indicesEl=DOM.create('<ul class="tm-ind-panel"></ul>'),DOM.append(indicesEl,el)),indicesEl&&Indices.init({"autoFill":cfg.autoFill,"onReviewClick":cfg.onReviewClick,"onSellCountClick":cfg.onSellCountClick,"el":indicesEl,"product":product,"config":config}),product.onChange(["currentAmountRestrict","amount","amountMultiple","config","currentInventory","selectedSku","currentPromotion","buyPrice"],function(e,t,a,i,n,o,r){hideMsg("promotionlimited"),r&&(r.amountRestriction||r.buyerAmountRestriction)&&"keyJhs"!=r.promType&&"jhs"!=r.promType&&"wrt"!=r.promType&&(r&&r.amountRestriction&&t*a>r.amountRestriction?showMsg("\u8be5\u4f18\u60e0\u9650\u8d2d"+r.amountRestriction+"\u4ef6\uff0c\u8d85\u8fc7"+r.amountRestriction+"\u4ef6\u540e\u5c06\u4e0d\u4eab\u53d7\u6b64\u4f18\u60e0\u4ef7",null,"promotionlimited"):r.buyerAmountRestriction&&t*a>r.buyerAmountRestriction&&showMsg("\u8be5\u4f18\u60e0\u6bcf\u4eba\u9650\u8d2d"+r.buyerAmountRestriction+"\u4ef6\uff0c\u8d85\u8fc7"+r.buyerAmountRestriction+"\u4ef6\u540e\u5c06\u4e0d\u4eab\u53d7\u6b64\u4f18\u60e0\u4ef7",null,"promotionlimited"))});var amountEl=S.get("#J_Amount");if(amountEl){var emStock=DOM.get("#J_EmStock"),initStockAndRestrict=function(e){DOM.hasClass(amountEl,"tm-hideAmount")?DOM.remove(emStock):S.use("malldetail/sku/stock",function(t,a){a.init({"el":emStock,"hideStock":e,"product":product})})};product.onLoad(["model"],function(e){var t=!0;e&&e.inventoryDO&&e.inventoryDO.hidden&&(t=!1),emStock&&t?initStockAndRestrict():product.onLoad("currentAmountRestrict",function(e){e&&initStockAndRestrict(!0)})}),Amount.init({"el":amountEl,"product":product})}product.onLoad("skuMap",function(e){var t=!1;if(e){for(var a in e)if(e[a].shipTime){t=!0;break}}else;t?S.use("malldetail/sku/shiptime",function(e,t){t.init({"parentEl":DOM.parent("#J_Amount"),"product":product})}):product.onLoad(["mdskip","config"],function(e,t){if(e&&e.defaultModel&&e.defaultModel.ctCollectionInfo){var a=DOM.get(".J_tmSaleTime");DOM.hide(a)}else product.onChange(["currentDelivery","delivery"],function(e,a){product.onLoad(["delivery"],function(a){var i=DOM.get(".J_tmSaleTime");i||(i=DOM.create('<div class="tb-prop tm-clear J_tmSaleTime"></div>'),DOM.insertBefore(i,DOM.parent("#J_Amount")));var n=null;if(a&&a.cainiaoShipTime?n='<span class="tb-metatit">\u53d1\u8d27\u65f6\u95f4</span>'+a.cainiaoShipTime:t&&t.detail&&t.detail.shipTime&&(n='<span class="tb-metatit">\u53d1\u8d27\u65f6\u95f4</span>'+t.detail.shipTime),n?(DOM.html(i,n),DOM.show(i)):(DOM.html(i,""),DOM.hide(i)),t&&t.detail&&t.detail.isDianQiMeiJia)if(e&&e.length>0&&e[0].signText){var i=DOM.get(".J_tmSaleTime");DOM.hide(i)}else{var i=DOM.get(".J_tmSaleTime");DOM.show(i)}})})})});var tbidEl=DOM.get("#tbid-container");if(tbidEl){var bidEl=DOM.get("#J_BidRecord");if(bidEl&&config.detail.goNewAuctionFlow&&window.TAOBAO_PAIMAI_BIDSAU){codeTrack("mod.bidRecord.init","trade.main.init");try{var data=window.JSON?window.JSON.parse(window.TAOBAO_PAIMAI_BIDSAU.data):eval("("+window.TAOBAO_PAIMAI_BIDSAU.data+")");DOM.html(bidEl,data.totalCnt),codeTrack("mod.bidRecord.show","mod.bidRecord.init")}catch(e){}}codeTrack("trade.bid.init","trade.main.init"),S.use("malldetail/css/auction.css",function(e,t){codeTrack("trade.bid.run","trade.bid.init"),codeTrack("trade.bid.runSuccess","trade.bid.run")})}var amount=DOM.get(".tb-amount",el);amount&&product.onLoad("config",function(e){if(e&&e.detail&&e.detail.isBundleItem){var t=DOM.create('<dl class="tm-bundle tm-clear"></dl>');DOM.insertBefore(t,amount),S.use("malldetail/sku/bundle",function(e,a){a.init({"el":t,"product":product})})}});var elTbkey=DOM.get(".tb-key","#detail"),inited=!1;product.onChange(["tradeResult","config"],function(e,t){if(t&&t.detail&&t.detail.isBundleItem&&e&&e.level>0&&("sku"==e.name||"subItems"==e.name))return S.use("malldetail/sku/bundle",function(t,a){a.onDialog(function(t){t.show(),t.dialogClick||t.setBtn(e.type),t.dialogClick=!1,hideMsg()})}),!1;var a=DOM.get("#J_sellerCspu");e&&e.level>0&&"sku"==e.name?(DOM.addClass(elTbkey,"tb-attention"),DOM.css(a,"display","none"),inited||(inited=!0,DOM.insertBefore(DOM.create('<p class="tb-note-title">\u8bf7\u9009\u62e9\u60a8\u8981\u7684\u5546\u54c1\u4fe1\u606f<b class="J_PanelCloser">x</b></p>'),DOM.get("div.tb-skin",elTbkey).firstChild),Event.on(DOM.get("b.J_PanelCloser",elTbkey),"click",function(){product.set("tradeResult","null")}),codeTrack("trade.sku.attention","trade.main.init"))):(DOM.removeClass(elTbkey,"tb-attention"),DOM.css(a,"display","block"))});var regionSellerServer=DOM.get("#J_regionSellServer"),supService=function(e,t){product.onLoad("model",function(a){product.onLoad(["itemDO"],function(i){if(i&&i.showCompanyPurchase&&i.isEnterprisePath);else if(a.switcherDO&&a.switcherDO.otherserviceDisable)DOM.hide(regionSellerServer);else{if(e&&e.list&&e.list.length)return(supService=function(e,t){regionSellerServer||(regionSellerServer=DOM.create('<dl id="J_regionSellServer" class="tm-clear tb-hidden tb-prop" data-spm="1000987"></dl>'),DOM.insertAfter(regionSellerServer,".tb-amount")),S.use("malldetail/sku/service",function(a,i){i.render({"data":e,"selectedService":t,"title":config.detail&&config.detail.isShowEcityBasicSign?"\u589e\u503c\u670d\u52a1":"","container":regionSellerServer,"product":product})}),DOM.show(regionSellerServer)})(e,t);DOM.hide(regionSellerServer)}})})};product.onChange(["currentService","service"],function(e,t){product.onLoad("selectedService",function(a){e=e||t,e&&e.list&&e.list.length?supService(e,a):DOM.hide(regionSellerServer)})}),product.onLoad("detailPageTips",function(e){if(e){var t=e.serviceIcons,a="";if(S.each(t,function(e){a+='<li><a href="'+e.link+'" target="_blank">'+e.title+"</a></li>"}),a){var i=DOM.get(".tb-serPromise");DOM.prepend(DOM.create(a),i)}}}),product.onLoad(["itemDO","model","progressiveInfo"],function(e,t,a){if(a&&a.tryBeforeBuy&&(!t.switcherDO||!t.switcherDO.exclusiveServiceDisable)){var i=DOM.create('<dl class="tm-exclusiveService tb-prop"></dl>');S.use("malldetail/sku/exclusiveService",function(e,t){t.init({"product":product,"el":i}),DOM.insertAfter(i,".tb-amount")})}});var ladeEl=DOM.get("#J_TladeMode");ladeEl&&S.use("malldetail/sku/skuLade",function(e,t){t.init({"el":ladeEl,"product":product})}),product.onLoad("userInfo",function(e){codeTrack("cps.init","trade.main.init"),S.getScript("//g.alicdn.com/mm/cps/trace.js?t=20130926_"+g_config.t,function(){var t=e&&e.juKeBuyerLogin?4:2;try{codeTrack("cps.run","cps.init",{"group":t}),window.CPS.trace({"type":1,"subtype":t,"itemid":config.itemDO.itemId,"sellerid":config.itemDO.userId}),codeTrack("cps.init","cps.run",{"group":t})}catch(e){}})});var elmProps=DOM.query(".J_TSaleProp","#detail");(elmProps.length||config.detail.isCarCascade)&&PropertyHandler.init({"product":product,"elmProps":elmProps,"config":config}),product.onLoad("pickupPoints",function(e){if(e){var t=DOM.get("#J_PickupArea");S.use(["malldetail/sku/pickupPoint","malldetail/common/select","malldetail/common/select.css"],function(a,i){codeTrack("mod.pickupPlace.init","trade.main.init"),i.init({"el":DOM.get("dd",t),"product":product,"pickupPoints":e})})}});var skuEl=DOM.get(".tb-sku","#detail");product.onLoad(["config","itemDO","userInfo","deviceType","internationalComponent"],function(e,t,a,i,n){var o=elmProps&&elmProps.length>0&&elmProps[0];if(n&&n.sizeCartUrl&&o&&DOM.append(DOM.create('<div class="tm-interSizeHelper j_dialogSize">\u56fd\u9645\u5c3a\u7801\u52a9\u624b</div>'),o),e.isShowSizeHelper&&e.sizeHelperEnable&&o){TShop.sendAtpanel("tmalldetail.33.1"),codeTrack("mod.sizeHelper.init","trade.main.init");var r,l,c=!1;"pad"===i?(r=DOM.create('<div class="tm-sizeHelper-btn"> <i>&nbsp;</i>\u5c3a\u7801\u8868 </div>'),DOM.prepend(r,skuEl)):(r=DOM.create('<div class="tm-sizeHelper">\u5c3a\u7801\u52a9\u624b</div>'),DOM.append(r,o)),Event.on(r,"click tap",function(){if(TShop.sendAtpanel("tmalldetail.37.2",{"uid":a&&a.userId||null}),c)return void(l&&l.show());product.onLoad(["itemDO","token"],function(e,t){S.use("fushi/sizehelper-pc/sizehelper-pc",function(a,i){l=new i({"typeId":e.categoryId,"itemId":e.itemId,"_tb_token_":t}),c=!0,l.show()})})})}}),product.onLoad("deviceType",function(e){"pad"===e&&PadAdapte.init({"el":skuEl,"cfg":config,"product":product})}),product.onLoad(["config"],function(e){e.isOnlyInMobile&&skuEl&&S.use("malldetail/other/limitedPurchase",function(e,t){t.init({"el":skuEl,"product":product})})});var togglerEl=DOM.get("#J_Toggler");togglerEl&&S.use("malldetail/sku/paymethods",function(e,t){product.onLoad(["delivery","bucketId","model"],function(e,a,i){t.init({"product":product,"delivery":e,"el":DOM.parent(togglerEl),"bucketId":a,"promiseDisable":i.switcherDO&&i.switcherDO.promiseDisable,"payDisable":i.switcherDO&&i.switcherDO.payDisable,"pageType":config&&config.detail&&config.detail.pageType})})});var lastPropsElm=elmProps&&elmProps[elmProps.length-1];lastPropsElm&&product.onLoad(["skuMap","itemDO","config","bucketId"],function(e,t,a,i){util.bucketStat(i,window.g_config.cspuBucketTestIdArray)&&S.use(["malldetail/sku/cspu","malldetail/sku/cspu.tpl","detail-model/cspu","malldetail/sku/cspu.css"],function(i,n){n.init({"ellast":lastPropsElm,"product":product,"skuMap":e,"spuId":t.spuId,"cspuCategorySwitch":t.cspuCategorySwitch,"apiUrl":a.initCspuExtraApi})})}),DOM.get("#J_ExSelect")&&S.use("malldetail/sku/codeexchange",function(e,t){t.init()}),product.onLoad(["config","itemDO"],function(e,t){var a=e.detail;if(a&&a.isPrescriptionDrug&&!(t&&t.showCompanyPurchase&&t.isEnterprisePath)){var i=DOM.get("#J_LinkBasket");DOM.hide(i);var n=DOM.get("#J_DetailMeta .tb-wrap");DOM.append(DOM.create('<div class="cfy-wrap"><dl><dt></dt><dd>\u8be5\u836f\u4e3a\u5904\u65b9\u836f\u3001\u5efa\u8bae\u4f60\u53bb\u533b\u9662\u5c31\u8bca\u6216\u51ed\u533b\u751f\u7684\u5904\u65b9\u5230\u5c31\u8fd1\u7684\u836f\u623f\u9009\u8d2d\u3002</dd></dl><dl><dt></dt><dd>\u836f\u54c1\u76d1\u7ba1\u90e8\u95e8\u63d0\u793a\uff1a\u5982\u53d1\u73b0\u672c\u7f51\u7ad9\u6709\u4efb\u4f55\u76f4\u63a5\u6216\u53d8\u76f8\u9500\u552e\u5904\u65b9\u836f\u884c\u4e3a\uff0c\u8bf7\u4fdd\u7559\u8bc1\u636e\uff0c\u62e8\u625312331\u4e3e\u62a5\u3002</dd></dl></div>'),n)}}),product.onChange("relatedAuctions",function(e){if(e&&e.relatedAuctions&&e.relatedAuctions.length){var t,a,i=win.g_config.bizTag;4096&i&&e.version&&product.onLoad(["itemDO"],function(i){i&&i.showCompanyPurchase&&i.isEnterprisePath||S.use("malldetail/other/relateGroup, malldetail/other/relateGroup.css",function(i,n){switch(e.version){case 1:t=DOM.create('<div class="tm-bd-nav"></div>'),DOM.insertBefore(t,"#detail"),a="top";break;case 2:t=DOM.create('<dl class="tm-relate-wrapper tm-clear" id="J_relateGroup"></dl>'),DOM.prepend(t,"div.tb-sku"),a="right"}DOM.data(t,"dir",a),n.init(t,e)})})}}),!1!==cfg.showDownShelf&&product.onChange("isDownShelf",function(e){if(e){codeTrack("trade.main.down","trade.main.init");var t;if(!DOM.get("#J_Sold-out-recommend")){var a=DOM.get(".tm-fcs-panel","#detail");if(a){for(var i;i=DOM.next(a);)DOM.remove(i);DOM.insertAfter(DOM.create('<ul class="tb-meta"><li class="sold-out-recommend" id="J_Sold-out-recommend">\t\t\t\t\t\t\t\t<div class="sold-out-info"><div class="sold-out-left"><strong class="sold-out-tit">\u6b64\u5546\u54c1\u5df2\u4e0b\u67b6</strong>\uff08<a class="sold-out-help" target="_blank" href="//service.taobao.com/support/knowledge-1102683.htm">?</a>\uff09</div><div class="sold-out-right"></div></div>\t\t\t\t\t\t\t\t<div id="J_FE_soldout"></div>\t\t\t\t\t\t\t</li></ul>'),a),t=DOM.create('<div class="ald"></div>'),DOM.append(t,"#J_FE_soldout")}}!1!==config.detail.showDownShelfRecommend&&(t||(t=DOM.get(".ald",DOM.get("#J_Sold-out-recommend"))),DOM.addClass(t,"ald-03037"),S.use("malldetail/recommend/downShelf",function(e,a){a.init({"el":t,"product":product})}))}});var showErrorTip=function(){DOM.show(".sold-out-error"),clearTimeout(timer),timer=setTimeout(function(){DOM.hide(".sold-out-error")},3e3)},preSellState=function(e){var t="";e&&e.sellOutStatus?(codeTrack("trade.main.hasPreSell","trade.main.sellout"),e.reserved?(codeTrack("trade.main.preSellDone","trade.main.hasPreSell"),t='<div class="sold-out-success">',2===e.sellOutStatus?(codeTrack("trade.main.preSellNotDone.hasUrl","trade.main.preSellDone"),t+='<p><span>&#xe60d;</span>\u5df2\u5f00\u542f\u63d0\u9192</p><a href="'+e.jumpUrl+'" target="_blank" title="\u53bb\u9886\u5956">\u53bb\u9886\u5956</a>'):(t+='<p class="sold-out-success1"><span>&#xe60d;</span>\u5df2\u5f00\u542f\u63d0\u9192</p>',codeTrack("trade.main.preSellNotDone.noUrl","trade.main.preSellDone")),t+='</div><div class="sold-out-appinfo"><p>\u5f00\u542f\u6210\u529f\u540e\uff0c\u5f53\u6709\u8d27\u65f6\uff0c\u6211\u4eec\u5c06\u7528<span>\u624b\u673a\u5929\u732b</span>\u7684\u6d88\u606f\u901a\u77e5\u60a8\u3002\u626b\u63cf\u53f3\u4fa7\u4e8c\u7ef4\u7801\u7acb\u5373\u4e0b\u8f7d\u624b\u673a\u5929\u732b\uff0c\u5e76\u6253\u5f00\u7cfb\u7edf\u901a\u77e5\u54e6~</p><img src="//img-tmdetail.alicdn.com/tfscom/TB1sNAiLXXXXXc0XFXXwu0bFXXX.png" alt="\u626b\u7801\u4e0b\u8f7d\u732b\u5ba2" /></div>',DOM.html(".sold-out-right",t)):(codeTrack("trade.main.preSellNotDone","trade.main.hasPreSell"),1===e.sellOutStatus?(codeTrack("trade.main.preSellNotDone.noUrl","trade.main.preSellNotDone"),t='<a class="sold-out-remind" data-activityId="'+e.activityId+'" data-reservedModuleId="'+e.reservedModuleId+'" href="javacript:" title="\u5f00\u542f\u6709\u8d27\u63d0\u9192">\u5f00\u542f\u6709\u8d27\u63d0\u9192</a><p class="sold-out-error">\u5f00\u542f\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5\uff01</p>'):2===e.sellOutStatus&&(codeTrack("trade.main.preSellNotDone.hasUrl","trade.main.preSellNotDone"),t='<a class="sold-out-remind sold-out-url" data-activityId="'+e.activityId+'" data-reservedModuleId="'+e.reservedModuleId+'" href="javacript:" title="\u5f00\u542f\u6709\u8d27\u63d0\u9192(\u7acb\u5373\u5f00\u542f\u6709\u597d\u793c)">\u5f00\u542f\u6709\u8d27\u63d0\u9192<span>(\u7acb\u5373\u5f00\u542f\u6709\u597d\u793c)</span></a><p class="sold-out-error">\u5f00\u542f\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5\uff01</p>'),DOM.html(".sold-out-right",t),Event.on(".sold-out-remind","click",function(t){var a=this;codeTrack("trade.main.preSellNotDone.click","trade.main.preSellNotDone"),TShop.onLogin(function(){product.onLoad(["token"],function(t){S.use("ajax",function(i,n){n({"url":"//xinshoufa.tmall.com/activity/act/reserve.jsonp","data":{"activityId":DOM.attr(a,"data-activityId"),"reserveId":DOM.attr(a,"data-reservedModuleId"),"source":"pad"==TShop.detector.deviceType?"pad":"pc","from":"detail","token":t},"dataType":"jsonp","jsonpCallback":"jsonpXinShouFa","cache":!0,"success":function(t){t&&t.success?(codeTrack("trade.main.preSellNotDone.click.true","trade.main.preSellNotDone"),e.reserved=!0,preSellState(e)):118===t.errorCode?(codeTrack("trade.main.preSellNotDone.click.false.preSellDone","trade.main.preSellNotDone"),e.reserved=!0,preSellState(e)):(codeTrack("trade.main.preSellNotDone.click.false","trade.main.preSellNotDone"),showErrorTip())},"timeout":10,"error":function(){codeTrack("trade.main.preSellNotDone.click.error","trade.main.preSellNotDone"),showErrorTip()}})})})})}))):DOM.css(".sold-out-left",{"width":"auto"})};KISSY.use("malldetail/other/shortcut",function(e,t){setTimeout(function(){t.init()},200)}),product.onLoad("model",function(e){codeTrack("trade.main.sellout","trade.main.init"),preSellState(e.sellOutDO)})}}},{"requires":["dom","node","event","malldetail/sku/action","malldetail/sku/promoBanner","malldetail/sku/focus","malldetail/sku/meta","malldetail/sku/indices","malldetail/common/util","malldetail/sku/skuAmount","malldetail/sku/propertyHandler","malldetail/sku/padadapte"]});KISSY.add("malldetail/sku/shiptime",function(e,t){return{"init":function(e){var a,i=e.parentEl,n=e.product;codeTrack("mod.shiptime.init","trade.main.init"),n.onChange(["selectedSku","config","currentDelivery","delivery"],function(e,o,r,l){n.onLoad(["delivery"],function(r){(a=t.get("#J_ShipTime"))||(a=o.detail&&o.detail.isZhengChe?t.create('<div class="tb-prop tm-clear tb-hidden" id="J_ShipTime"><span class="tb-metatit">\u4ea4\u8f66\u65f6\u95f4</span><span ></span></div>'):t.create('<div class="tb-prop tm-clear tb-hidden" id="J_ShipTime"><span class="tb-metatit">\u53d1\u8d27\u65f6\u95f4</span><span ></span></div>'),t.insertBefore(a,i));var l=null;r&&r.cainiaoShipTime?l=o.detail&&o.detail.isZhengChe?'<span class="tb-metatit">\u4ea4\u8f66\u65f6\u95f4</span><span >'+r.cainiaoShipTime+"</span>":'<span class="tb-metatit">\u53d1\u8d27\u65f6\u95f4</span><span >'+r.cainiaoShipTime+"</span>":e&&e.shipTime&&(l=o.detail&&o.detail.isZhengChe?'<span class="tb-metatit">\u4ea4\u8f66\u65f6\u95f4</span><span >'+e.shipTime+"</span>":'<span class="tb-metatit">\u53d1\u8d27\u65f6\u95f4</span><span >'+e.shipTime+"</span>"),l?(t.removeClass(a,"tb-hidden"),a.innerHTML=l,codeTrack("mod.shiptime.show","mod.shiptime.init")):(t.addClass(a,"tb-hidden"),a.innerHTML=""),n.onLoad(["mdskip","currentDelivery"],function(e,i){a&&e&&e.defaultModel&&e.defaultModel.ctCollectionInfo?t.addClass(a,"tb-hidden"):o&&o.detail&&o.detail.isDianQiMeiJia&&i.length>0&&i[0].signText&&t.addClass(a,"tb-hidden")})})})}}},{"requires":["dom"]});KISSY.add("mui/amount",function(e,t,a,i,n){function o(t){o.superclass.constructor.call(this,t),e.mix(t,{"defVal":1,"step":1},!1,null,!1),this.cfg=t,this._init()}var r="mui-amount-",l=r+"wrap",s=r+"increase",c=r+"decrease",d=r+"input";return e.extend(o,i),e.augment(o,e.EventTarget),e.augment(o,{"_init":function(){var e=this;this.cfg.product.onLoad("deviceType",function(i){e.widgetEl=a.get("."+l,e.cfg.container),e.widgetEl?(e.inputEl=a.get("."+d,e.cfg.container),e.increaseEl=a.get("."+s,e.cfg.container),e.decreaseEl=a.get("."+c,e.cfg.container)):(e.widgetEl=a.create('<span class="'+l+'"></span>'),e.inputEl=a.create('<input type="text" class="tb-text '+d+'" value="'+e.cfg.defVal+'" maxlength="8" title="\u8bf7\u8f93\u5165\u8d2d\u4e70\u91cf"/>'),e.increaseEl=a.create('<span class="'+s+'"></span>'),e.decreaseEl=a.create('<span class="'+c+'"></span>'),a.append(e.inputEl,e.widgetEl),a.append(e.increaseEl,e.widgetEl),a.append(e.decreaseEl,e.widgetEl)),a.prepend(e.widgetEl,e.cfg.container),e.set("amount",e.cfg.defVal),"pad"==i&&(e.incresePadEl=a.create('<span class="'+s+'">&#xe627;</span>'),e.decreasePadEl=a.create('<span class="'+c+'">&#xe616;</span>'),a.insertBefore(e.incresePadEl,e.inputEl),a.insertAfter(e.decreasePadEl,e.inputEl)),t.on(e.cfg.container,"click",function(t){var i=t.target,n=e.get("amount");a.hasClass(i,c)?e.setValue(n-e.cfg.step):a.hasClass(i,s)&&e.setValue(n+e.cfg.step)}),t.on(e.inputEl,"keyup",function(){e.inputEl.value&&e.setValue(e.inputEl.value)}),t.on(e.inputEl,"change",function(){e.setValue(e.inputEl.value)})})},"setValue":function(e){var e=(!isNaN(e=parseInt(e,10))&&e)>0?e:1;this.set("amount",e),this.inputEl.value!=e&&(this.inputEl.value=e)},"onValueChange":function(t){e.isFunction(t)&&this.on("afterAmountChange",t)},"focus":function(){this.inputEl.focus()},"hide":function(){a.hide(this.widgetEl)}}),o},{"requires":["event","dom","base","malldetail/common/template"]}),KISSY.add("malldetail/sku/skuAmount",function(e,t,a){function i(e,i,n){for(var o="<select>",r=n.detail.quantityList,l=0;l<r.length;l++)o+='<option value="'+r[l]+'">'+r[l]+"</option>";o+="</select>",o=t.create(o),t.prepend(o,e),i.onChange("amount",function(e){var t=o.options,a=t.length;if(!(o.selectedIndex>=0&&t[o.selectedIndex].value==e))for(var i=0;i<a;i++)if(t[i].value==e)return void(o.selectedIndex=i)}),a.on(o,"change",function(e){o.selectedIndex<0||i.set("amount",o.options[o.selectedIndex].value)}),codeTrack("trade.amountSelect.show","trade.amountInput.show")}return{"init":function(a){var n=a.el,o=a.product;codeTrack("trade.skuAmount.init","trade.main.init"),e.use("mui/amount",function(e,a){var r=new a({"container":n,"product":o});r.onValueChange(function(e){o.onLoad("amount",function(t){o.set("amount",e.newVal)})}),o.onChange(["amount","currentAmountRestrict"],function(e,t){r.setValue(e)}),o.onChange(["amountMultiple"],function(e){e>1&&t.insertBefore(t.create('<span class="tm-amount-times"><s class="s1">X</s>&nbsp;<s class="s2">'+e+"</s>&nbsp;\u4ef6</span>"),t.get("#J_EmStock"))}),codeTrack("trade.amountInput.show","trade.skuAmount.init"),o.onLoad(["itemPrice","config"],function(e,t){e&&!e.promType&&t.detail.quantityList&&t.detail.quantityList.length>0&&(r.hide(),i(n,o,t))})})}}},{"requires":["dom","event"]});