KISSY.add("malldetail/other/idsMod",function(e,t,a,n,o,i){function r(e){var t=e.target;if("A"==t.tagName){e.preventDefault();var a=t.href.split("#");if(a[1]){var o=a[1],i=(n.text(t),n.parent(t));p&&d("fast"),s(i,{"autoRemove":!1}),c(o);var r,l,u;r=n.attr(t,"data-type"),r?(l=n.attr(t,"data-markId"),u=n.attr(t,"data-moduleId"),"cat_mod"===r&&l&&u?TShop.sendAtpanel("tmalldetail.66."+l,{"moduleId":u}):"usr_mod"===r&&TShop.sendAtpanel("tmalldetail.66.1000",{"moduleName":n.text(t)})):TShop.sendAtpanel("tmalldetail.16.1",{"moduleId":o}),"J_DtlentryBox"==o&&TShop.sendAtpanel("tmallrate.8.4.10")}}}function l(t){if(t){var a=n.query(".desc_anchor","#description");e.use("malldetail/other/idsModNav",function(e,t){t.init({"el":a,"mods":y.mods})})}}function c(e){var t=n.offset("#"+e);if(t){var a=g?50:40,o=(n.scrollTop(),t.top-a),i=n.scrollLeft();v=!0,h=!1,window.scrollTo(i,o),f=!0,v=!1}}function s(e,t){m&&clearTimeout(m),e!=p&&d("fast"),n.addClass(e,"tm-selected"),p=e,t&&t.autoRemove&&d()}function d(e){var t=function(){n.removeClass(p,"tm-selected"),p=null};p&&("fast"==e?t():m=setTimeout(t,3e3))}function u(c){function s(t){t=k,n.offset(n.parent(t)).top-n.scrollTop(window)>50||(a.remove(window,"scroll",s),e.use("malldetail/control/floatbar",function(e,a){self.floatBar=self.floatBar||new a({"el":t,"cls":b,"top":"990"==window.g_config.pw?40:0})}))}var d,u=c.config,m=u.descAnchors,p={};if(m&&m.length){for(var f=[],h=0;h<m.length;h++)"cat_mod"==m[h].type&&f.push(m[h].moduleId);p.moduleIdGroup=f.join("_"),d="tmalldetail.66.0",codeTrack("model.ids.descAnchors","model.ids.init")}else m=u.idsMod,d="tmalldetail.16.1",codeTrack("model.ids.idsMod","model.ids.init");if(u.detail&&!0===u.detail.isShowEcityDesc?(m=m||[],m.length||m.push({"anchor":"description","name":"\u5546\u54c1\u8be6\u60c5"}),m.unshift({"anchor":"J_ServiceTab","name":"\u5929\u732b\u7535\u5668\u57ce\u670d\u52a1"}),m.push({"anchor":"J_ShopService","name":"\u5e97\u94fa\u670d\u52a1\u8be6\u60c5"}),m.push({"anchor":"J_Faq","name":"\u5e38\u89c1\u95ee\u9898"})):m&&m.length&&n.get("#J_SellerInfo")&&m.push({"anchor":"J_SellerInfo","name":"\u670d\u52a1\u8d28\u91cf"}),TShop.onProduct(function(e){e.onLoad(["bucketId"],function(e){u.tag&&u.tag.isShowMeiliXinde&&i.bucketStat(e,window.g_config.beautyBucketTestIdArray)&&(m=m||[],m.length||m.push({"anchor":"description","name":"\u5546\u54c1\u8be6\u60c5"}),m.unshift({"anchor":"J_DtlentryBox","name":"\u4e70\u5bb6\u6652\u5355"}))})}),m&&m.length&&m.length>=3){var v=n.viewportHeight()<40*m.length+40,k=n.create('<dl id="J_DescCate" class="tm-descCate'+(v?" tm-descCateMini":"")+'"></dl>');e.each(m,function(t){t.moduleName&&(t.moduleName=e.escapeHTML(t.moduleName))}),k.innerHTML=t({"data":m}),y.mods=m,n.append(k,c.parentEl),6==o.ie&&(c.parentEl.style.height=screen.availHeight+"px"),n.show(c.parentEl),a.on(k,"click",r),g=u&&u.detail&&u.detail.isShowContentModuleTitle,l(g),6!==e.UA.ie&&(a.on(window,"scroll",s),s()),"990"==window.g_config.pw&&(codeTrack("model.ids.w990","model.ids.init"),e.one(c.parentEl).on("mouseenter",function(t){if(!e.one("html").hasClass("w1190")){var a=e.one(this);setTimeout(function(){a.addClass("tm-bd-side-expend")},200)}}).on("mouseleave",function(t){var a=e.one(this);setTimeout(function(){a.removeClass("tm-bd-side-expend")},200)})),TShop.sendAcAtpanel(d,p)}}var m,p,f,h,v,g,b="tm-descCate-float",y={};return{"init":function(e){codeTrack("model.ids.init","mod.other.init"),u(e)},"lightStatu":function(){return p}}},{"requires":["malldetail/other/idsMod.tpl","event","dom","ua","malldetail/common/util","malldetail/other/idsMod.css"]});