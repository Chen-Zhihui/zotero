KISSY.add("tbc/xmpp/1.0.9/mods/maidian",function(a,b){function c(b){var c="_point_"+a.now(),d=window[c]=new Image,e="//gm.mmstat.com/tbpaimai."+b+"?market=";d.onload=d.onerror=function(){window[c]=null},d.src=e,d=null}function d(a,d,e,f){"dynamic"==f?b.delegate(document,d,a,function(){c(e)}):b.on(a,d,function(){c(e)})}return{toPoint:d,makePoint:c}},{requires:["event"]}),KISSY.add("tbc/xmpp/1.0.9/mods/session",function(a,b,c,d,e){"use strict";function f(a,b,c,d){var e=this;return e instanceof f?(e._init(a,b,c),void e._setup(a,d)):new f(a,b,c,d)}var g,h=location.host,i=function(a,b){return Array.prototype.slice.call(a,b||0)},j=function(b,c){var d=b.indexOf("?")>-1?"&":"?";return b+d+(a.isObject(c)?a.param(c):c)},k=c.get("_nk_"),l=-1==h.indexOf("daily"),m=/\.(\w+)\.(?:net|com)/,n=h.match(m)||["www","taobao"],o=n[1];return"alitrip"===o&&(o="taobao"),n&&o&&(g=l?o+".com":"daily."+o+".net"),f.ATTRS={param:{value:{}},isStop:{value:!1},io:{value:{}}},a.extend(f,b,{constructor:f,_Events:{},_Session:{},_init:function(b,c,d){var f=this,h=f._Session;if(f.tryCnt=0,f.connected=!1,!h[c]){h[c]=!0;var i=document.createElement("div");i.id="J_"+b,document.body.appendChild(i),d=a.merge(d,{group:c,mppServer:g});var j=function(){};"function"==typeof window.onload&&(j=window.onload),window.onload=function(){j(),setTimeout(function(){f.connected||(f.connected=!0,f.createConnection(b,d))},100)},setTimeout(function(){f.connected||(f.connected=!0,f.createConnection(b,d))},1e3),e.makePoint("6.11")}},_setup:function(a,b){var c=this,d=c._Events[a];d||(d=c._Events[a]=[]),d.push(b)},createConnection:function(b,f){var g=this,h=g.get("isStop");if(!h){var i=c.get("_nk_"),l="//mpp."+f.mppServer+j("/buildconnection.do",f)+"&t="+(new Date).getTime(),m=function(c){if(!c)return!1;var d=c.type;if("2"==d){var e,h,i=c.st,j=0,k=i.length,l=f.v.split(","),m=(f.id||f.itemId).split(",");if(k){for(;k>j;j++)h=i[j],e=a.indexOf(h.i,m),parseInt(l[e],10)<h.v&&(l[e]=h.v,g.notify(b,h.content));f.v=l.join(","),f.msg=!0}}"1"==d&&(f.msg=!1);var n=c.cmd,o=+c.ext||10;("1"==d||"2"==d)&&(n&&"1"==n&&o?setTimeout(function(){g.createConnection(b,f)},1e3*o*Math.random()):g.createConnection(b,f)),"5"==d&&(location.href="http://www.taobao.com/go/act/share/loginsuccess.php")};f&&f.key&&(l+="&key="+f.key),i!==k&&location.replace(location.href);var n=new d({type:"get",url:l,dataType:"jsonp",timeout:90,jsonp:"jsonp",success:m,error:function(a,c){"abort"!==c&&("timeout"===c?(e.makePoint("6.12"),g.createConnection(b,f)):(e.makePoint("6.13"),setTimeout(function(){g.tryCnt++<3&&g.createConnection(b,f)},3e3+1e3*Math.ceil(40*Math.random()))))}});g.set("io",n)}},notify:function(a){for(var b,c=this,d=c._Events[a],e=0,f=d.length;f>e;e++)b=d[e],b&&b.apply(null,i(arguments,1))}}),f},{requires:["base","cookie","ajax","./maidian"]}),KISSY.add("tbc/xmpp/1.0.9/index",function(a,b){var c=a.namespace("TBC.xmpp"),d=window.g_config&&+window.g_config.xmppMax||100;return a.mix(c,{ids:[],session:"",cfg:{},callback:function(){},register:function(a,b){var c=this;c.cfg=a,c.callback=b;var d=/xclose/.test(location.search);return d?!1:(c.session&&c.stop(),c._cacheIds(a),void c.connect(a))},connect:function(c){for(var e,f,g=this,h=a.clone(g.ids),i=Math.ceil(h.length/d),j=0;i>j;j++)c.id=h.splice(0,d).join(","),g._addVersion(c),e="xmpp"+(new Date).getTime()+j,f=e+"-"+c.appId+"-"+(c.subType||""),g.session=new b(f,e,c,g.callback)},remove:function(b){var c=this,d=-1,e=a.clone(c.ids);a.each(b.id.split(","),function(b){d=a.indexOf(b,e),d>-1&&e.splice(d,1)}),c.ids=e},stop:function(){var a=this;a.session.set("isStop",!0);var b=a.session.get("io");b&&b.abort&&b.abort()},start:function(){var a=this;a.session.set("isStop",!1),a.register(a.cfg,a.callback)},_cacheIds:function(a){var b=this,c=a.id||a.itemId;b.ids=b.ids.concat(c&&c instanceof Array?c:c.split(","))},_addVersion:function(a){var b,c=0;b=a.id.split(",").length,a.v=new Array(b+1).join(c+",").replace(/,$/,"")}}),c},{requires:["./mods/session"]});/*! mini-login 2015-10-26 */
KISSY.add("tbc/mini-login/2.2.5/index",function(a,b,c,d,e,f,g){var h="https:"===location.protocol?"https:":"http:",i=a.unparam(location.search.slice(1))._login_daily_,j=k?"//g-assets.daily.taobao.net/":"//g.alicdn.com/",k=i||-1!==location.host.indexOf(".daily."),l=6===f.ie,m=!1;try{m=!!window.navigator.userAgent.match(/WindVane/i)}catch(n){}var o="1.4.6",p=k?"daily.taobao.net":"taobao.com",q=h+"//buy."+p+"/auction/buy.htm?from=tbcminilogin?_minilogin_t_={t}",r=h+"//member1."+p+"/member/info/login_status.do?_minilogin_t_={t}",s=h+"//www.taobao.com/go/act/loginsuccess/taobao.php",t="https://login."+p+"/member/login.jhtml?style=mini&newMini=true&is_ignore=false&redirect_url="+window.encodeURIComponent(s),u="https://login."+p+"/member/login.jhtml?redirect_url="+window.encodeURIComponent(location.href),v="http://login.m.taobao.com/login.htm?tpl_redirect_url="+encodeURIComponent(location.href),w=".#{prefixCls}mini-login{display:none;width:#{width}px;height:#{height}px;opacity:1;color:#404040;position:fixed;_position:absolute;z-index:#{zindex};}.#{prefixCls}mnl-bg{position:absolute;z-index:0;width:100%;height:100%;border:5px solid #999;left:-5px;top:-5px;opacity:0.8;}.#{prefixCls}mnl-box{position:relative;z-index:1;background:#fff;}.#{prefixCls}mnl-hd{height:34px;line-height:34px;padding-left:14px;font-family:Arial,Helvetica,sans-serif;font-weight:700;font-size:14px;margin-bottom:15px;border-bottom:1px solid #EAEAEA;background-color:#f2f2f2;}.#{prefixCls}mnl-ifr{display:block;width:#{ifrwidth}px;height:#{ifrheight}px;margin:0 auto;}.#{prefixCls}mnl-ft{background-color:#F5F5F5;}.#{prefixCls}mnl-close{display:block;width:24px;height:24px;text-align:center;line-height:24px;color:#999;font-family:Tahoma,sans;font-size:22px;position:absolute;text-decoration:none;top:5px;right:5px;opacity:0.8}.#{prefixCls}mnl-close:hover{opacity:1;border-radius:12px;background:#FFF;text-decoration:none;}",x='<div id="J_MiniLogin_{guid}" class="{prefixCls}mini-login"><div class="{prefixCls}mnl-bg"></div><div class="{prefixCls}mnl-box"><div class="{prefixCls}mnl-hd">{title}</div><div class="{prefixCls}mnl-bd"><iframe class="{prefixCls}mnl-ifr" scrolling="no" frameborder="no" id="J_MiniLoginIfr_{guid}" src="{url}"></iframe></div><div class="{prefixCls}mnl-ft"><a class="{prefixCls}mnl-close" id="J_MiniLoginClose_{guid}" target="_self" title="\u5173\u95ed\u6b64\u7a97\u53e3" href="javascript:void(0)">\xd7</a></div></div></div>',y=window.goldlog||{record:function(){}};y.record("/minilogin.10.1","","","H46866756");var z=window.g_config?g_config.loginCfg:{},A=a.merge({width:320,height:418,title:"\u8d26\u6237\u767b\u5f55",type:"m",sub:0,zindex:1e8},z||{}),B=[],C=function(b){return this instanceof C?(this.cfg=a.merge(A,b||{}),this.guid=a.guid(),this.type=this.cfg.type,this.sub=this.cfg.sub,this.zindex=this.cfg.zindex,this.checkapi=2===this.cfg.checkapi?2:1,this.cfg.guid=this.guid,this.cfg.ifrwidth=this.cfg.width-70,this.cfg.ifrheight=this.cfg.height-50,this.cfg.url=t,this.cfg.zindex=this.zindex,void this._init()):new C(b)};return a.augment(C,d.Target,{_init:function(){try{this.nick=TB.Global.util.getNick()}catch(a){}y.record("/minilogin.10.2","","","H46866778")},_create:function(){var d=a.substitute(w,this.cfg,/#\{([^{}]+)\}/g),e=a.substitute(x,this.cfg);c.addStyleSheet(d),this.el=b.one(c.create(e)),c.append(this.el,document.body),this.ifr=b.one("#J_MiniLoginIfr_"+this.guid),this._bind()},_bind:function(){var a=this;b.all("#J_MiniLoginClose_"+this.guid).on("click",function(b){b.halt(),a.hide(!1)}),this.ifr.on("load",function(b){return"about:blank"!==a.ifr.attr("src")?a.ifr.data("inited")?0===a.ifr.attr("src").indexOf(s)?void a._successHandle():0===a.ifr.attr("src").indexOf(t)?void a._checkAndShow(!0):void 0:void a.ifr.data("inited",1):void 0})},_pos:function(){var b,d,e=this.cfg.position;a.isObject(e)?(b=e.left||0,d=e.top||0):(b=parseInt(c.viewportWidth()/2,10)-parseInt(this.el[0].offsetWidth/2,10)+"px",d=(l?c.scrollTop():0)+parseInt(c.viewportHeight()/2,10)-parseInt(this.el[0].offsetHeight/2,10)+"px"),this.el.css({top:d,left:b})},_errorHandle:function(){window.top.location.href=m?v:u,y.record("/minilogin.10.11","","","H46896547")},_successHandle:function(b){var c=this;this.callbacked||(this.callbacked=!0,this.hide(!0),this.fire("login",{showed:!b}),a.each(B,function(a){a.fire("anylogin"),a.guid!=c.guid&&a.fire("otherlogin")}),this.callback&&this.callback(),this.callback=null,this._refreshGlobal(),y.record("/minilogin.10.10","","","H46896546"))},_refreshGlobal:function(){try{var a=TB.Global.util.getNick();if(a===this.nick)return;TB.Global.reload(),this.nick=a}catch(b){}},_localCheck:function(a){var b=e.get("_l_g_"),c=e.get("lgc"),d=e.get("tracknick");return"l"===this.type?void a(!!c):(a(null,b&&d),void y.record("/minilogin.10.6","","","H46866782"))},_asyncCheck:function(b){var c=this,d=1===this.checkapi?q:r;d=a.substitute(d,{t:a.now()}),1===this.checkapi?g.getScript(d,function(){return loginIndicator&&a.isObject(loginIndicator)?void(loginIndicator.hasLoggedIn?b(null,!0):b(null,!1)):(b(new Error("ErrCheckByBuy")),void y.record("/minilogin.10.9","","","H46866785"))}):g({url:d,type:"get",dataType:"jsonp",timeout:5,complete:function(d){return d&&a.isObject(d)?void(d.ma?b(!0):c.sub&&d.sa?b(null,!0):b(null,!1)):(b(new Error("ErrCheckByMember1")),void y.record("/minilogin.10.8","","","H46866784"))}}),y.record("/minilogin.10.7","","","H46866783")},check:function(a){"l"===this.type?this._localCheck(a):this._asyncCheck(a),y.record("/minilogin.10.5","","","H46866781")},_windVaneShow:function(){var a=this;g.getScript(j+"mtb/lib-windvane/"+o+"/windvane.js",function(){try{WindVane.call("TBHDCommon","login",{},function(b){a._successHandle()},function(b){a._errorHandle()})}catch(b){a._errorHandle()}})},_show:function(){return m?void this._windVaneShow():(this.el||this._create(),this.ifr.attr("src",t),this.el.show(),this._pos(),this.showed=!0,void b.one(window).on(l?"scroll resize":"resize",this._pos,this))},_checkAndShow:function(a){var b=this;this.check(function(c,d){if(c)return void b._errorHandle();if(d===!0)b._successHandle(a?!1:!0);else{if(b.ifr&&1===b.ifr.data("inited"))return;b._show()}})},show:function(a){this.callback=a,this._checkAndShow(),y.record("/minilogin.10.3","","","H46866779")},hide:function(a){this.callbacked=!1,y.record("/minilogin.10.4","","","H46866780"),this.el&&this.showed&&(this.el.hide(),this.showed=!1,this.callback=null,this.ifr.attr("src","about:blank"),this.ifr.data("inited",0),a?this.fire("hide"):this.fire("close"),b.one(window).detach(l?"scroll resize":"resize",this._pos,this))}}),C},{requires:["node","dom","event","cookie","ua","ajax"]});KISSY.add("kg/modal/1.5.2/index",["base","node","event","promise","ua","kg/xtemplate/3.3.3/runtime","kg/modal/1.5.2/index.css"],function(e,t,a,n){{var o,i,l=t("base"),s=t("node"),d=t("event"),r=t("promise"),c=t("ua"),m=t("kg/xtemplate/3.3.3/runtime");t("kg/modal/1.5.2/index.css")}o=function(e){var t=e=function(e){function t(e,t,a){var n=e.data,i=e.affix;t.data+='\n                <p class="modal-title">',r.line=7;var l=(o=i.title)!==a?o:(o=n.title)!==a?o:e.resolveLooseUp(["title"]);return t=t.write(l),t.data+="</P>\n                ",t}function a(e,t,a){var n=e.data,i=e.affix;t.data+="\n                  ",r.line=15;var l=(o=i.otherBtn)!==a?o:(o=n.otherBtn)!==a?o:e.resolveLooseUp(["otherBtn"]);return t=t.write(l),t.data+="\n                ",t}function n(e,t,a){var n=e.data,i=e.affix;t.data+='\n                <a class="btn btn-confirm" tabindex="11">',r.line=18;var l=(o=i.confirmBtn)!==a?o:(o=n.confirmBtn)!==a?o:e.resolveLooseUp(["confirmBtn"]);return t=t.writeEscaped(l),t.data+="</a>\n                ",t}{var o,i=this,l=i.root,s=i.buffer,d=i.scope,r=(i.runtime,i.name,i.pos),c=d.data,m=d.affix,f=l.nativeCommands,v=l.utils,h=(v.callFn,v.callCommand,f.range,f.foreach,f.forin,f.each,f["with"],f["if"]);f.set,f.include,f.parse,f.extend,f.block,f.macro,f["debugger"]}s.data+='<div class="vc-modal';var u=" ",p=(o=m.cls)!==e?o:(o=c.cls)!==e?o:d.resolveLooseUp(["cls"]);u=" "+p,s=s.writeEscaped(u),s.data+='"  tabindex="1">\n    <div class="modal-dialog';var g=" ";r.line=2;var B=(o=m.effect)!==e?o:(o=c.effect)!==e?o:d.resolveLooseUp(["effect"]);g=" "+B,s=s.writeEscaped(g),s.data+='">\n        <div class="modal-content">\n            <div class="modal-header">\n                <i class="close vc-modal-iconfont">&#xe600;</i>\n                ',r.line=6,r.line=6;var x=(o=m.title)!==e?o:(o=c.title)!==e?o:d.resolveLooseUp(["title"]);s=h.call(i,d,{params:[x],fn:t},s),s.data+='\n            </div>\n            <div class="modal-body">\n              ',r.line=11;var b=(o=m.content)!==e?o:(o=c.content)!==e?o:d.resolveLooseUp(["content"]);s=s.write(b),s.data+='\n            </div>\n            <div class="modal-footer">\n                ',r.line=14,r.line=14;var $=(o=m.otherBtn)!==e?o:(o=c.otherBtn)!==e?o:d.resolveLooseUp(["otherBtn"]);s=h.call(i,d,{params:[$],fn:a},s),s.data+="\n                ",r.line=17,r.line=17;var w=(o=m.confirmBtn)!==e?o:(o=c.confirmBtn)!==e?o:d.resolveLooseUp(["confirmBtn"]);s=h.call(i,d,{params:[w],fn:n},s),s.data+='\n                <a class="btn btn-close" tabindex="12">',r.line=20;var y=(o=m.cancelBtn)!==e?o:(o=c.cancelBtn)!==e?o:d.resolveLooseUp(["cancelBtn"]);return s=s.writeEscaped(y),s.data+="</a>\n            </div>\n        </div>\n    </div>\n\n</div>\n",s};return t.TPL_NAME=n.id||n.name,e}(),i=function(t){function a(e,t){var a=new p(e);return a.render(t)}var i=l,f=s,v=d,h=r,u=c,p=m,g=o,B=(f.all,0),x={effect:"fadeInDown",cls:"",title:"确认",cancelBtn:"关闭",emptyExe:!0},b=f.one("body");return t=i.extend({renderAppend:function(t,n){var o=this;t=t||o.get("tpl"),n=n||o.get("data");var i=a(t,n),l=e.one(i);b.append(l),o.fire("render",{$modal:l}),this.$modal=l,this.$dialog=l.one(".modal-dialog")},initializer:function(){var t=this;this.autoHide=!0;var a=this.get("effect"),n=this.get("cls"),o=this.get("title"),i=this.get("content"),l=this.get("confirmBtn"),s=this.get("cancelBtn"),d=this.get("otherBtn"),r=this.get("emptyExe"),c={};a&&(c.effect=a),n&&(c.cls=n),o&&(c.title=o),i&&(c.content=i),l&&(c.confirmBtn=l),s&&(c.cancelBtn=s),d&&(c.otherBtn=d),null!=r&&(c.emptyExe=r);var m=e.merge(x,c);this.set("data",m),this.get("tpl")||this.set("tpl",g),this.renderAppend(),this.$modal.on("click.modal.type1",function(e){if(m.emptyExe){var a=f.one(e.target);a.hasClass("vc-modal")&&t.hide()}}),v.delegate(this.$modal,"click.modal",".close",function(e){e.preventDefault(),t.hide()});this.get("confirmFun"),this.get("closeFun");v.delegate(this.$modal,"click.modal",".btn-confirm",function(e){t.fire("confirm.modal",{modal:t.$modal}),e.preventDefault(),t.autoHide&&t.defer.resolve(),t.autoHide=!0}),v.delegate(this.$modal,"click.modal",".btn-close",function(e){t.fire("cancel.modal",{modal:t.$modal}),e.preventDefault(),t.autoHide&&t.defer.reject(),t.autoHide=!0}),this.$modal.on("keypress.modal",function(){var e=f.one(document.activeElement);e.parent(".vc-modal")&&document.activeElement.click()})},show:function(t,a,n){var o=this;e.isFunction(t)?t.call({modal:o.$modal}):e.isString(t)&&this.$modal.one(".modal-body").html(t);try{a&&a.call(this)}catch(i){}b.addClass("modal-show"),this.$modal.css("display","block"),document.body.offsetWidth,this.$modal.addClass("in"),B++;try{n&&n.call(this)}catch(i){}o.defer=new h.Defer;var l=o.defer.promise;return l.done(function(){o.hide()},function(){o.hide()}),l},hide:function(){var e=this;B--,u.ie&&u.ie<=8?(this.$modal.removeClass("in").removeAttr("style"),b.removeClass("modal-show")):(this.$modal.removeClass("in"),setTimeout(function(){e.$modal.removeAttr("style"),b.removeClass("modal-show")},300))},closeAutoHide:function(){this.autoHide=!1},hasModelShow:function(){return B},destroy:function(){this.$modal.hasClass("in")||this.$modal.remove()}},{ATTRS:{tpl:{value:""},data:{value:{}}}}),n.exports.hasModelShow=function(){return B},t}(),n.exports=i});