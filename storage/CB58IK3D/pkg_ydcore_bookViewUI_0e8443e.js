define("ydcore:widget/ui/book_view/toolsArea/item/back.js",function(e,i,o){var r=(e("ydcommon:widget/ui/lib/jquery/jquery.js"),function(e){return});o.exports.Back=r});
;define("ydcore:widget/ui/book_view/toolsArea/item/title.js",function(t,e,i){var a,s=t("ydcommon:widget/ui/lib/jquery/jquery.js"),n=t("ydcommon:widget/ui/js_core/mvp/view/view.js").View,l={};l.lang=t("ydcommon:widget/ui/lib/lang/lang.js"),a=l.lang.createClass(function(t){this._init(t)},{superClass:n}).extend({_init:function(t){var e=this;s.extend(e,t),e.$applyEl.append(s(e.renderView(e.template,{}))),e._setPayState(),e._bindEvent(),e.setTitle()},template:{view:['<div class="title">','<div class="title-text"></div>',"</div>",'<div class="percent">','<div class="percent-text"></div>',"</div>"].join(""),type:"template"},_bindEvent:function(){},_setPayState:function(){var t=this;
t.ispaied?(t.payState='<span class="title-pay-status">(\u5df2\u8d2d\u4e70)</span>',t.vipFreeBuy&&(t.payState='<span class="title-pay-status title-member-free">(\u4f1a\u5458\u514d\u8d39\u9605\u8bfb)</span>')):t.payState='<span class="title-pay-status">(\u8bd5\u8bfb)</span>'},setTitle:function(t){var e=this;t||(t=e.docTitle+e.payState),e.$applyEl.find(".title-text").html(t)}}),i.exports.Title=a});
;define("ydcore:widget/ui/book_view/toolsArea/item/pay.js",function(e,i,t){var a=e("ydcommon:widget/ui/lib/jquery/jquery.js"),s=e("ydcommon:widget/ui/js_core/mvp/view/view.js").View,o=(e("ydcommon:widget/ui/js_core/login/login.js"),e("ydcommon:widget/ui/js_core/qrcode/qrcode.js")),c=e("ydcommon:widget/lib/fis/data/data.js"),r={};r.lang=e("ydcommon:widget/ui/lib/lang/lang.js"),r.string=e("ydcommon:widget/ui/lib/string/string.js"),Pay=r.lang.createClass(function(e){this._init(e)},{superClass:s}).extend({_init:function(e){var i=this;
a.extend(i,e,{leaveFlag:"",lastPrice:(i.payprice/100).toFixed(2),userSwitch:!0}),i._fixUtil(),i.$el=i.$applyEl.html(i._getTpl()),i.$switchs=i.$el.find(".switchs"),i.$center=i.$toolsBar.find(".center"),i.switchsWidth=i.$switchs.width(),i.switchsRight=i.$switchs.offset().left+i.switchsWidth,i.switchsLeft=parseInt(i.$switchs.css("left"))||32,i.isTxtReader&&i._createQrcode(),i._backLogic(),i.bindEvent(),i.isTxtReader||i._resize()},_fixUtil:function(){var e=this;e.Util=e.Util||{},e.Util.subStrFromMiddle=e.Util.subStrFromMiddle||function(e,i){var t=String(e),a=r.string.getByteLength(t);
if(a>i){var s=t.substr(0,t.length-5),o=t.slice(-3);for(t=s+"..."+o,a=r.string.getByteLength(t);a>i;)s=s.substr(0,s.length-Math.max(1,Math.floor((a-i)/2))),t=s+"..."+o,a=r.string.getByteLength(t)}return t}},_getTpl:function(){var e=this,i=['<div class="item-wrap back-wrap">','<a href="'+(e.hasBookDetail?"/ebook/"+e.doc_id:"/")+'" class="back">','<b class="ic ic-back tools-btn-ic"></b>','<span class="back-text tools-btn-text">\u9000\u51fa\u9605\u8bfb</span>',"</a>","</div>"].join(""),t="",s=c.get("is_self_pub")||!1,o=c.get("canGetBookFree"),r=["2d35a24cbb68a98270fefa15"],l=c.get("ispaied")||!1;
if(e.isTxtReader&&(!s||-1!==a.inArray(e.doc_id,r))&&o&&!l){var d="";t=['<div class="book-qcode"'+d+">",'<a class="qcode-img" href="#">','<img class="qrcode-flag" src="https://yuedu-cms.bj.bcebos.com/v1/oldicms/a1e9e1a3c35ec127b1d95bd71cf4f52b-1494301046020.png">','<img class="qrcode-cover" src="'+__http2https(e.coverSrc)+'" data-docid="'+e.doc_id+'" alt="" />',"</a>",'<p class="qrcode-price"><span>&yen; </span>0</p>','<p class="qrcode-phone"><span></span>\u624b\u673a\u4e13\u4eab\u4ef7</p>','<p class="qrcode-text">\u626b\u7801\u514d\u8d39\u4e0b\u8f7d\u8be5\u4e66<br/>\u518d\u9001<span>20\u5143\u4ee3\u91d1\u5238</span></p>',"</div>",'<div class="pay-end"'+d+"></div>"].join("")
}t+=['<div class="pay-boundary">','<a class="switchs" href="#"></a>',"</div>",'<div class="book-info-wrap">','<div class="book-title">','<span class="title-text" title="'+e.docTitle+'">'+e.Util.subStrFromMiddle(e.docTitle,28)+"</span>","</div>",'<div class="book-cover">','<a href="/ebook/'+e.doc_id+'" target="'+(e.hasBookDetail?"_blank":"_self")+'">','<img src="'+__http2https(e.coverSrc)+'" alt="'+e.docTitle+'" class="cover-img">',"</a>","</div>",'<div class="book-pay">',e._getPayHtml(),"</div>","</div>"].join("");
var d=e.isPreview?' style="visibility: hidden;"':"";t=[i,'<div class="pay-inner-wrap">','<div class="pay-area-wrap"'+d+">",t,"</div>","</div>"].join(""),t+='<div class="gkfhc-daoliu"><img src="https://edu-wenku.bdimg.com/v1/pc/ydfhcqrcode-1526522181428.png" /><div>\u626b\u7801\u514d\u8d39\u8bfb\u6b64\u4e66<div class="gkfhc-txt">\u65b0\u7528\u6237\u518d\u9001<span>\xa520\u4ee3\u91d1\u5238</span></div></div></div>';var n=new Date("2018-07-17"),p=n.getTime()-288e5,v=+new Date;return p>v&&a.ajax({url:"/xpage/form/getform",dataType:"json",data:{id:"yuedu_fhc_booklist",complete:0},success:function(i){if(i.data&&i.data.form_data&&i.data.form_data.list){var t=i.data.form_data,s=t.list.split("\r\n");
-1!==a.inArray(e.doc_id,s)&&a(".gkfhc-daoliu").show()}},error:function(){}}),t},_getPayHtml:function(){var e=this,i='<span class="pay-value mr10">\uffe5'+(e.payprice/100).toFixed(2)+"</span>",t="PCActivity"==e.goodsPayStatus.split("_")[0],a=("OtherActivity"==e.goodsPayStatus.split("_")[0],"WeekendActivity"==e.goodsPayStatus.split("_")[0]),s="Discount"==e.goodsPayStatus.split("_")[1],o=e.vip_type||t?" pay-vip-value":"";if(e.isNAGuide){var r="";return e.is_all_free||(r=r+'<a href="###" class="go-buy-view pay-btn" alog-action="buy.book.view">\u8d2d\u4e70\uffe5'+(e.confirm_price/100).toFixed(2)+"</a>"),r
}if(e.is_all_free)return e.ispaied?'<span class="paied-btn"></span>':['<a href="###" class="bt ui-btn ui-btn-pay-gray42 get-by-free" data-doc-id="'+e.doc_id+'">',"\u514d\u8d39\u9886\u53d6","</a>"].join("");if(a)i=['<span class="o-value mr10">\u539f\u4ef7\uff1a\uffe5'+(e.payprice/100).toFixed(2)+"</span>","<br/>",'<span class="vip-value mr10">\u5468\u672b\u7279\u60e0\uff1a\uffe5'+(e.confirm_price/100).toFixed(2)+"</span>"].join(""),e.lastPrice=(e.confirm_price/100).toFixed(2);else if(t)i=['<span class="o-value mr10">\u539f\u4ef7\uff1a\uffe5'+(e.payprice/100).toFixed(2)+"</span>","<br/>",'<span class="vip-value mr10">\u4fc3\u9500\u4ef7\uff1a\uffe5'+(e.confirm_price/100).toFixed(2)+"</span>"].join(""),e.lastPrice=(e.confirm_price/100).toFixed(2);
else if(e.vip_type>0&&s){var l=c.get("is_self_pub");i=['<span class="o-value mr10">\u539f\u4ef7\uff1a\uffe5'+(e.payprice/100).toFixed(2)+"</span>","<br/>"].join(""),l||(i=i+'<span class="vip-value mr10">\u6587\u5e93VIP\u4ef7\uff1a\uffe5'+(e.vip_price/100).toFixed(2)+"</span>"),e.lastPrice=(e.vip_price/100).toFixed(2)}var d='<a href="#" class="pay-btn daoliu" alog-action="buy.book.view">\u7acb\u5373\u8d2d\u4e70</a>';"NoneActivity_Free_Vip"===e.goodsPayStatus||"NoneActivity_Only_Vip"===e.goodsPayStatus?(d='<span class="vip-free-btn"></span>',o+=" hidden"):e.ispaied&&(d='<span class="paied-btn"></span>',o+=" hidden");
var n=[d,'<div class="pay-value-wrap'+o+'">',i,"</div>"].join("");return n},_createQrcode:function(){var e=this,i=a(".qcode-img",e.$el)[0],t=location.protocol+"//yd.baidu.com/apps?dynamicqrcode=1&actionType=unlimited_present&fr=1052&present_bookid="+this.doc_id;i&&new o(i,{text:t,width:96,height:96,colorDark:"#000000",colorLight:"#ffffff",correctLevel:o.CorrectLevel.L})},_backLogic:function(){var e=this,i=e.$el.find("a.back");if(e.backRight=i.offset().left+i.width(),e.$backWrap=i.parent(),e.isLocalPreview||e.isSelfPreview){var t="/bookeditor/editor?book_id="+e.doc_id;
e.isSelfPreview&&(t="/bookeditor/selfeditor?book_id="+e.doc_id),i.get(0).href=t,i.click(function(i){e.mediator.fire("v:back-to-editor"),!window.opener||"/bookeditor/editor"!==window.opener.window.location.pathname&&"/bookeditor/selfeditor"!==window.opener.window.location.pathname||(i.preventDefault(),window.close())})}else i.click(function(){e.leaveFlag="back"})},_resize:function(){var e=this;e.$el.height(e.$win.height()),e._dealSwitchs()},_dealSwitchs:function(e){var i=this,t=i.$center.offset().left,a=t-i.backRight;
if(0>a&&!e?i.$backWrap.hide():i.$backWrap.show(),i.userSwitch){if(a=t-i.switchsRight,a<-i.switchsWidth){if(!e)return i.$el.addClass("hide-pay-area").removeClass("move-switchs"),void i.$switchs.removeAttr("style")}else if(30>a)return i.$el.removeClass("hide-pay-area").addClass("move-switchs"),void i.$switchs.css("left",a+i.switchsLeft+i.switchsWidth);i.$el.removeClass("hide-pay-area").removeClass("move-switchs"),i.$switchs.removeAttr("style")}},bindEvent:function(){var e=this,i=e.mediator;i.on("v:windowResize",a.proxy(e._resize,e)),i.on("tools:get-last-pay-price",function(i){var t=i.promise;
return t.resolve(e.lastPrice),t}),a(".pay-btn",e.$el).click(function(t){t.preventDefault(),i.fire("p:tools-area-send-x-log",{data:{act_id:"200039",price:e.lastPrice}}),a("body").trigger("pay.start",{pos:"buy.book.view"}),e.$toolsBar.trigger("log:send",{logAct:"pay.click"})}),a(".switchs",e.$el).click(function(i){i.preventDefault(),e.$el.toggleClass("hide-pay-area"),e.userSwitch=!e.$el.hasClass("hide-pay-area"),e.userSwitch?e._dealSwitchs(!0):(e.$el.removeClass("move-switchs"),e.$switchs.removeAttr("style"),e._dealSwitchs(),e.$toolsBar.trigger("log:send",{logAct:"pay.close"}))
}),e.$el.on("click",".download-app",function(){e.$toolsBar.trigger("log:send",{logAct:"pay.app"})}).on("click",".book-cover a",function(){e.leaveFlag="cover",i.fire("p:tools-area-send-x-log",{data:{act_id:"200041",type:3}})}).on("click",".join-vip",function(){e.$toolsBar.trigger("log:send",{logAct:"pay.vip"}),i.fire("p:tools-area-send-x-log",{data:{act_id:"200040"}})}),e.$win.on("beforeunload",function(){"cover"!==e.leaveFlag&&i.fire("p:tools-area-send-x-log",{data:{act_id:"200041",type:"back"===e.leaveFlag?2:1}}),e.leaveFlag="";
for(var t=1e5,a=0;t-->0;)a=t})}}),t.exports.Pay=Pay});
;define("ydcore:widget/ui/book_view/toolsArea/item/catalog.js",function(a,t,o){var i=a("ydcommon:widget/ui/lib/jquery/jquery.js"),e=a("ydcommon:widget/ui/js_core/mvp/view/view.js").View,l=a("ydcommon:widget/ui/js_core/mvp/template/template.js"),s={},n=["<%for(var i = 0; i < data.length; i++){%>","<%if(data[i].page <= freePageNum ){%>","<li><a class='<%if(i == data.length - 1){%>last-item <%}%>catalog-item' href\uff1d'#' title='<%=util.encodeHTML(data[i].title)%>' page='<%=data[i].page%>' target='_self'>","<span class='catalog-title'><b class='ic ic-catalog-point'></b><%=util.encodeHTML(data[i].title)%></span>","<span class='catalog-page'><%=data[i].page%></span>","</a></li>","<%} else {%>","<li><span class='<%if(i == data.length - 1){%>last-item <%}%>catalog-item out-of-range' href\uff1d'#' title='<%=util.encodeHTML(data[i].title)%>' page='<%=data[i].page%>'>","<span class='catalog-title'><b class='ic ic-catalog-point'></b><%=util.encodeHTML(data[i].title)%></span>","<span class='catalog-page'><%=data[i].page%></span>","</span></li>","<%}%>","<%}%>"].join(""),c=['<div class="catalog-box no-select-range" tabIndex="-1" hideFocus=true>','<div class="catalog-loading">',"\u6b63\u5728\u52aa\u529b\u8f7d\u5165\uff0c\u8bf7\u7a0d\u540e\uff5e\uff5e","</div>",'<div class="catalog-container">','<div class="scrollbar">','<div class="track">','<div class="thumb">','<div class="end"></div>','<div class="bottom"></div>',"</div>","</div>","</div>",'<div class="viewport">','<ul class="overview"></ul>',"</div>","</div>","</div>"].join(""),d=["<div class='no-catalog'>","<b class='ic ic-book'></b>","<p>\u6682\u65e0\u76ee\u5f55\uff0c\u8bf7\u7ee7\u7eed\u671f\u5f85\uff5e\uff5e</p>","</div>"].join("");
a("ydcore:widget/ui/book_view/lib/tinyscrollbar/tinyscrollbar.js"),s.lang=a("ydcommon:widget/ui/lib/lang/lang.js"),s.string=a("ydcommon:widget/ui/lib/string/string.js"),s.url=a("ydcommon:widget/ui/lib/url/url.js");var r=s.lang.createClass(function(a){this._init(a)},{superClass:e}).extend({_init:function(a){var t=this;i.extend(t,a,{catalogLoaded:!1,hasCatalog:!1});var o=['<a href="#" class="catalog">','<b class="ic ic-catalog tools-btn-ic"></b>','<span class="catalog-text tools-btn-text">\u76ee\u5f55</span>',"</a>"].join("");
t.$el=i(o).appendTo(t.$applyEl),t.$box=i(c).appendTo(t.$applyEl),t.bindEvent()},bindEvent:function(){var a=this,t=a.mediator;t.on("v:windowResize",function(){a.hideBox()});var o=!1;a.$el.on("mousedown",function(i){i.preventDefault(),o||"touchend"!==i.type||(o=!0),o&&"mousedown"===i.type||(a.catalogLoaded?a.$box.hasClass("catalog-show")?a.hideBox():a.showBox():(a.$box.find(".catalog-loading").show(),t.fire("m:loadCatalog").then(function(t){a.catalogLoaded=!0,a.$box.find(".catalog-loading").hide(),t.bookdir.length>0?(a.hasCatalog=!0,a.$box.find(".catalog-container").find(".overview").html(l.template(n,{data:t.bookdir,freePageNum:a.freePageNum,util:{encodeHTML:s.string.encodeHTML}})).end().show()):a.$box.find(".catalog-container").html(d).end().show(),a.catalogHtml=a.$box.html(),a.$box.hasClass("catalog-show")?a.hideBox():a.showBox()
})))}).on("click",function(a){a.preventDefault()}),a.$box.on("click","a.catalog-item",function(o){o.preventDefault(),a.hideBox();var e=i(this).attr("page").split("-"),l=parseInt(e[0])||1,s=parseInt(e[1])||1;l=Math.max(1,Math.min(l,a.freeChapterNum)),s=Math.max(1,s),t.fire("p:scroll-to-chapter",{data:{chapterNum:l,paragraphNum:s}}),a.$toolsBar.trigger("log:send",{logAct:"catalog.click"})}),a.$box.focusout(function(){setTimeout(function(){i(document.activeElement).closest(a.$box).length||a.hideBox()
},0)}),a.$box.on("mouseenter",".scrollbar",function(){i(this).addClass("scrollbar-hover")}).on("mouseleave",".scrollbar",function(){i(this).removeClass("scrollbar-hover")})},hideBox:function(){var a=this;a.$box.stop(!0,!0).removeClass("catalog-show").animate({width:0},"fast",function(){a.$box.hide()}),a.$el.removeClass("catalog-click")},showBox:function(){var a=this,t=a.$win.height(),o=a.$box.stop(!0,!0).height(t).html(a.catalogHtml).show().addClass("catalog-show").focus().animate({width:670},"fast").find(".catalog-container").find(".viewport").height(t-40).end();
a.hasCatalog&&(o.height()>=o.find("ul").height()?o.find(".scrollbar").addClass("hidden"):(o.find(".scrollbar").removeClass("hidden"),o.tinyscrollbar())),a.$el.addClass("catalog-click"),a.$toolsBar.trigger("log:send",{logAct:"catalog.show"})}});o.exports.Catalog=r});
;define("ydcore:widget/ui/book_view/toolsArea/item/favo.js",function(o,t,a){var i,e=o("ydcommon:widget/ui/lib/jquery/jquery.js"),n=o("ydcommon:widget/ui/js_core/mvp/view/view.js").View,s={};s.lang=o("ydcommon:widget/ui/lib/lang/lang.js"),i=s.lang.createClass(function(o){this._init(o)},{superClass:n}).extend({_init:function(o){var t=this,a="";e.extend(t,o);var i="",a="\u6dfb\u52a0\u6536\u85cf",n="\u6536\u85cf";t.isInRoom&&(i=" has-in-room",n=a="\u5df2\u6536\u85cf");var s=['<a href="###" class="favo'+i+'" hideFocus="true" alog-action="favo.book.view">','<b class="ic ic-favo tools-btn-ic"></b>','<span class="tag-new-icon-tip"></span>','<span class="favo-text tools-btn-text">'+n+"</span>","</a>"].join("");
t.$el=e(s).appendTo(t.$applyEl),t.bindEvent()},bindEvent:function(){var o=this,t=o.mediator,a=!1;o.$el.on("click touchend",function(i){i.preventDefault(),a||"touchend"!==i.type||(a=!0),a&&"click"===i.type||o.isInRoom||(t.fire("p:addFavo").then(function(){o.isInRoom=!0,o.addFavo(),o.favoToBook(),o.isLocalPreview||(e(".tag-wrap").show(),e(".tag-wrap").trigger("adjustTagHeight"))}),o.isTxtReader&&t.fire("p:tools-area-send-x-log",{data:{act_id:"200037"}}),o.$toolsBar.trigger("log:send",{logAct:"favo.click"}))
})},addFavo:function(){var o=this;o.$el.addClass("has-in-room").find(".favo-text").html("\u5df2\u6536\u85cf")},favoToBook:function(){var o=this,t=(o.$el.offset(),o.isIE6?"//wkstatic.bdimg.com/static/ydcore/widget/ui/book_view/toolsArea/img/red_heart_ie6_335d874.png":"//wkstatic.bdimg.com/static/ydcore/widget/ui/book_view/toolsArea/img/red_heart_2ad7d20.png"),a=e('<img src="'+t+'" class="animate-heart" />');a.appendTo(o.$applyEl).animate({top:"+=10",left:"-=15",width:18,height:18},{duration:100}).animate({top:"+=10",left:"-=5"},{duration:100}).animate({top:"+=10",left:"+=5"},{duration:100}).animate({width:12,height:12,top:"+=13",left:"+=20"},{duration:100}).promise().done(function(){var t=e('<div class="add-one">+1</div>');
t.appendTo(o.$applyEl).animate({top:"-=20",opacity:1},600).promise().done(function(){t.fadeOut(200,function(){t.remove(),t=null,setTimeout(function(){o.addFinish()},300)})}),a.fadeOut(function(){a.remove(),a=null})})},addFinish:function(){var o=this,t='\u5df2\u52a0\u5165<a href="/customer/mybook?fr=favo" class="strong" tabindex="-1" hidefocus="true" target="_blank">\u6211\u7684\u56fe\u4e66</a>';o.mediator.fire("v:show-general-msg",{data:{msg:t}})}}),a.exports.Favo=i});
;define("ydcore:widget/ui/book_view/toolsArea/item/book.js",function(o,t,e){var i=o("ydcommon:widget/ui/lib/jquery/jquery.js"),c=function(o){var t=o.$applyEl,e=['<a href="/customer/mybook?fr=favo" class="book" target="_blank">','<b class="ic ic-book tools-btn-ic"></b>','<span class="book-text tools-btn-text">\u6211\u7684\u56fe\u4e66</span>',"</a>"].join("");i(e).appendTo(t).click(function(){o.$toolsBar.trigger("log:send",{logAct:"book.click"})})};e.exports.Book=c});
;define("ydcore:widget/ui/book_view/toolsArea/item/bookmark.js",function(o,e,a){var i,n=o("ydcommon:widget/ui/lib/jquery/jquery.js"),t=o("ydcommon:widget/ui/js_core/mvp/view/view.js").View,s={};s.lang=o("ydcommon:widget/ui/lib/lang/lang.js"),i=s.lang.createClass(function(o){this._init(o)},{superClass:t}).extend({_init:function(o){var e=this;n.extend(e,o);var a=['<a href="###" class="bookmark">','<b class="ic ic-bookmark tools-btn-ic"></b>','<span class="bookmark-text tools-btn-text">\u4e66\u7b7e</span>',"</a>"].join(""),i=['<div class="big-bookmark hidden"></div>'].join("");
e.$el=n(a).appendTo(e.$applyEl),e.$bigEl=n(i).appendTo(e.$applyEl),e.bindEvent()},bindEvent:function(){var o=this,e=o.mediator,a=!1;n(o.$el).on("click touchend",function(i){i.preventDefault(),a||"touchend"!==i.type||(a=!0),a&&"click"===i.type||o.$bigEl.hasClass("hidden")&&e.fire("p:addBookmark")}),e.on("v:addBookmarkFinish",function(e){o.bookmark=[e.page,e.offset],o.bookmarkPage(e.page)}),e.on("v:readerScroll",function(e){o.bookmarkPage(e.currentPage)})},bookmarkPage:function(o){{var e=this;e.el}o===parseInt(e.bookmark[0],10)?(e.$el.addClass("bookmark-add"),e.$bigEl.removeClass("hidden")):(e.$el.removeClass("bookmark-add"),e.$bigEl.addClass("hidden"))
}}),a.exports.Bookmark=i});
;define("ydcore:widget/ui/book_view/toolsArea/item/pageBar.js",function(e,a,t){var i,n=e("ydcommon:widget/ui/lib/jquery/jquery.js"),l=e("ydcommon:widget/ui/js_core/mvp/view/view.js").View,p=(e("ydcommon:widget/ui/js_core/qrcode/qrcode.js"),{});p.lang=e("ydcommon:widget/ui/lib/lang/lang.js"),i=p.lang.createClass(function(e){this._init(e)},{superClass:l}).extend({_init:function(e){var a=this;n.extend(a,e,{$el:null,$pagePrevEl:null,$pageNextEl:null}),a._initView(),a.bindEvent()},template:{view:['<div class="page-bar no-select-range">','<a class="ic-page ic-page-prev ic-page-prev-disabled" hideFocus="true"></a>','<a class="ic-page ic-page-next ic-page-next-disabled" hideFocus="true"></a>','<a class="cur-page" hideFocus="true"></a>','<p class="input-wrap hidden" tabIndex="-1" hideFocus=true>','<input type="text" class="input-text"/>','<a class="input-go" hideFocus="true">\u8df3\u8f6c</a>',"</p>",'<span class="total-page"></span>',"</div>",'<a href="'+("string"==typeof window.__fankui_link__?window.__fankui_link__:"http://tieba.baidu.com/f?kw=%B0%D9%B6%C8%D4%C4%B6%C1")+'" class="side-bar-fankui log-xsend" data-logxsend="[2, 200206]" target="_blank">\u610f\u89c1\u53cd\u9988</a>'].join(""),type:"template"},_initView:function(){var e=this;
e.$el=n(e.template.view).appendTo(e.$applyEl);e.el;e.$pagePrevEl=n(".ic-page-prev",e.$el),e.$pageNextEl=n(".ic-page-next",e.$el),e.$inputWrap=n(".input-wrap",e.$el),e.$input=n(".input-text",e.$el),e.$go=n(".input-go",e.$el),e.$curPageEl=n(".cur-page",e.$el),e.$totalPageEl=n(".total-page",e.$el),e.$input.val(e.currentPage),e.$curPageEl.html(e.currentPage),e.$totalPageEl.html(e.pageCount)},bindEvent:function(){var e=this,a=e.mediator;a.on("v:readerScroll",n.proxy(e.pageBtnUpdate,e)),e.$pagePrevEl.click(function(){e.$pagePrevEl.hasClass("ic-page-prev-disabled")||(a.fire("p:prevPage"),e.$toolsBar.trigger("log:send",{logAct:"page.click",direct:"prev"}))
}),e.$pageNextEl.click(function(){e.$pageNextEl.hasClass("ic-page-next-disabled")||(a.fire("p:nextPage"),e.$toolsBar.trigger("log:send",{logAct:"page.click",direct:"next"}))}),e.$curPageEl.click(function(){e.$inputWrap.removeClass("hidden"),e.$input.select()}),e.$input.on("keypress keydown keyup",function(e){e.stopPropagation()}).keydown(function(a){var t=a.which;13===t&&e.$go.trigger("click")}),e.$go.click(function(){var t=e.$input.val();if(/^\d+$/.test(t)&&parseInt(t,10)){if(t>e.freePageNum&&(t=e.freePageNum),t<e.startPage)return void a.fire("p:readRange.prevScreen",{pageNum:t});
if(t>e.pageRange[1])return void a.fire("p:readRange.nextScreen",{pageNum:t});a.fire("p:gotoPage",{pageNum:+t}),e.$inputWrap.addClass("hidden"),e.$toolsBar.trigger("log:send",{logAct:"page.click",direct:"goto"})}else e.$input.val(e.options.currentPage)}),e.$inputWrap.focusout(function(){setTimeout(function(){n(document.activeElement).closest(e.$inputWrap).length||e.$inputWrap.addClass("hidden")},0)})},pageBtnUpdate:function(e){var a=this,t=e.currentPage;a.$curPageEl.html(t),a.$input.val(t),1===t&&0===a.$body.scrollTop()?a.$pagePrevEl.addClass("ic-page-prev-disabled"):a.$pagePrevEl.removeClass("ic-page-prev-disabled"),t===a.pageCount&&a.$body.scrollTop()+a.$win.height()>=a.$body.height()?a.$pageNextEl.addClass("ic-page-next-disabled"):a.$pageNextEl.removeClass("ic-page-next-disabled")
}}),t.exports.PageBar=i});
;define("ydcore:widget/ui/book_view/toolsArea/item/msgTip.js",function(i,t,e){var n,o=i("ydcommon:widget/ui/lib/jquery/jquery.js"),s=i("ydcommon:widget/ui/js_core/mvp/view/view.js").View,r={};r.lang=i("ydcommon:widget/ui/lib/lang/lang.js"),n=r.lang.createClass(function(i){1!==i.currentPage&&this._init(i)},{superClass:s}).extend({_init:function(i){var t=this;o.extend(t,i,{timer:null});var e=['<div class="msg-tip">','<p class="msg"></p>',"</div>"].join("");t.$el=o(e).appendTo(t.$applyEl),t.bindEvent(),t._showPosTip()
},_showPosTip:function(){var i=this,t="\u60a8\u4e0a\u6b21\u9605\u8bfb\u5230\u6b64\u4f4d\u7f6e\uff0c\u5df2\u4e3a\u60a8\u81ea\u52a8\u8df3\u8f6c";i._showTip(top,t)},showTip:function(i){var t=this,e=i.data||{},n=e.msg,o=e.top;t._showTip(o,n)},_showTip:function(i,t){var e=this;t=t||"",i>80||(i=80),e.$el.find(".msg").html(t).end().css({marginLeft:-e.$el.width()/2,top:i}).show(function(){e.startTimer()})},bindEvent:function(){var i=this,t=i.mediator;t.on("v:show-general-msg",o.proxy(i.showTip,i)),i.$el.hover(function(){clearTimeout(i.timer)
},function(){i.startTimer()})},startTimer:function(){var i=this;i.timer&&clearTimeout(i.timer),i.timer=setTimeout(function(){i.hideTip()},2500)},hideTip:function(){var i=this;i.$el.hide("fast")}}),e.exports.MsgTip=n});
;define("ydcore:widget/ui/book_view/toolsArea/itemList.js",function(e,o,r){var i,t=(e("ydcommon:widget/ui/lib/jquery/jquery.js"),e("ydcore:widget/ui/book_view/toolsArea/item/back.js").Back),a=e("ydcore:widget/ui/book_view/toolsArea/item/title.js").Title,s=e("ydcore:widget/ui/book_view/toolsArea/item/pay.js").Pay,c=e("ydcore:widget/ui/book_view/toolsArea/item/catalog.js").Catalog,g=e("ydcore:widget/ui/book_view/toolsArea/item/favo.js").Favo,w=e("ydcore:widget/ui/book_view/toolsArea/item/book.js").Book,d=e("ydcore:widget/ui/book_view/toolsArea/item/bookmark.js").Bookmark,k=e("ydcore:widget/ui/book_view/toolsArea/item/pageBar.js").PageBar,b=e("ydcore:widget/ui/book_view/toolsArea/item/msgTip.js").MsgTip,l={};
l.browser=e("ydcommon:widget/ui/lib/browser/browser.js"),i=function(e){var o=function(o){return function(r){e.$applyEl=r,new o(e)}};return{back:{pos:"left",creater:o(t)},pay:{pos:"inner",creater:o(s)},title:{pos:"center",creater:o(a)},catalog:{pos:"right",creater:o(c)},favo:{pos:"right",creater:o(g)},book:{pos:"right",creater:o(w)},bookmark:{pos:"right",creater:o(d)},pageBar:{pos:"right",creater:o(k)},msgTip:{pos:"inner",creater:o(b)}}},r.exports=i});
;define("ydcore:widget/ui/book_view/toolsArea/txt_item/back.js",function(e,i,o){var t=(e("ydcommon:widget/ui/lib/jquery/jquery.js"),function(e){return});o.exports.Back=t});
;define("ydcore:widget/ui/book_view/toolsArea/txt_item/title.js",function(t,e,a){var i,n=t("ydcommon:widget/ui/lib/jquery/jquery.js"),s=t("ydcommon:widget/ui/js_core/mvp/view/view.js").View,r={};r.lang=t("ydcommon:widget/ui/lib/lang/lang.js"),i=r.lang.createClass(function(t){this._init(t)},{superClass:s}).extend({_init:function(t){var e=this;n.extend(e,t),e.$applyEl.append(n(e.renderView(e.template,{}))),e._setPayState(),e._bindEvent(),e.paragraphChange({data:{cn:e.currentChapter,pn:e.paragraphNum}})
},template:{view:['<iframe frameborder="0"></iframe>','<div class="title">','<div class="title-text"></div>',"</div>",'<div class="percent">','<div class="percent-text"></div>',"</div>"].join(""),type:"template"},_bindEvent:function(){var t=this,e=t.mediator;e.on("p:paragraph-change",n.proxy(t.paragraphChange,t)),e.on("v:set-read-progress",n.proxy(t.setReadProgress,t)),e.on("v:set-progress-to-100",n.proxy(t.setProgressTo100,t)),e.on("v:set-ffkan-title",n.proxy(t.setFfkanTitle,t))},_setPayState:function(){var t=this;
t.ispaied?(t.payState='<span class="title-pay-status">(\u5df2\u8d2d\u4e70)</span>',t.vipFreeBuy&&(t.payState='<span class="title-pay-status title-member-free">(\u4f1a\u5458\u514d\u8d39\u9605\u8bfb)</span>')):t.payState='<span class="title-pay-status">(\u8bd5\u8bfb)</span>'},setFfkanTitle:function(t){var e=this,a=t.data||{};a.title&&e.setTitle(a.title),e.$applyEl.find(".percent-text").html("")},setTitle:function(t){var e=this;t||(t=e.docTitle+e.payState),e.$applyEl.find(".title-text").html(t)},setProgressTo100:function(){var t=this;
t.$applyEl.find(".percent-text").html("100%")},setReadProgress:function(t){var e=this,a=t.data||{},i=a.progress;i*=100,i=Math.round(i),i=Math.max(1,Math.min(i,100)),i+="%",e.$applyEl.find(".percent-text").html(i)},paragraphChange:function(t){var e=this,a=t.data||{},i=a.cn,s=a.pn,r="";n.each(e.realChapterNameMap,function(t,e){if(i>e.cn)r=e.title;else{if(!(i===e.cn&&s>=e.pn))return!1;r=e.title}}),e.setTitle(r)}}),a.exports.Title=i});
;define("ydcore:widget/ui/book_view/toolsArea/txt_item/pay.js",function(e,o,i){var t=e("ydcore:widget/ui/book_view/toolsArea/item/pay.js").Pay;i.exports.Pay=t});
;define("ydcore:widget/ui/book_view/toolsArea/txt_item/bookmarkList.js",function(o,a,e){var t=o("ydcommon:widget/ui/lib/jquery/jquery.js"),i=o("ydcommon:widget/ui/js_core/login/login.js").login,n=o("ydcommon:widget/ui/js_core/mvp/view/view.js").View,s=o("ydcommon:widget/ui/js_core/mvp/template/template.js"),r=o("ydcommon:widget/ui/js_core/util/util.js"),d=['<a href="#" class="txt-bookmark">','<b class="ic ic-bookmark tools-btn-ic"></b>','<span class="bookmark-text tools-btn-text">\u4e66\u7b7e</span>',"</a>"].join(""),l=["<%var href, page, paragraph, offset;%>","<%for(var i = 0; i < data.length; i++){%>",'<li><div class="<%if (i == 0) {%>pb20<%}else{%>ph20<%}%> bookmark-item" data-cn=<%=data[i].cn%> data-pn=<%=data[i].pn%> data-offset=<%=data[i].offset%>>','<p class="mb15 item-summary"><%=util.encodeHTML(util.cutString(data[i].summary, 120,"..."))%></p>','<p class="item-meta">','<span class="item-time mr10"><%=data[i].update_time%></span>','<a class="del-item" href="###">\u5220\u9664</a>',"</p>","</div></li>","<%}%>"].join(""),m=['<div class="bookmark-box bdjson-bookmark-box no-select-range" tabIndex="-1" hideFocus=true>',"<div class='no-bookmark'>","<b class='ic ic-book'></b>","<p>\u60a8\u8fd8\u672a\u6dfb\u52a0\u4e66\u7b7e\u54e6\uff5e\uff5e</p>","</div>",'<div class="bookmark-title">\u4e66\u7b7e</div>','<div class="bookmark-container">','<div class="scrollbar">','<div class="track">','<div class="thumb">','<div class="end"></div>','<div class="bottom"></div>',"</div>","</div>","</div>",'<div class="viewport">','<ul class="overview"></ul>',"</div>","</div>","</div>"].join("");
o("ydcore:widget/ui/book_view/lib/tinyscrollbar/tinyscrollbar.js");var c={};c.lang=o("ydcommon:widget/ui/lib/lang/lang.js"),c.string=o("ydcommon:widget/ui/lib/string/string.js");var k=c.lang.createClass(function(o){this._init(o)},{superClass:n}).extend({_init:function(o){var a=this;t.extend(a,o,{bookmarkChanged:!0,hasBookmark:!1}),a.$el=t(d).appendTo(a.$applyEl),a.$box=t(m).appendTo(a.$applyEl),a.bindEvent(),a.$applyEl.show()},bindEvent:function(){var o=this,a=o.mediator;a.on("v:windowResize",function(){o.hideBox()
}),a.on("v:bookmark-change",t.proxy(o.bookmarkChange,o)),o.isLogin?o._bindUIEvent():o.$el.on("mousedown touchstart",function(o){o.preventDefault(),i.verlogin(function(){window.location.reload(!0)})})},_bindUIEvent:function(){var o=this,a=o.mediator,e=!1;o.$el.on("mousedown touchstart",function(a){if(a.preventDefault(),!o.isPreview&&(e||"touchend"!==a.type||(e=!0),!e||"mousedown"!==a.type)){if(o.bookmarkChanged){var t=o.bookmarks;o.bookmarkChanged=!1,t.length>0?(o.hasBookmark=!0,o.$box.find(".bookmark-container").find(".overview").html(s.template(l,{data:t,util:{encodeHTML:o.isPreview?function(o){return String(o).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")
}:c.string.encodeHTML,cutString:r.cutString}})),o.$box.find(".no-bookmark").hide().end().find(".bookmark-container").show()):(o.hasBookmark=!1,o.$box.find(".bookmark-container").hide().end().find(".no-bookmark").show()),o.bookmarkHtml=o.$box.html()}o.$box.hasClass("bookmark-show")?o.hideBox():o.showBox()}}).on("click",function(o){o.preventDefault()}),o.$box.on("click",".bookmark-item",function(e){e.preventDefault(),o.hideBox();var i=t(this),n=Number(i.data("cn"))||1,s=Number(i.data("pn"))||1,r=Number(i.data("offset"));
n=Math.max(1,Math.min(n,o.freeChapterNum)),s=Math.max(1,s),a.fire("p:scroll-to-chapter",{data:{chapterNum:n,paragraphNum:s,offset:r}})}).on("click",".bookmark-item .del-item",function(o){o.preventDefault(),o.stopPropagation();var e=t(this).parents(".bookmark-item"),i=Number(e.data("cn"))||1,n=Number(e.data("pn"))||1,s=Number(e.data("offset"));a.fire("p:delete-bookmark",{data:{bookmark:{cn:i,pn:n,offset:s}}}).then(function(){e.slideUp(400,function(){e.remove()})})}),o.$box.focusout(function(){setTimeout(function(){t(document.activeElement).closest(o.$box).length||o.hideBox()
},0)}),o.$box.on("mouseenter",".scrollbar",function(){t(this).addClass("scrollbar-hover")}).on("mouseleave",".scrollbar",function(){t(this).removeClass("scrollbar-hover")})},hideBox:function(){var o=this;o.$box.stop(!0,!0).removeClass("bookmark-show").animate({width:0},"fast",function(){o.$box.hide()}),o.$el.removeClass("bookmark-click")},showBox:function(){var o=this,a=o.$win.height(),e=o.$box.stop(!0,!0).height(a).html(o.bookmarkHtml).show().addClass("bookmark-show").focus().animate({width:670},"fast").find(".bookmark-title").show().end().find(".bookmark-container").find(".viewport").height(a-100).end();
o.hasBookmark&&(e.height()>=e.find("ul").height()?e.find(".scrollbar").addClass("hidden"):(e.find(".scrollbar").removeClass("hidden"),e.tinyscrollbar())),o.$el.addClass("bookmark-click")},bookmarkChange:function(o){var a=this,e=o.data||{};e.bookmarks&&(a.bookmarks=e.bookmarks,a.bookmarkChanged=!0)}});e.exports.BookmarkList=k});
;define("ydcore:widget/ui/book_view/toolsArea/txt_item/bookmarkBtn.js",function(a,e,t){var r=a("ydcommon:widget/ui/lib/jquery/jquery.js"),n=a("ydcommon:widget/ui/js_core/login/login.js").login,o=a("ydcommon:widget/ui/js_core/mvp/view/view.js").View,i={};i.lang=a("ydcommon:widget/ui/lib/lang/lang.js");var s=i.lang.createClass(function(a){this._init(a)},{superClass:o}).extend({_init:function(a){var e=this;r.extend(e,a,{isActive:!1,canBook:!1,textLimit:100}),e.$el=r(e.renderView(e.template,{})).appendTo(e.$applyEl),e._bindEvent(),e.$applyEl.show()
},template:{view:['<a class="bookmark-btn" href="###"></a>'].join(""),type:"template"},_bindEvent:function(){var a=this,e=a.mediator;e.on("v:paragraph-change",r.proxy(a.paragraphChange,a)),e.on("v:bookmark-change",r.proxy(a.bookmarkChange,a)),e.on("v:switch-type",function(e){var t=e.data||{},r=t.type;"ffkan"===r?(a.canBook=!1,a.$applyEl.hide()):(a.canbook=!0,a.$applyEl.show())}),a.isLogin?a.$el.click(r.proxy(a._bookmarkBtnClick,a)):a.$el.on("mousedown touchstart",function(a){a.preventDefault(),n.verlogin(function(){window.location.reload(!0)
})})},paragraphChange:function(){var a=this,e=window.readerState,t={cn:e.curChapterNum,pn:e.curParagraphIndex,offset:e.curParagraphOffset},n=r("#txt-reader-block"),o=n.find(".p-b-"+t.cn+"-"+t.pn);o.hasClass("progress-absent")||1==o.find(".page-divide").length?(a.isActive=!1,a.canBook=!1,a.$el.removeClass("active"),a.$el.addClass("disabled")):(a.canBook=!0,a.$el.removeClass("disabled"),a._bookmarkChange())},bookmarkChange:function(){var a=this;a._bookmarkChange()},_bookmarkBtnClick:function(a){{var e=this,t=e.mediator;
e.$el}if(a.preventDefault(),!e.isPreview&&e.canBook)if(e.isActive)t.fire("p:delete-bookmark");else{var r=e._getBookMarkInfo();t.fire("p:add-bookmark",{data:r})}},_bookmarkChange:function(){var a=this,e=a.mediator,t=a.$el;e.fire("p:get-bookmarks",{data:{visible:!0}}).then(function(e){e.length>0?(a.isActive=!0,t.addClass("active")):(a.isActive=!1,t.removeClass("active"))})},_getBookMarkInfo:function(){var a,e=this,t=window.readerState,n={cn:t.curChapterNum,pn:t.curParagraphIndex,offset:t.curParagraphOffset},o={cn:t.curBottomInfo.chapterNum,pn:t.curBottomInfo.paragraphIndex,offset:t.curBottomInfo.offset},i=r("#txt-reader-block"),s=i.find(".p-b-"+n.cn+"-"+n.pn),d=i.find(".p-b-"+o.cn+"-"+o.pn),l=s.attr("data-cn"),p=d.attr("data-cn"),c=Number(l)+1,f=r();
if(d.length>0)if(f=s.nextUntil(d).addBack().add(d),l==p)f=s.attr("data-paragraph-index")!=d.attr("data-paragraph-index")?s.nextUntil(d,".p-b").addBack().add(d):s;else{for(var f=s.nextAll(".p-b").addBack(),g=d.closest(".txt-reader-wrap").find(".p-b"),m=d.attr("data-paragraph-index");p>c;)f=f.add(e.$textContainer.find('.txt-reader-wrap[data-block-num="'+c+'"] .p-b')),c++;f=f.add(g.slice(0,m))}else f=s.nextAll(".p-b").addBack(),o={cn:t.curChapterNum,pn:t.curParagraphIndex,offset:Number(f.last().find(".atom:last").data("paragraph-offset"))+Number(f.last().find(".atom:last").attr("data-part-len"))};
var h=e._getSummary(f,e.textLimit,n,o)||"";return a=n,a.summary=h,a},_getSummary:function(a,e,t,n){var o="";return r.each(a,function(i,s){var d=r(s),l=null,p="";if(d.filter(".single-page, .normal-single-page, .single-img-p").length)o+="[\u56fe\u7247]";else if(d.hasClass("ext_code_wrap"))o+="[\u4ee3\u7801]";else if(d.hasClass("ext_picnote_wrap"))o+="[\u56fe\u7247]",p=d.find(".picnote-text .text").text(),o+=p.substr(0,e-o.length),p="";else{l=d.find(".atom");for(var c=0;c<l.length;c++){var f=r(l[c]),g=Number(f.data("paragraph-offset"))+Number(f.attr("data-part-len"));
if(!(0==i&&g<t.offset)&&!(i==a.length-1&&f.data("paragraph-offset")>=n.offset)&&("img"==l[c].tagName.toLowerCase()?o+="[\u56fe\u7247]":f.hasClass("ext_remark")?o+="[\u6ce8\u91ca]":(p=f.text(),o+=p.substr(0,e-o.length),p=""),o.length>=e))break}}return o.length>=e?!1:void 0}),o}});t.exports.BookmarkBtn=s});
;define("ydcore:widget/ui/book_view/toolsArea/txt_item/booknoteList.js",function(o,t,e){var n=o("ydcommon:widget/ui/lib/jquery/jquery.js"),i=o("ydcommon:widget/ui/js_core/login/login.js").login,a=o("ydcommon:widget/ui/js_core/mvp/view/view.js").View,s=o("ydcommon:widget/ui/js_core/mvp/template/template.js"),d=o("ydcommon:widget/ui/js_core/util/util.js"),l=['<a href="#" class="txt-booknote">','<b class="ic ic-booknote tools-btn-ic"></b>','<span class="booknote-text tools-btn-text">\u5212\u7ebf\u4e0e\u7b14\u8bb0</span>',"</a>"].join(""),r=["<%var href, page, paragraph, offset;%>","<%for(var i = 0; i < data.length; i++){%>",'<li><div class="<%if (i == 0) {%>pb20<%}else{%>ph20<%}%> booknote-item" data-cn=<%=data[i].bfi%> data-pn=<%=data[i].bpi%> data-offset=<%=data[i].bci%> data-key=<%=data[i].key%> data-customstr="<%if(data[i].customstr.length) {%>1<%}else{%>0<%}%>">','<p class="mb15 item-summary"><%=util.encodeHTML(util.cutString(data[i].summary, 120,"..."))%></p>',"<%if(data[i].customstr.length) {%>",'<p class="mb15 item-customstr"><%=util.encodeHTML(util.cutString(data[i].customstr, 120,"..."))%></p>',"<%}%>",'<p class="item-meta">','<span class="item-time mr10"><%=data[i].update_time%></span>','<a class="del-item" href="###">\u5220\u9664</a>',"</p>","</div></li>","<%}%>"].join(""),c=['<div class="booknote-box bdjson-booknote-box no-select-range" tabIndex="-1" hideFocus=true>',"<div class='no-booknote'>","<b class='ic ic-book'></b>","<p>\u60a8\u8fd8\u672a\u6dfb\u52a0\u5212\u7ebf\u6216\u7b14\u8bb0\u54e6\uff5e\uff5e</p>","</div>",'<div class="booknote-title">\u5212\u7ebf\u4e0e\u7b14\u8bb0</div>','<div class="booknote-container">','<div class="scrollbar">','<div class="track">','<div class="thumb">','<div class="end"></div>','<div class="bottom"></div>',"</div>","</div>","</div>",'<div class="viewport">','<ul class="overview"></ul>',"</div>","</div>","</div>"].join("");
o("ydcore:widget/ui/book_view/lib/tinyscrollbar/tinyscrollbar.js");var b={};b.lang=o("ydcommon:widget/ui/lib/lang/lang.js"),b.string=o("ydcommon:widget/ui/lib/string/string.js");var u=b.lang.createClass(function(o){this._init(o)},{superClass:a}).extend({_init:function(o){var t=this;n.extend(t,o,{booknoteChanged:!0,hasbooknote:!1}),t.$el=n(l).appendTo(t.$applyEl),t.$box=n(c).appendTo(t.$applyEl),t.bindEvent(),t.$applyEl.show()},bindEvent:function(){var o=this,t=o.mediator;t.on("v:windowResize",function(){o.hideBox()
}),t.on("v:booknote-change",n.proxy(o.booknoteChange,o)),o.isLogin?o._bindUIEvent():o.$el.on("mousedown touchstart",function(o){o.preventDefault(),i.verlogin(function(){window.location.reload(!0)})})},_bindUIEvent:function(){var o=this,t=o.mediator,e=!1;o.$el.on("mousedown touchstart",function(t){if(t.preventDefault(),!o.isPreview&&(e||"touchend"!==t.type||(e=!0),!e||"mousedown"!==t.type)){if(o.booknoteChanged){var n=o.booknotes;o.booknoteChanged=!1,n.length>0?(o.hasbooknote=!0,o.$box.find(".booknote-container").find(".overview").html(s.template(r,{data:n,util:{encodeHTML:o.isPreview?function(o){return String(o).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")
}:b.string.encodeHTML,cutString:d.cutString}})),o.$box.find(".no-booknote").hide().end().find(".booknote-container").show()):(o.hasbooknote=!1,o.$box.find(".booknote-container").hide().end().find(".no-booknote").show()),o.booknoteHtml=o.$box.html()}o.$box.hasClass("booknote-show")?o.hideBox():o.showBox()}}).on("click",function(o){o.preventDefault()}),o.$box.on("click",".booknote-item",function(e){e.preventDefault(),o.hideBox();var i=n(this),a=Number(i.data("cn"))||1,s=Number(i.data("pn"))||1,d=Number(i.data("offset"));
a=Math.max(1,Math.min(a,o.freeChapterNum)),s=Math.max(1,s),t.fire("p:scroll-to-chapter",{data:{chapterNum:a,paragraphNum:s,offset:d}})}).on("click",".booknote-item .del-item",function(e){e.preventDefault(),e.stopPropagation();var i=n(this).parents(".booknote-item"),a=i.data("key");parseInt(i.data("customstr"))?(t.fire("v:confirm-del-note",{data:{noteKey:a}}),o.hideBox()):t.fire("p:del-note",{data:{noteKey:a}}).then(function(){i.slideUp(400,function(){i.remove()})})}),o.$box.focusout(function(){setTimeout(function(){n(document.activeElement).closest(o.$box).length||o.hideBox()
},0)}),o.$box.on("mouseenter",".scrollbar",function(){n(this).addClass("scrollbar-hover")}).on("mouseleave",".scrollbar",function(){n(this).removeClass("scrollbar-hover")})},hideBox:function(){var o=this;o.$box.stop(!0,!0).removeClass("booknote-show").animate({width:0},"fast",function(){o.$box.hide()}),o.$el.removeClass("booknote-click")},showBox:function(){var o=this,t=o.$win.height(),e=o.$box.stop(!0,!0).height(t).html(o.booknoteHtml).show().addClass("booknote-show").focus().animate({width:670},"fast").find(".booknote-title").show().end().find(".booknote-container").find(".viewport").height(t-100).end();
o.hasbooknote&&(e.height()>=e.find("ul").height()?e.find(".scrollbar").addClass("hidden"):(e.find(".scrollbar").removeClass("hidden"),e.tinyscrollbar())),o.$el.addClass("booknote-click")},booknoteChange:function(o){var t=this,e=o.data||{};e.booknotes&&(t.booknotes=e.booknotes,t.booknoteChanged=!0)}});e.exports.BooknoteList=u});
;define("ydcore:widget/ui/book_view/toolsArea/txt_item/catalog.js",function(a,t,e){var o=a("ydcommon:widget/ui/lib/jquery/jquery.js"),i=a("ydcommon:widget/ui/js_core/mvp/view/view.js").View,l=a("ydcommon:widget/ui/js_core/mvp/template/template.js"),s={},n=["<%var href, chapter, paragraph;%>","<%for(var i = 0; i < data.length; i++){%>","<%href = data[i].href.split('-');%>","<%chapter = href[0];%>","<%paragraph = href[1];%>","<%if(chapter < freeChapterNum || (chapter == freeChapterNum && (!freeParagraphIndex || paragraph <= freeParagraphIndex))){%>","<li><a class='<%if(i == data.length - 1){%>last-item <%}%>catalog-item catalog-level-<%=data[i].level%>' href\uff1d'#' title='<%=util.encodeHTML(data[i].title)%>' page='<%=data[i].href%>' target='_self'>","<span class='catalog-title'><b class='ic ic-catalog-point'></b><%=util.encodeHTML(data[i].title)%></span>","<span class='catalog-page'><%=chapter%></span>","</a></li>","<%} else {%>","<li><span class='<%if(i == data.length - 1){%>last-item <%}%>catalog-item out-of-range catalog-level-<%=data[i].level%>' href\uff1d'#' title='<%=util.encodeHTML(data[i].title)%>' page='<%=data[i].href%>'>","<span class='catalog-title'><b class='ic ic-catalog-point'></b><%=util.encodeHTML(data[i].title)%></span>","<span class='catalog-page'><%=chapter%></span>","</span></li>","<%}%>","<%}%>"].join(""),c=['<div class="catalog-box bdjson-catalog-box no-select-range" tabIndex="-1" hideFocus=true>','<div class="catalog-loading">',"\u6b63\u5728\u52aa\u529b\u8f7d\u5165\uff0c\u8bf7\u7a0d\u540e\uff5e\uff5e","</div>",'<div class="catalog-container">','<div class="scrollbar">','<div class="track">','<div class="thumb">','<div class="end"></div>','<div class="bottom"></div>',"</div>","</div>","</div>",'<div class="viewport">','<ul class="overview"></ul>',"</div>","</div>","</div>"].join(""),r=["<div class='no-catalog'>","<b class='ic ic-book'></b>","<p>\u6682\u65e0\u76ee\u5f55\uff0c\u8bf7\u7ee7\u7eed\u671f\u5f85\uff5e\uff5e</p>","</div>"].join("");
a("ydcore:widget/ui/book_view/lib/tinyscrollbar/tinyscrollbar.js"),s.lang=a("ydcommon:widget/ui/lib/lang/lang.js"),s.string=a("ydcommon:widget/ui/lib/string/string.js"),s.url=a("ydcommon:widget/ui/lib/url/url.js");var d=s.lang.createClass(function(a){this._init(a)},{superClass:i}).extend({_init:function(a){var t=this;o.extend(t,a,{catalogLoaded:!1,hasCatalog:!1});var e=['<a href="#" class="catalog">','<b class="ic ic-catalog tools-btn-ic"></b>','<span class="catalog-text tools-btn-text">\u76ee\u5f55</span>',"</a>"].join("");
t.$el=o(e).appendTo(t.$applyEl),t.$box=o(c).appendTo(t.$applyEl),t.bindEvent()},bindEvent:function(){var a=this,t=a.mediator;t.on("v:windowResize",function(){a.hideBox()});var e=!1;a.$el.on("mousedown touchstart",function(t){if(t.preventDefault(),e||"touchend"!==t.type||(e=!0),!e||"mousedown"!==t.type){if(!a.catalogLoaded){a.$box.find(".catalog-loading").show();var o=a.catalogs;a.catalogLoaded=!0,a.$box.find(".catalog-loading").hide(),o.length>0?(a.hasCatalog=!0,a.$box.find(".catalog-container").find(".overview").html(l.template(n,{data:o,freeChapterNum:a.freeChapterNum,freeParagraphIndex:parseInt(a.freeChapterStr&&a.freeChapterStr.split("-")[1])||0,util:{encodeHTML:a.isPreview?function(a){return String(a).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")
}:s.string.encodeHTML}})).end().show()):a.$box.find(".catalog-container").html(r).end().show(),a.catalogHtml=a.$box.html()}a.$box.hasClass("catalog-show")?a.hideBox():a.showBox()}}).on("click",function(a){a.preventDefault()}),a.$box.on("click","a.catalog-item",function(e){e.preventDefault(),a.hideBox();var i=o(this).attr("page").split("-"),l=parseInt(i[0])||1,s=parseInt(i[1])||1;l=Math.max(1,Math.min(l,a.freeChapterNum)),s=Math.max(1,s),!a.isPreview&&1===l&&s>0&&(s+=2),t.fire("p:scroll-to-chapter",{data:{chapterNum:l,paragraphNum:s}}),t.fire("p:tools-area-send-x-log",{data:{act_id:"200036",t_cn:l,t_pn:s}}),a.$toolsBar.trigger("log:send",{logAct:"catalog.click"})
}),a.$box.focusout(function(){setTimeout(function(){o(document.activeElement).closest(a.$box).length||a.hideBox()},0)}),a.$box.on("mouseenter",".scrollbar",function(){o(this).addClass("scrollbar-hover")}).on("mouseleave",".scrollbar",function(){o(this).removeClass("scrollbar-hover")})},hideBox:function(){var a=this;a.$box.stop(!0,!0).removeClass("catalog-show").animate({width:0},"fast",function(){a.$box.hide()}),a.$el.removeClass("catalog-click")},showBox:function(){var a=this,t=a.$win.height(),e=a.$box.stop(!0,!0).height(t).html(a.catalogHtml).show().addClass("catalog-show").focus().animate({width:670},"fast").find(".catalog-container").find(".viewport").height(t-40).end();
a.hasCatalog&&(e.height()>=e.find("ul").height()?e.find(".scrollbar").addClass("hidden"):(e.find(".scrollbar").removeClass("hidden"),e.tinyscrollbar())),a.$el.addClass("catalog-click"),a.$toolsBar.trigger("log:send",{logAct:"catalog.show"})}});e.exports.Catalog=d});
;define("ydcore:widget/ui/book_view/toolsArea/txt_item/switchs.js",function(t,e,s){var i=t("ydcommon:widget/ui/lib/jquery/jquery.js"),a=t("ydcommon:widget/ui/js_core/mvp/view/view.js").View,o={};o.lang=t("ydcommon:widget/ui/lib/lang/lang.js");var n=o.lang.createClass(function(t){this._init(t)},{superClass:a}).extend({_init:function(t){var e=this;i.extend(e,t,{notFirst:!1});var s=['<a href="###" class="switchs">','<b class="ic ic-switchs tools-btn-ic"></b>','<span class="switchs-text tools-btn-text">\u7ffb\u9875\u6a21\u5f0f</span>',"</a>"].join("");
e.$el=i(s).appendTo(e.$applyEl),e.bindEvent()},setSwitchStyle:function(t){var e,s=this,i=t.data||{},a=i.type||"stream";switch(a){case"format":s.$el.addClass("format"),e="\u6a2a\u7248\u7ffb\u9875\u6a21\u5f0f";break;case"stream":s.$el.removeClass("format"),e="\u7ad6\u7248\u7ffb\u9875\u6a21\u5f0f"}s.notFirst&&e&&s.mediator.fire("v:show-general-msg",{data:{msg:e}}),s.notFirst=!0},bindEvent:function(){var t=this,e=t.mediator;e.on("v:set-switch-style",i.proxy(t.setSwitchStyle,t));var s=!1;t.$el.on("click touchend",function(i){i.preventDefault(),s||"touchend"!==i.type||(s=!0),s&&"click"===i.type||(e.fire("p:tools-area-send-x-log",{data:{act_id:"200038"}}),e.fire("p:before-switch-type"),t.$toolsBar.trigger("log:send",{logAct:"switchs.click"}))
})}});s.exports.Switchs=n});
;define("ydcore:widget/ui/book_view/toolsArea/txt_item/ffkanSwitch.js",function(t,e,i){var n=t("ydcommon:widget/ui/lib/jquery/jquery.js"),a=t("ydcommon:widget/ui/js_core/mvp/view/view.js").View,s={};s.lang=t("ydcommon:widget/ui/lib/lang/lang.js");var c=s.lang.createClass(function(t){this._init(t)},{superClass:a}).extend({_init:function(t){var e=this;n.extend(e,t,{curType:"",notFirst:!1});var i=e.isOnlyFfkan?"ffk-switch-back-btn":"ffk-switch-go-btn",a=['<a href="###" class="ffk-switch-btn '+i+'">','<span class="thumb"></span>','<span class="text-wrap">','<span class="ib ffkan-type">\u968f\u4fbf\u7ffb</span>','<span class="ib normal-type">\u987a\u5e8f\u7ffb</span>',"</span>","</a>"].join("");
e.$el=n(a).appendTo(e.$applyEl),e.bindEvent()},setSwitchStyle:function(t){var e=this,i=e.mediator,n=t.data||{},a=!1,s=n.type,c=["addClass","removeClass"];"ffkan"===s&&(c.reverse(),a=!0),e.$el[c[0]]("ffk-switch-go-btn")[c[1]]("ffk-switch-back-btn"),i.fire("v:switch-tools-area-right",{data:{hide:a}})},bindEvent:function(){var t=this,e=t.mediator;e.on("v:set-switch-style",n.proxy(t.setSwitchStyle,t));var i=!1;t.$el.on("click touchend",function(t){t.preventDefault(),i||"touchend"!==t.type||(i=!0),i&&"click"===t.type||e.fire("p:before-switch-type",{data:{switchType:"ffkan"}})
})}});i.exports.FfkanSwitch=c});
;define("ydcore:widget/ui/book_view/toolsArea/txt_item/pageBar.js",function(e,a,t){var i,l=e("ydcommon:widget/ui/lib/jquery/jquery.js"),s=e("ydcommon:widget/ui/js_core/mvp/view/view.js").View,n=(e("ydcommon:widget/ui/js_core/qrcode/qrcode.js"),{});n.lang=e("ydcommon:widget/ui/lib/lang/lang.js"),i=n.lang.createClass(function(e){this._init(e)},{superClass:s}).extend({_init:function(e){var a=this;l.extend(a,e,{type:"",$el:null,$pagePrevEl:null,$pageNextEl:null}),a._initView(),a.bindEvent()},template:{view:['<div class="page-bar no-select-range">','<a class="ic-page ic-page-prev ic-page-prev-disabled" hideFocus="true"></a>','<a class="ic-page ic-page-next ic-page-next-disabled" hideFocus="true"></a>',"</div>",'<a href="'+("string"==typeof window.__fankui_link__?window.__fankui_link__:"http://tieba.baidu.com/f?kw=%B0%D9%B6%C8%D4%C4%B6%C1")+'" class="side-bar-fankui log-xsend" data-logxsend="[2, 200206]" target="_blank">\u610f\u89c1\u53cd\u9988</a>'].join(""),type:"template"},_initView:function(){var e=this;
e.$el=l(e.template.view).appendTo(e.$applyEl);e.el;e.$pagePrevEl=l(".ic-page-prev",e.$el),e.$pageNextEl=l(".ic-page-next",e.$el)},bindEvent:function(){var e=this,a=e.mediator;a.on("v:set-page-scroll-state",l.proxy(e.pageBtnUpdate,e)),a.on("v:set-switch-style",l.proxy(e.setSwitchStyle,e)),e.$pagePrevEl.click(function(){e.$pagePrevEl.hasClass("ic-page-prev-disabled")||(a.fire("v:prev-screen"),e.$toolsBar.trigger("log:send",{logAct:"page.click",direct:"prev",pageType:e.type}))}),e.$pageNextEl.click(function(){e.$pageNextEl.hasClass("ic-page-next-disabled")||(a.fire("v:next-screen"),e.$toolsBar.trigger("log:send",{logAct:"page.click",direct:"next",pageType:e.type}))
})},pageBtnUpdate:function(e){var a=this,t=e.data;t.isTop?a.$pagePrevEl.addClass("ic-page-prev-disabled"):a.$pagePrevEl.removeClass("ic-page-prev-disabled"),t.isBottom?a.$pageNextEl.addClass("ic-page-next-disabled"):a.$pageNextEl.removeClass("ic-page-next-disabled")},setSwitchStyle:function(e){var a=this,t=e.data||{},i=t.type||"stream";"format"===i?(a.type="format",a.$el.addClass("format")):(a.type="stream",a.$el.removeClass("format"))}}),t.exports.PageBar=i});
;define("ydcore:widget/ui/book_view/toolsArea/txt_item/msgTip.js",function(i,o,t){var e,s=i("ydcommon:widget/ui/lib/jquery/jquery.js"),n=i("ydcommon:widget/ui/js_core/mvp/view/view.js").View,r=i("ydcommon:widget/ui/js_core/log/log.js"),a=i("ydcore:widget/ui/book_view/lib/detect_zoom/detect_zoom.js").detectZoom,m={};m.lang=i("ydcommon:widget/ui/lib/lang/lang.js"),e=m.lang.createClass(function(i){this._init(i)},{superClass:n}).extend({_init:function(i){var o=this;s.extend(o,i,{timer:null,posTipsDuration:2500,posNum2Str:{1:"iPad",2:"iPhone",3:"Android",4:"PC",8:"Windows Phone"}});
var t=['<div class="msg-tip">','<p class="msg"></p>',"</div>"].join("");o.$el=s(t).appendTo(o.$applyEl),o.bindEvent(),o.detectZoom()},_showPosTip:function(i){var o=this,t=i.data||{},e=i.ext||{};if(t.isParagraph===!0&&e.from){var s=(t.chapterNum,t.progress,0),n='\u5df2\u4e3a\u60a8\u540c\u6b65\u5230<span class="impress">'+e.time+'</span> <span class="impress">'+(o.posNum2Str[e.from]?o.posNum2Str[e.from]:"")+"</span> \u5ba2\u6237\u7aef\u7684\u9605\u8bfb\u8fdb\u5ea6";o._showTip(s,n,o.posTipsDuration),r.xsend(2,200262)
}},showTip:function(i){var o=this,t=i.data||{},e=t.msg,s=t.top,n=t.delay||2500;o._showTip(s,e,n)},_showTip:function(i,o,t){var e=this;o=o||"",i>80||(i=80),e.$el.find(".msg").html(o).end().css({marginLeft:-e.$el.width()/2,top:i}).show(function(){e.startTimer(t)})},bindEvent:function(){var i=this,o=i.mediator;i.saveReadPosition&&o.on("v:show-position-tip",s.proxy(i._showPosTip,i)),o.on("v:show-general-msg",s.proxy(i.showTip,i)),o.on("v:window-resize",s.proxy(i.detectZoom,i)),i.$el.hover(function(){clearTimeout(i.timer)
},function(){i.startTimer()})},detectZoom:function(){var i=this,o=i.mediator;if(window.top===window.self){var t=1;try{t=a.zoom(),100*t%10>0&&(t=Math.round(10*t)/10)}catch(e){}if(1!==t){var s=t>1?"\u653e\u5927":"\u7f29\u5c0f";s="\u60a8"+s+"\u4e86\u6d4f\u89c8\u5668\u5c3a\u5bf8\uff0c\u53ef\u80fd\u4f1a\u5f71\u54cd\u9605\u8bfb\u4f53\u9a8c\uff0c\u5efa\u8bae\u4f7f\u7528 CTRL + 0 \u8fd8\u539f\u9ed8\u8ba4\u6bd4\u4f8b",o.fire("v:show-general-msg",{data:{msg:s,delay:1e4}})}}},startTimer:function(i){var o=this;
i=Math.max(i,2500),i=i||2500,o.timer&&clearTimeout(o.timer),o.timer=setTimeout(function(){o.hideTip()},i)},hideTip:function(){var i=this;i.$el.hide("fast")}}),t.exports.MsgTip=e});
;define("ydcore:widget/ui/book_view/toolsArea/itemListTxt.js",function(t,e,o){var i,r=(t("ydcommon:widget/ui/lib/jquery/jquery.js"),t("ydcore:widget/ui/book_view/toolsArea/txt_item/back.js").Back),s=t("ydcore:widget/ui/book_view/toolsArea/txt_item/title.js").Title,a=t("ydcore:widget/ui/book_view/toolsArea/txt_item/pay.js").Pay,c=t("ydcore:widget/ui/book_view/toolsArea/txt_item/bookmarkList.js").BookmarkList,w=t("ydcore:widget/ui/book_view/toolsArea/txt_item/bookmarkBtn.js").BookmarkBtn,k=t("ydcore:widget/ui/book_view/toolsArea/txt_item/booknoteList.js").BooknoteList,n=t("ydcore:widget/ui/book_view/toolsArea/txt_item/catalog.js").Catalog,d=t("ydcore:widget/ui/book_view/toolsArea/txt_item/switchs.js").Switchs,g=t("ydcore:widget/ui/book_view/toolsArea/txt_item/ffkanSwitch.js").FfkanSwitch,b=t("ydcore:widget/ui/book_view/toolsArea/txt_item/pageBar.js").PageBar,l=t("ydcore:widget/ui/book_view/toolsArea/txt_item/msgTip.js").MsgTip,m={};
m.browser=t("ydcommon:widget/ui/lib/browser/browser.js"),i=function(t){var e=function(e){return function(o){t.$applyEl=o,new e(t)}};return{back:{pos:"left",creater:e(r)},title:{pos:"center",creater:e(s)},"bookmark-btn":{pos:"center",creater:e(w)},catalog:{pos:"right",creater:e(n)},"bookmark-list":{pos:"right",creater:e(c)},"booknote-list":{pos:"right",creater:e(k)},switchs:{pos:"right",creater:e(d)},pageBar:{pos:"right",creater:e(b)},pay:{pos:"inner",creater:e(a)},ffkanswitch:{pos:"inner",isHidden:!t.ffkanData.isCan||t.hideRightToolsbar,creater:e(g)},msgTip:{pos:"inner",creater:e(l)}}
},o.exports=i});
;define("ydcore:widget/ui/book_view/toolsArea/toolsArea.js",function(e,i,t){var o=e("ydcommon:widget/ui/lib/jquery/jquery.js"),s=e("ydcommon:widget/ui/js_core/mvp/view/view.js").View,n=e("ydcommon:widget/ui/js_core/log/log.js"),a=e("ydcore:widget/ui/book_view/toolsArea/itemList.js"),d=e("ydcore:widget/ui/book_view/toolsArea/itemListTxt.js"),r={lang:e("ydcommon:widget/ui/lib/lang/lang.js"),browser:e("ydcommon:widget/ui/lib/browser/browser.js")},l=r.lang.createClass(function(e){this._init(e)},{superClass:s}).extend({_init:function(e){var i=this;
e.ffkanData=e.ffkanData||{isCan:!1},o.extend(i,e,{$el:o(i.renderView(i.template,{}))}),i.$body.append(i.$el),i.browserCheck(),i.bindEvent(),i._initView(),i._initItem()},template:{view:['<div class="tools-bar" id="tools-bar">','<div class="inner">','<div class="left"></div>','<div class="center"></div>','<div class="right"></div>',"</div>","</div>"].join(""),type:"template"},browserCheck:function(){var e=this;6===r.browser.ie?(e.$el.addClass("ie6fixed"),o("html").addClass("ie6html")):e.$el.addClass("toolsBarFixed"),e.isTxtReader&&e.$el.addClass("bdjson-tools-bar")
},_initView:function(){var e=this;e.$left=o(".left",e.$el),e.$center=o(".center",e.$el),e.$right=o(".right",e.$el),e.$inner=o(".inner",e.$el),e.ffkanData.isCan&&e.$right.addClass("right-in-ffk"),e.hideRightToolsbar&&e.$right.addClass("hidden")},_initItem:function(){var e=this,i=o.extend({},e.options,{$toolsBar:e.$el}),t=e.isTxtReader?d(i):a(i);o.each(t,function(i,t){var s,n=t.pos.toLowerCase(),a=t.isHidden,d=t.justHidden===!0;if(!a&&(s=o('<div class="item-wrap '+i+"-wrap"+(d?" hidden":"")+'"></div>'),s.appendTo(e["$"+n]),t.creater(s),"right"===n&&e.isIE6)){var r=s.find(".tools-btn-text").text();
if(r)var l=s.find(".tools-btn-ic").attr("title",r).on("mouseenter",function(){l.addClass("ic-has-hover")}).on("mouseleave",function(){l.removeClass("ic-has-hover")})}})},bindEvent:function(){var e=this,i=e.mediator;i.on("v:switch-tools-area-center",function(i){var t=i.data||{},o=t.hideCenter===!0;o?e.$center.addClass("hide-center"):e.$center.removeClass("hide-center")}),i.on("v:switch-tools-area-right",function(i){var t=i.data||{},o=t.hide===!0;e.$right[o?"addClass":"removeClass"]("hidden")});var t=e.isTxtReader?"bdjson":"xreader";
e.$el.on("log:send",function(i,s){e.isPreview||s&&s.logAct&&(s=o.extend(s,{docId:e.doc_id,version:t}),n.send("book","viewtoolsclick",s))})}});t.exports.toolsArea=l});
;define("ydcore:widget/ui/book_view/toolsArea/txt_item/book.js",function(o,e,i){var t=o("ydcore:widget/ui/book_view/toolsArea/item/book.js").Book;i.exports.Book=t});
;define("ydcore:widget/ui/book_view/toolsArea/txt_item/favo.js",function(o,e,i){var t=o("ydcore:widget/ui/book_view/toolsArea/item/favo.js").Favo;i.exports.Favo=t});
;define("ydcore:widget/ui/book_view/modelList/bookmark.js",function(o,i,t){var e,n=o("ydcommon:widget/ui/lib/jquery/jquery.js"),s=o("ydcommon:widget/ui/js_core/mvp/model/model.js").ModeList,r={};r.lang=o("ydcommon:widget/ui/lib/lang/lang.js"),e=r.lang.createClass(function(o){this._init(o)},{superClass:s}).extend({_init:function(o){var i=this;n.extend(i,o),i.bindEvent()},bindEvent:function(){var o=this,i=o.mediator;i.on("m:addBookmark",n.proxy(o.addBookmark,o))},isFirst:function(){var o=this;return!parseInt(o.bookmark[0],10)
},addBookmark:function(o){var i=this,t=o.page,e=o.offset,s=o.promise;return n.post("/user/submit/bookmark",{page:t,offset:e,ct:20109,doc_id:i.doc_id}).then(function(){s.resolve({isFirst:i.isFirst()})}),s}}),t.exports=e});
;define("ydcore:widget/ui/book_view/modelList/favo.js",function(o,e,i){var t,n=o("ydcommon:widget/ui/lib/jquery/jquery.js"),d=(o("ydcommon:widget/ui/js_core/mvp/model/model.js").ModelList,{});d.lang=o("ydcommon:widget/ui/lib/lang/lang.js"),t=d.lang.createClass(function(o){this._init(o)}).extend({_init:function(o){var e,i=this;n.extend(i,o),e=i.mediator,e.on("m:addFavo",n.proxy(i.addFavo,i))},addFavo:function(o){var e=this;return n.post("/customer/interface/collectbook",{doc_id:e.doc_id,token:n("#token").html()||1}).done(function(){o.promise.resolve()
}),o.promise}}),i.exports=t});
;define("ydcore:widget/ui/book_view/modelList/catalog.js",function(o,i,e){var t,d=o("ydcommon:widget/ui/lib/jquery/jquery.js"),n=(o("ydcommon:widget/ui/js_core/mvp/model/model.js").ModelList,{});n.lang=o("ydcommon:widget/ui/lib/lang/lang.js"),t=n.lang.createClass(function(o){this._init(o)}).extend({_init:function(o){var i,e=this;d.extend(e,o),i=e.mediator,i.on("m:loadCatalog",d.proxy(e.loadCatalog,e))},loadCatalog:function(o){var i=this;return d.post("/pay/getbookdir",{book_id:i.doc_id,type:"getdir"}).done(function(i){o.promise.resolve(i)
}),o.promise}}),e.exports=t});
;define("ydcore:widget/ui/book_view/modelList/modelList.js",function(o,e,i){var d=o("ydcommon:widget/ui/lib/jquery/jquery.js"),t=o("ydcore:widget/ui/book_view/modelList/bookmark.js"),c=o("ydcore:widget/ui/book_view/modelList/favo.js"),s=o("ydcore:widget/ui/book_view/modelList/catalog.js"),a={bookmark:t,favo:c,catalog:s},r=function(o){d.each(a,function(e,i){new i(o)})};i.exports=r});