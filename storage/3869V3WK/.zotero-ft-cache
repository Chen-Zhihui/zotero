
Skip to content
This repository

    Pull requests
    Issues
    Marketplace
    Explore

        New repository Import repository New gist New organization
        This repository
        New issue 
    @Chen-Zhihui
        Signed in as Chen-Zhihui
        Your profile
        Your stars
        Your gists
        Help
        Settings
        Sign out

Sign out

    Watch 9
    Notifications
    Not watching Be notified when participating or @mentioned. Watch
    Watching Be notified of all conversations. Unwatch
    Ignoring Never be notified. Stop ignoring
    Unstar 83
    Star 83
    Fork
    Where should we fork this repository?
    Loading
    32

moof2k / kerasify
Code Issues 4 Pull requests 1 Projects 0 Wiki Insights
Small library for running Keras models from a C++ application

    39 commits
    1 branch
    0 releases
    1 contributor
    MIT

    C++ 69.2%
    Python 29.9%
    Makefile 0.9%

C++ Python Makefile
Clone or download
Use SSH
Clone with HTTPS

Use Git or checkout with SVN using the web URL.
Use HTTPS
Clone with SSH

Use an SSH key and passphrase from account.
Download ZIP
Launching GitHub Desktop ...

If nothing happens, download GitHub Desktop and try again.

Go back
Launching GitHub Desktop ...

If nothing happens, download GitHub Desktop and try again.

Go back
Launching Xcode ...

If nothing happens, download Xcode and try again.

Go back
Launching Visual Studio ...

If nothing happens, download the GitHub extension for Visual Studio and try again.

Go back
Create new file
Upload files Find file
Branch: master
Switch branches/tags

    Branches
    Tags

master
Nothing to show
Nothing to show
New pull request
Fetching latest commit…
Cannot retrieve the latest commit at this time.
Permalink
	Failed to load latest commit information.
	.clang-format 	clang-format 	Mar 24, 2017
	.gitignore 	Renamed test cases to test_* 	Oct 26, 2016
	.travis.yml 	Update .travis.yml 	Mar 24, 2017
	LICENSE 	First time in 	Oct 25, 2016
	Makefile 	Skip static_analysis if static_analysis=false 	Mar 24, 2017
	README.md 	Update README.md 	Apr 16, 2017
	keras_model.cc 	clang-tidy 	Mar 24, 2017
	keras_model.h 	clang-tidy 	Mar 24, 2017
	keras_model_test.cc 	clang-tidy 	Mar 24, 2017
	kerasify.py 	Added support for LSTM layers as well as Embedding layers. 	Jan 14, 2017
	make_tests.py 	Added support for LSTM layers as well as Embedding layers. 	Jan 14, 2017
README.md
Kerasify

Kerasify is a small library for running trained Keras models from a C++ application.

Design goals:

    Compatibility with image processing Sequential networks generated by Keras using Theano backend.
    CPU only, no GPU
    No external dependencies, standard library, C++11 features OK.
    Model stored on disk in binary format that can be quickly read.
    Model stored in memory in contiguous block for better cache performance.
    Doesn't throw exceptions, returns only bool on error.
    Unit testable, rigorous unit tests.

Looking for more Keras/C++ libraries? Check out https://github.com/pplonski/keras2cpp/
Example

make_model.py:

 import numpy as np from keras.models import Sequential from keras.layers import Dense test_x = np.random.rand(10, 10).astype('f') test_y = np.random.rand(10).astype('f') model = Sequential() model.add(Dense(1, input_dim=10)) model.compile(loss='mean_squared_error', optimizer='adamax') model.fit(test_x, test_y, nb_epoch=1, verbose=False) print model.predict(np.array([[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]])) from kerasify import export_model export_model(model, 'example.model')  

test.cc:

 #include "keras_model.h" int main() { // Initialize model. KerasModel model; model.LoadModel("example.model"); // Create a 1D Tensor on length 10 for input data. Tensor in(10); in.data_ = {{0, 1, 2, 3, 4, 5, 6, 7, 8, 9}}; // Run prediction. Tensor out; model.Apply(&in, &out); out.Print(); return 0; }  

To test:

 $ python make_model.py [[-1.85735667]] $ g++ --std=c++11 -Wall -O3 test.cc keras_model.cc $ ./a.out [ -1.857357 ]  

Unit tests

To run the unit tests, generate the unit test models and then run keras_model_test :

 $ python make_tests.py ... $ make cppcheck --error-exitcode=1 keras_model.cc Checking keras_model.cc... Checking keras_model.cc: DEBUG... g++ --std=c++11 -I. -Wall -Werror -MMD -O3 -mtune=core2 -o keras_model.o -c keras_model.cc cppcheck --error-exitcode=1 keras_model_test.cc Checking keras_model_test.cc... Checking keras_model_test.cc: DEBUG... g++ --std=c++11 -I. -Wall -Werror -MMD -O3 -mtune=core2 -o keras_model_test.o -c keras_model_test.cc g++ -o keras_model_test keras_model_test.o keras_model.o $ ./keras_model_test TEST dense_1x1 TEST dense_10x1 TEST dense_2x2 TEST dense_10x10 TEST dense_10x10x10 TEST conv_2x2 TEST conv_3x3 TEST conv_3x3x3 TEST elu_10 TEST benchmark TEST benchmark TEST benchmark TEST benchmark TEST benchmark Benchmark network loads in 0.022415s Benchmark network runs in 0.022597s  

License

MIT

    © 2018 GitHub , Inc.
    Terms
    Privacy
    Security
    Status
    Help

    Contact GitHub
    API
    Training
    Shop
    Blog
    About

You can't perform that action at this time.
You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session.
Press h to open a hovercard with more details.
